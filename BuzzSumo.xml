<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" Title="BuzzSumo" Id="BuzzSumo" RequireVersion="7.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/BuzzSumo.xml" HelpUrl="http://seotoolsforexcel.com/buzzsumo/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/buzzsumo/">
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/buzzsumo/"/>
  </Settings>

  <Resources>
    <Resource Id="Languages">
      <Item Id="all" Title="All"/>
      <Item Id="ab" Title="Abkhazian"/>
      <Item Id="aa" Title="Afar"/>
      <Item Id="af" Title="Afrikaans"/>
      <Item Id="ak" Title="Akan"/>
      <Item Id="sq" Title="Albanian"/>
      <Item Id="am" Title="Amharic"/>
      <Item Id="ar" Title="Arabic"/>
      <Item Id="an" Title="Aragonese"/>
      <Item Id="hy" Title="Armenian"/>
      <Item Id="as" Title="Assamese"/>
      <Item Id="av" Title="Avaric"/>
      <Item Id="ae" Title="Avestan"/>
      <Item Id="ay" Title="Aymara"/>
      <Item Id="az" Title="Azerbaijani"/>
      <Item Id="bm" Title="Bambara"/>
      <Item Id="ba" Title="Bashkir"/>
      <Item Id="eu" Title="Basque"/>
      <Item Id="be" Title="Belarusian"/>
      <Item Id="bn" Title="Bengali"/>
      <Item Id="bh" Title="Bihari languages"/>
      <Item Id="bi" Title="Bislama"/>
      <Item Id="bs" Title="Bosnian"/>
      <Item Id="br" Title="Breton"/>
      <Item Id="bg" Title="Bulgarian"/>
      <Item Id="my" Title="Burmese"/>
      <Item Id="ca" Title="Catalan, Valencian"/>
      <Item Id="ch" Title="Chamorro"/>
      <Item Id="ce" Title="Chechen"/>
      <Item Id="ny" Title="Chichewa, Chewa, Nyanja"/>
      <Item Id="zh" Title="Chinese"/>
      <Item Id="cv" Title="Chuvash"/>
      <Item Id="kw" Title="Cornish"/>
      <Item Id="co" Title="Corsican"/>
      <Item Id="cr" Title="Cree"/>
      <Item Id="hr" Title="Croatian"/>
      <Item Id="cs" Title="Czech"/>
      <Item Id="da" Title="Danish"/>
      <Item Id="dv" Title="Divehi, Dhivehi, Maldivian"/>
      <Item Id="nl" Title="Dutch, Flemish"/>
      <Item Id="dz" Title="Dzongkha"/>
      <Item Id="en" Title="English"/>
      <Item Id="eo" Title="Esperanto"/>
      <Item Id="et" Title="Estonian"/>
      <Item Id="ee" Title="Ewe"/>
      <Item Id="fo" Title="Faroese"/>
      <Item Id="fj" Title="Fijian"/>
      <Item Id="fl" Title="Filipino"/>
      <Item Id="fi" Title="Finnish"/>
      <Item Id="fr" Title="French"/>
      <Item Id="ff" Title="Fulah"/>
      <Item Id="gl" Title="Galician"/>
      <Item Id="ka" Title="Georgian"/>
      <Item Id="de" Title="German"/>
      <Item Id="el" Title="Greek (modern)"/>
      <Item Id="gn" Title="Guaraní"/>
      <Item Id="gu" Title="Gujarati"/>
      <Item Id="ht" Title="Haitian, Haitian Creole"/>
      <Item Id="ha" Title="Hausa"/>
      <Item Id="he" Title="Hebrew (modern)"/>
      <Item Id="hz" Title="Herero"/>
      <Item Id="hi" Title="Hindi"/>
      <Item Id="ho" Title="Hiri Motu"/>
      <Item Id="hu" Title="Hungarian"/>
      <Item Id="ia" Title="Interlingua"/>
      <Item Id="id" Title="Indonesian"/>
      <Item Id="ie" Title="Interlingue"/>
      <Item Id="ga" Title="Irish"/>
      <Item Id="ig" Title="Igbo"/>
      <Item Id="ik" Title="Inupiaq"/>
      <Item Id="io" Title="Ido"/>
      <Item Id="is" Title="Icelandic"/>
      <Item Id="it" Title="Italian"/>
      <Item Id="iu" Title="Inuktitut"/>
      <Item Id="ja" Title="Japanese"/>
      <Item Id="jv" Title="Javanese"/>
      <Item Id="kl" Title="Kalaallisut, Greenlandic"/>
      <Item Id="kn" Title="Kannada"/>
      <Item Id="kr" Title="Kanuri"/>
      <Item Id="ks" Title="Kashmiri"/>
      <Item Id="kk" Title="Kazakh"/>
      <Item Id="km" Title="Central Khmer"/>
      <Item Id="ki" Title="Kikuyu, Gikuyu"/>
      <Item Id="rw" Title="Kinyarwanda"/>
      <Item Id="ky" Title="Kirghiz, Kyrgyz"/>
      <Item Id="kv" Title="Komi"/>
      <Item Id="kg" Title="Kongo"/>
      <Item Id="ko" Title="Korean"/>
      <Item Id="ku" Title="Kurdish"/>
      <Item Id="kj" Title="Kuanyama, Kwanyama"/>
      <Item Id="la" Title="Latin"/>
      <Item Id="lb" Title="Luxembourgish, Letzeburgesch"/>
      <Item Id="lg" Title="Ganda"/>
      <Item Id="li" Title="Limburgan, Limburger, Limburgish"/>
      <Item Id="ln" Title="Lingala"/>
      <Item Id="lo" Title="Lao"/>
      <Item Id="lt" Title="Lithuanian"/>
      <Item Id="lu" Title="Luba-Katanga"/>
      <Item Id="lv" Title="Latvian"/>
      <Item Id="gv" Title="Manx"/>
      <Item Id="mk" Title="Macedonian"/>
      <Item Id="mg" Title="Malagasy"/>
      <Item Id="ms" Title="Malay"/>
      <Item Id="ml" Title="Malayalam"/>
      <Item Id="mt" Title="Maltese"/>
      <Item Id="mi" Title="Maori"/>
      <Item Id="mr" Title="Marathi"/>
      <Item Id="mh" Title="Marshallese"/>
      <Item Id="mn" Title="Mongolian"/>
      <Item Id="na" Title="Nauru"/>
      <Item Id="nv" Title="Navajo, Navaho"/>
      <Item Id="nd" Title="North Ndebele"/>
      <Item Id="ne" Title="Nepali"/>
      <Item Id="ng" Title="Ndonga"/>
      <Item Id="nb" Title="Norwegian Bokmål"/>
      <Item Id="nn" Title="Norwegian Nynorsk"/>
      <Item Id="no" Title="Norwegian"/>
      <Item Id="ii" Title="Sichuan Yi, Nuosu"/>
      <Item Id="nr" Title="South Ndebele"/>
      <Item Id="oc" Title="Occitan"/>
      <Item Id="oj" Title="Ojibwa"/>
      <Item Id="cu" Title="Church Slavic"/>
      <Item Id="om" Title="Oromo"/>
      <Item Id="or" Title="Oriya"/>
      <Item Id="os" Title="Ossetian, Ossetic"/>
      <Item Id="pa" Title="Panjabi, Punjabi"/>
      <Item Id="pi" Title="Pali"/>
      <Item Id="fa" Title="Persian"/>
      <Item Id="pl" Title="Polish"/>
      <Item Id="ps" Title="Pashto, Pushto"/>
      <Item Id="pt" Title="Portuguese"/>
      <Item Id="qu" Title="Quechua"/>
      <Item Id="rm" Title="Romansh"/>
      <Item Id="rn" Title="Rundi"/>
      <Item Id="ro" Title="Romanian, Moldavian, Moldovan"/>
      <Item Id="ru" Title="Russian"/>
      <Item Id="sa" Title="Sanskrit"/>
      <Item Id="sc" Title="Sardinian"/>
      <Item Id="sd" Title="Sindhi"/>
      <Item Id="se" Title="Northern Sami"/>
      <Item Id="sm" Title="Samoan"/>
      <Item Id="sg" Title="Sango"/>
      <Item Id="sr" Title="Serbian"/>
      <Item Id="gd" Title="Gaelic, Scottish Gaelic"/>
      <Item Id="sn" Title="Shona"/>
      <Item Id="si" Title="Sinhala, Sinhalese"/>
      <Item Id="sk" Title="Slovak"/>
      <Item Id="sl" Title="Slovenian"/>
      <Item Id="so" Title="Somali"/>
      <Item Id="st" Title="Southern Sotho"/>
      <Item Id="es" Title="Spanish, Castilian"/>
      <Item Id="su" Title="Sundanese"/>
      <Item Id="sw" Title="Swahili"/>
      <Item Id="ss" Title="Swati"/>
      <Item Id="sv" Title="Swedish"/>
      <Item Id="ta" Title="Tamil"/>
      <Item Id="te" Title="Telugu"/>
      <Item Id="tg" Title="Tajik"/>
      <Item Id="th" Title="Thai"/>
      <Item Id="ti" Title="Tigrinya"/>
      <Item Id="bo" Title="Tibetan"/>
      <Item Id="tk" Title="Turkmen"/>
      <Item Id="tl" Title="Tagalog"/>
      <Item Id="tn" Title="Tswana"/>
      <Item Id="to" Title="Tonga (Tonga Islands)"/>
      <Item Id="tr" Title="Turkish"/>
      <Item Id="ts" Title="Tsonga"/>
      <Item Id="tt" Title="Tatar"/>
      <Item Id="tw" Title="Twi"/>
      <Item Id="ty" Title="Tahitian"/>
      <Item Id="ug" Title="Uighur, Uyghur"/>
      <Item Id="uk" Title="Ukrainian"/>
      <Item Id="ur" Title="Urdu"/>
      <Item Id="uz" Title="Uzbek"/>
      <Item Id="ve" Title="Venda"/>
      <Item Id="vi" Title="Vietnamese"/>
      <Item Id="vo" Title="Volapük"/>
      <Item Id="wa" Title="Walloon"/>
      <Item Id="cy" Title="Welsh"/>
      <Item Id="wo" Title="Wolof"/>
      <Item Id="fy" Title="Western Frisian"/>
      <Item Id="xh" Title="Xhosa"/>
      <Item Id="yi" Title="Yiddish"/>
      <Item Id="yo" Title="Yoruba"/>
      <Item Id="za" Title="Zhuang, Chuang"/>
      <Item Id="zu" Title="Zulu"/>
    </Resource>
    <Resource Id="PersonTypes">
      <Item Id="all" Title="All"/>
      <Item Id="blogger" Title="Bloggers"/>
      <Item Id="influencer" Title="Influencers"/>
      <Item Id="company" Title="Companies"/>
      <Item Id="journalist" Title="Journalists"/>
      <Item Id="regular" Title="Regular people"/>
    </Resource>
    <Resource Id="Fail">
      <Fail>
        <JsonPath Expr="error"/>
      </Fail>
    </Resource>
  </Resources>

  <RestConnector Id="MostShared" Title="Most Shared Content" HelpUrl="http://buzzsumo.com/knowledge/top-content-api/">
    <Parameters>
      <Text Id="Query" Title="Keyword/URL" Required="true"/>
      <Select Id="ResultType" Title="Sort by" DefaultValue="total" Required="false">
        <DataSource>
          <Item Id="total" Title="Total"/>
          <Item Id="facebook" Title="Facebook"/>
          <Item Id="twitter" Title="Twitter"/>
          <Item Id="linkedin" Title="LinkedIn"/>
          <Item Id="pinterest" Title="Pinterest"/>
          <Item Id="google_plus" Title="Google Plus"/>
        </DataSource>
      </Select>
      <Select Id="ArticleType" Title="Article Type" DefaultValue="all">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="general_article " Title="Articles"/>
          <Item Id="video" Title="Videos"/>
          <Item Id="list" Title="List Articles"/>
          <Item Id="how_to_article" Title="'How to' articles"/>
          <Item Id="what_post" Title="'What is X' articles"/>
          <Item Id="why_post" Title="'Why' articles"/>
          <Item Id="infographic" Title="Articles with infographics"/>
        </DataSource>
      </Select>
      <DateInterval Id="DateInterval" Title="Interval" Required="false" Nullabe="true"/>
      <Select Id="Language" Title="Language">
        <DataSource>
          <Resource Id="Languages"/>
        </DataSource>
      </Select>
      <Text Id="Tld" Title="Top-Level Domain" Required="false"/>
      <Checkbox Id="B2b" Title="Only include results from Business to Business publishers" DefaultValue="False"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="false"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.buzzsumo.com/search/articles.json?
        api_key=@(Model.ApiKey)
        &q=@(Utils.UrlEncode(Model.Query))
        @if(Model.ResultType != "total")
        {
          @: &result_type=@(Model.ResultType)
        }
        @if(Model.ArticleType != "all")
        {
          @: &article_type=@(Model.ArticleType)
        }
        @if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
        {
          @: &begin_date=@(((DateTime)Model.DateInterval.StartDate).UnixTimeStampUtc())
          @: &end_date=@(((DateTime)Model.DateInterval.EndDate).UnixTimeStampUtc())
        }
        @if(Model.Language != "all")
        {
          @: &language=@(Model.Language)
        }
        @if(!string.IsNullOrEmpty(Model.Tld))
        {
          @: &tld=@(Model.Language.Replace(",", "").Replace(" ", ""))
        }
        @if(Model.B2b == true)
        {
          @: &b2b_publishers=true
        }
        @if(Model.PageCursor.Page != 0)
        {
          @: page=@Model.PageCursor.Page
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.results.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="author_name" Id="AuthorName" Title="Author Name" Converter="String" HelpText=""/>
        <JsonPath Expr="alexa_rank" Id="AlexaRank" Title="Alexa Rank" Converter="Int" HelpText=""/>
        <JsonPath Expr="pinterest_shares" Id="PinterestShares" Title="Pinterest Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="num_words" Id="NumWords" Title="Words" Converter="Int" HelpText=""/>
        <JsonPath Expr="twitter_shares" Id="TwitterShares" Title="Twitter Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="language" Id="Language" Title="Language" Converter="String" HelpText=""/>
        <JsonPath Expr="og_url" Id="OgUrl" Title="Og. Url" Converter="String" HelpText="" Checked="false"/>
        <JsonPath Expr="video" Id="Video" Title="Video" Converter="Bool" HelpText=""/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
        <JsonPath Expr="evergreen_score" Id="EvergreenScore" Title="Evergreen Score" Converter="Float" HelpText=""/>
        <JsonPath Expr="total_shares_with_pinterest" Id="TotalSharesWithPinterest" Title="Pinterest Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="domain_name" Id="DomainName" Title="Domain Name" Converter="" HelpText=""/>
        <Compute Id="UpdatedAt" Title="Updated" Expr="@(DateTimeOffset.FromUnixTimeSeconds((long)Model.Inp))" Converter="DateTime">
          <JsonPath Expr="updated_at" Id="Inp" Converter="Long"/>
        </Compute>
        <JsonPath Expr="facebook_likes" Id="FacebookLikes" Title="Facebook Likes" Converter="Int" HelpText=""/>
        <JsonPath Expr="facebook_comments" Id="FacebookComments" Title="Facebook Comments" Converter="Int" HelpText=""/>
        <JsonPath Expr="thumbnail" Id="Thumbnail" Title="Thumbnail" Converter="String" HelpText=""/>
        <JsonPath Expr="twitter_user_id" Id="TwitterUser Id" Title="Twitter User Id" Converter="String" HelpText=""/>
        <JsonPath Expr="total_facebook_shares" Id="TotalFacebook Shares" Title="Total Facebook Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="Url" Converter="String" HelpText=""/>
        <JsonPath Expr="linkedin_shares" Id="LinkedinShares" Title="Linkedin Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="facebook_shares" Id="FacebookShares" Title="Facebook Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="num_linking_domains" Id="NumLinking Domains" Title="Linking Domains" Converter="Int" HelpText=""/>
        <JsonPath Expr="subdomain" Id="Subdomain" Title="Subdomain" Converter="String" HelpText=""/>
        <Compute Id="PublishedDate" Title="Published" Expr="@(DateTimeOffset.FromUnixTimeSeconds((long)Model.Inp))" Converter="DateTime">
          <JsonPath Expr="published_date" Id="Inp" Converter="Long"/>
        </Compute>
        <JsonPath Expr="total_shares" Id="TotalShares" Title="Total Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="display_title" Id="DisplayTitle" Title="Display Title" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Influencers" Title="Influencers" HelpUrl="http://buzzsumo.com/knowledge/influencers-api/">
    <Parameters>
      <Text Id="Query" Title="Keyword/Topic" Required="true"/>
      <Select Id="ResultType" Title="Sort by" DefaultValue="total" Required="false">
        <DataSource>
          <Item Id="avg_retweets" Title="Avg. retweets"/>
          <Item Id="num_followers" Title="Follower count"/>
          <Item Id="page_authority" Title="Page authority"/>
          <Item Id="pagerank" Title="Pagerank"/>
          <Item Id="retweet_ratio" Title="Retweet ratio"/>
          <Item Id="reply_ratio" Title="Reply ratio"/>
        </DataSource>
      </Select>
      <Select Id="PersonTypes" Title="PersonTypes" DefaultValue="all" Required="false">
        <DataSource>
          <Resource Id="PersonTypes"/>
        </DataSource>
      </Select>
      <Text Id="Location" Title="Location" Required="false" HelpText="You can pass multiple location separated with the OR operator e.g. London OR New York OR Germany etc."/>
      <Checkbox Id="IgnoreBroadcasters" Title="Ignore broadcasters" DefaultValue="False" HelpText=" Broadcasters are influencers who simply broadcast links or tweets and hardly reply to others."/>
      <Checkbox Id="WithInstagram" Title="Only profiles with Instagram username" DefaultValue="False" HelpText=""/>
      <Checkbox Id="InfluencersOnly" Title="Remove punctunation and delimiters" DefaultValue="False" HelpText=""/>
    </Parameters>
    <Paging PageSize="100" EvenPages="false"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.buzzsumo.com/search/influencers.json?
        api_key=@(Model.ApiKey)
        &q=@Utils.UrlEncode(Model.Query)
        @if(Model.ResultType != "avg_retweets")
        {
          @: &result_type=@(Model.ResultType)
        }
        @if(!string.IsNullOrEmpty(Model.Location))
        {
          @: &location=@(Utils.UrlEncode(Model.Location))
        }
        @if(Model.PersonTypes != "all")
        {
          @: &person_types=@(Model.PersonTypes)
        }
        @if(Model.WithInstagram == true)
        {
          @: &must_have_instagram_profile=true
        }
        @if(Model.InfluencersOnly == true)
        {
          @: &verified_only=true
        }
        @if(Model.IgnoreBroadcasters == true)
        {
          @: &ignore_broadcasters=true
        }
        @if(Model.PageCursor.Page != 0)
        {
          @: page=@Model.PageCursor.Page
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.results.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="username" Id="Username" Title="Username" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <JsonPath Expr="num_followers" Id="NumFollowers" Title="Followers" Converter="Int" HelpText=""/>
        <JsonPath Expr="num_following" Id="NumFollowing" Title="Following" Converter="Int" HelpText=""/>
        <JsonPath Expr="pagerank" Id="Pagerank" Title="Pagerank" Converter="Int" HelpText=""/>
        <JsonPath Expr="location" Id="Location" Title="Location" Converter="String" HelpText=""/>
        <JsonPath Expr="reply_ratio" Id="ReplyRatio" Title="Reply Ratio" Converter="Double" HelpText=""/>
        <JsonPath Expr="retweet_ratio" Id="RetweetRatio" Title="Retweet Ratio" Converter="Double" HelpText=""/>
        <JsonPath Expr="twitter_id_str" Id="TwitterIdStr" Title="Twitter Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="image" Id="Image" Title="Image" Converter="String" HelpText=""/>
        <JsonPath Expr="url_share_ratio" Id="UrlShareRatio" Title="Url Share Ratio" Converter="Int" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="Url" Converter="String" HelpText=""/>
        <JsonPath Expr="domain_authority" Id="DomainAuthority" Title="Domain Authority" Converter="Int" HelpText=""/>
        <JsonPath Expr="page_authority" Id="PageAuthority" Title="Page Authority" Converter="Int" HelpText=""/>
        <JsonPath Expr="bio" Id="Bio" Title="Bio" Converter="String" HelpText=""/>
        <JsonPath Expr="avg_retweets" Id="AvgRetweets" Title="Avg Retweets" Converter="Double" HelpText=""/>
        <JsonPath Expr="instagram_username" Id="InstagramUsername" Title="Instagram Username" Converter="Auto" HelpText=""/>
        <JsonPath Expr="instagram_authority" Id="InstagramAuthority" Title="Instagram Authority" Converter="Auto" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ArticleSharers" Title="Article Sharers" HelpUrl="http://buzzsumo.com/knowledge/sharers-api/">
    <Parameters>
      <Text Id="ArticleId" Title="Article Id" Required="true"/>
      <Select Id="ResultType" Title="Sort by" DefaultValue="relevancy" Required="false">
        <DataSource>
          <Item Id="relevancy" Title="Relevancy"/>
          <Item Id="num_followers" Title="Number of followers"/>
          <Item Id="page_authority" Title="Page Authority"/>
          <Item Id="pagerank" Title="Pagerank"/>
          <Item Id="retweet_ratio" Title="Retweet Ratio"/>
          <Item Id="reply_ratio" Title="Reply Ratio"/>
          <Item Id="avg_retweets" Title="Avg. retweets"/>
        </DataSource>
      </Select>
      <Select Id="PersonTypes" Title="PersonTypes" DefaultValue="all" Required="false">
        <DataSource>
          <Resource Id="PersonTypes"/>
        </DataSource>
      </Select>
      <Text Id="Location" Title="Location" Required="false" HelpText="You can pass multiple location separated with the OR operator e.g. London OR New York OR Germany etc."/>
      <Checkbox Id="IgnoreBroadcasters" Title="Ignore broadcasters" DefaultValue="False" HelpText=" Broadcasters are influencers who simply broadcast links or tweets and hardly reply to others."/>
      <Checkbox Id="WithInstagram" Title="Only profiles with Instagram username" DefaultValue="False" HelpText=""/>
      <Checkbox Id="InfluencersOnly" Title="Remove punctunation and delimiters" DefaultValue="False" HelpText=""/>
    </Parameters>
    <Paging PageSize="100" EvenPages="false"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.buzzsumo.com/search/shares.json?
        api_key=@(Model.ApiKey)
        &article_id=@Utils.UrlEncode(Model.ArticleId)
        @if(Model.ResultType != "relevancy")
        {
          @: &result_type=@(Model.ResultType)
        }
        @if(Model.PersonTypes != "all")
        {
          @: &person_types=@(Model.PersonTypes)
        }
        @if(Model.IgnoreBroadcasters == true)
        {
          @: &ignore_broadcasters=true
        }
        @if(Model.PageCursor.Page != 0)
        {
          @: page=@Model.PageCursor.Page
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.results.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="username" Id="Username" Title="Username" Converter="" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="" HelpText=""/>
        <JsonPath Expr="num_following" Id="NumFollowing" Title="Following" Converter="Int" HelpText=""/>
        <JsonPath Expr="pagerank" Id="Pagerank" Title="Pagerank" Converter="Int" HelpText=""/>
        <JsonPath Expr="location" Id="Location" Title="Location" Converter="String" HelpText=""/>
        <JsonPath Expr="reply_ratio" Id="ReplyRatio" Title="Reply Ratio" Converter="Int" HelpText=""/>
        <JsonPath Expr="retweet_ratio" Id="RetweetRatio" Title="Retweet Ratio" Converter="Int" HelpText=""/>
        <JsonPath Expr="person_type" Id="PersonType" Title="Person Type" Converter="String" HelpText=""/>
        <JsonPath Expr="twitter_id_str" Id="TwitterId Str" Title="Twitter Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="image" Id="Image" Title="Image" Converter="String" HelpText=""/>
        <JsonPath Expr="url_share_ratio" Id="UrlShare Ratio" Title="Url Share Ratio" Converter="Int" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="Url" Converter="String" HelpText=""/>
        <JsonPath Expr="domain_authority" Id="DomainAuthority" Title="Domain Authority" Converter="Int" HelpText=""/>
        <JsonPath Expr="page_authority" Id="PageAuthority" Title="Page Authority" Converter="Int" HelpText=""/>
        <JsonPath Expr="bio" Id="Bio" Title="Bio" Converter="String" HelpText=""/>
        <JsonPath Expr="avg_retweets" Id="AvgRetweets" Title="Avg. Retweets" Converter="Double" HelpText=""/>
        <JsonPath Expr="num_followers" Id="NumFollowers" Title="Followers" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="SharedLinks" Title="Shared Links" HelpUrl="http://buzzsumo.com/knowledge/links-shared-api/">
    <Parameters>
      <Text Id="Username" Title="Username" Required="true"/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.buzzsumo.com/search/shared_links.json?
        api_key=@(Model.ApiKey)
        &username=@Utils.UrlEncode(Model.Username)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="Url" Converter="String" HelpText=""/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
        <JsonPath Expr="article_id" Id="ArticleId" Title="Article Id" Converter="Int" HelpText=""/>
        <Compute Id="PublishedAt" Title="Published" Expr="@(DateTimeOffset.FromUnixTimeSeconds((long)Model.Inp))" Converter="DateTime">
          <JsonPath Expr="published_date" Id="Inp" Converter="Long"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Trending" Title="Trending" HelpUrl="http://buzzsumo.com/knowledge/trending-api/">
    <Parameters>
      <Select Id="SearchType" Title="Sort by" DefaultValue="trending_now">
        <DataSource>
          <Item Id="trending_now" Title="Trending score"/>
          <Item Id="most_shared" Title="Total shares"/>
        </DataSource>
      </Select>
      <Text Id="Topic" Title="Topic" Required="false"/>
      <Text Id="Tld" Title="Top-Level Domain" Required="false" HelpText="com, uk, org, etc."/>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.buzzsumo.com/search/trends.json?
        api_key=@(Model.ApiKey)
        &search_type=@(Model.SearchType)
        @if(!string.IsNullOrEmpty(Model.Topic))
        {
          @: &topic=@(Utils.UrlEncode(Model.Topic))
        }
        @if(!string.IsNullOrEmpty(Model.Tld))
        {
          @: &tld=(Utils.UrlEncode(Model.Tld))
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.results.*">
        <JsonPath Expr="linkedin_shares" Id="LinkedinShares" Title="Linkedin Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="twitter_user_id" Id="TwitterUserId" Title="Twitter User Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="total_shares_with_pinterest" Id="TotalShares With Pinterest" Title="Total Shares With Pinterest" Converter="Int" HelpText=""/>
        <JsonPath Expr="article_types" Id="ArticleTypes" Title="Article Types" Converter="String" HelpText=""/>
        <JsonPath Expr="twitter_shares" Id="TwitterShares" Title="Twitter Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="article_amplifiers" Id="ArticleAmplifiers" Title="Article Amplifiers" Converter="String" HelpText=""/>
        <JsonPath Expr="og_url" Id="OgUrl" Title="Og Url" Converter="String" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="Url" Converter="String" HelpText=""/>
        <JsonPath Expr="pinterest_shares" Id="PinterestShares" Title="Pinterest Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="total_shares" Id="TotalShares" Title="Total Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
        <JsonPath Expr="thumbnail" Id="Thumbnail" Title="Thumbnail" Converter="String" HelpText=""/>
        <JsonPath Expr="subdomain" Id="Subdomain" Title="Subdomain" Converter="String" HelpText=""/>
        <JsonPath Expr="author_name" Id="AuthorName" Title="Author Name" Converter="String" HelpText=""/>
        <JsonPath Expr="num_words" Id="NumWords" Title="Num Words" Converter="Int" HelpText=""/>
        <JsonPath Expr="domain_name" Id="DomainName" Title="Domain Name" Converter="String" HelpText=""/>
        <JsonPath Expr="total_facebook_shares" Id="TotalFacebookShares" Title="Total Facebook Shares" Converter="Int" HelpText=""/>
        <JsonPath Expr="trending_score" Id="TrendingScore" Title="Trending Score" Converter="Int" HelpText=""/>
        <JsonPath Expr="giveaway" Id="Giveaway" Title="Giveaway" Converter="Bool" HelpText=""/>
        <JsonPath Expr="infographic" Id="Infographic" Title="Infographic" Converter="Bool" HelpText=""/>
        <JsonPath Expr="general_article" Id="GeneralArticle" Title="General Article" Converter="Bool" HelpText=""/>
        <JsonPath Expr="guest_post" Id="GuestPost" Title="Guest Post" Converter="Bool" HelpText=""/>
        <JsonPath Expr="interview" Id="Interview" Title="Interview" Converter="Bool" HelpText=""/>
        <JsonPath Expr="video" Id="Video" Title="Video" Converter="Bool" HelpText=""/>
        <Compute Id="PublishedAt" Title="Published" Expr="@(DateTimeOffset.FromUnixTimeSeconds((long)Model.Inp))" Converter="DateTime">
          <JsonPath Expr="published_date" Id="Inp" Converter="Long"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

</Suite>