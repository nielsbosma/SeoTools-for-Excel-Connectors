<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Twitter Ads" Id="TwitterAds" Category="Ads" RequireVersion="7.0.2" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/TwitterAds.xml" HelpUrl="http://seotoolsforexcel.com/twitter-ads/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity" />

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/twitter-ads/">
    <Text Id="OAuthToken" Title="OAuth Token" Required="true" HelpUrl="http://seotoolsforexcel.com/twitter-ads/"/>
    <Text Id="OAuthTokenSecret" Title="OAuth Token Secret" Required="true"/>
    <Text Id="OAuthConsumerKey" Title="OAuth Consumer Key" Required="true"/>
    <Text Id="OAuthConsumerSecret" Title="OAuth Consumer Secret" Required="true"/>
  </Settings>

  <Resources>
    <Resource Id="CampaignsSortings">
      <Item Id="created_at-desc" Title="Created Desc"/>
      <Item Id="created_at-asc" Title="Created Asc"/>
      <Item Id="updated_at-desc" Title="Updated Desc"/>
      <Item Id="updated_at-asc" Title="Updated Asc"/>
      <Item Id="name-desc" Title="Name Desc"/>
      <Item Id="name-asc" Title="Name Asc"/>
      <Item Id="start_time-desc" Title="Start Time Desc"/>
      <Item Id="start_time-asc" Title="Start Time Asc"/>
      <Item Id="end_time-desc" Title="End Time Desc"/>
      <Item Id="end_time-asc" Title="End Time Asc"/>
      <Item Id="bid_amount_local_micro-desc" Title="Bid Amount Desc"/>
      <Item Id="bid_amount_local_micro-asc" Title="Bid Amount Asc"/>
    </Resource>
    <Resource Id="LineItemsSortings">
      <Item Id="created_at-desc" Title="Created Desc"/>
      <Item Id="created_at-asc" Title="Created Asc"/>
      <Item Id="updated_at-desc" Title="Updated Desc"/>
      <Item Id="updated_at-asc" Title="Updated Asc"/>
      <Item Id="bid_amount_local_micro-desc" Title="Bid Amount Desc"/>
      <Item Id="bid_amount_local_micro-asc" Title="Bid Amount Asc"/>
    </Resource>
    <Resource Id="PromotedTweetsSortings">
      <Item Id="created_at-desc" Title="Created Desc"/>
      <Item Id="created_at-asc" Title="Created Asc"/>
      <Item Id="updated_at-desc" Title="Updated Desc"/>
      <Item Id="updated_at-asc" Title="Updated Asc"/>
    </Resource>
    <Resource Id="FundingInstrumentsSortings">
      <Item Id="created_at-desc" Title="Created Desc"/>
      <Item Id="created_at-asc" Title="Created Asc"/>
      <Item Id="updated_at-desc" Title="Updated Desc"/>
      <Item Id="updated_at-asc" Title="Updated Asc"/>
      <Item Id="start_time-desc" Title="Start Time Desc"/>
      <Item Id="start_time-asc" Title="Start Time Asc"/>
      <Item Id="end_time-desc" Title="End Time Desc"/>
      <Item Id="end_time-asc" Title="End Time Asc"/>
      <Item Id="funded_amount_local_micro-desc" Title="Funded Amount Desc"/>
      <Item Id="funded_amount_local_micro-asc" Title="Funded Amount Asc"/>
    </Resource>
    <Resource Id="Objectives">
      <Item Id="none" Title="None"/>
      <Item Id="APP_ENGAGEMENTS" Title="App Engagements"/>
      <Item Id="APP_INSTALLS" Title="App Installs"/>
      <Item Id="AWARENESS" Title="Awareness"/>
      <Item Id="FOLLOWERS" Title="Followers"/>
      <Item Id="TWEET_ENGAGEMENTS" Title="Tweet Engagement"/>
      <Item Id="VIDEO_VIEWS" Title="Video Views"/>
      <Item Id="WEBSITE_CLICKS" Title="Website Clicks"/>
      <Item Id="WEBSITE_CONVERSIONS" Title="Website Conversions"/>
    </Resource>
  </Resources>

  <RestConnector Id="Accounts" Hidden="true">
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="CampaignsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/campaigns?
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="LineItemsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/line_items?
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PromotedTweetsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/promoted_tweets?
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <Compute Id="TweetUrl" Title="Tweet URL">
          <Compute.Expr>
            <![CDATA[
            /statuses/@(Model.TweetIdInput)/
            ]]>
          </Compute.Expr>
          <JsonPath Expr="tweet_id" Id="TweetIdInput" Converter="String"/>
        </Compute>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="FundingInstrumentsHidden" Hidden="true">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/funding_instruments?
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="Campaigns" Title="Campaigns Overview" HelpUrl="https://dev.twitter.com/ads/reference/get/accounts/account_id/campaigns">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Select Id="Sort" Title="Sort Results by" Required="false" DefaultValue="created_at-desc">
        <DataSource>
          <Resource Id="CampaignsSortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="100" EvenPages="false">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_count"/>
        <JsonPath Id="Cursor" Expr="next_cursor"/>
      </Parse>
    </Paging>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/campaigns?
        count=@(Model.PageCursor.NextTake)
        &sort_by=@(Model.Sort)
        @if(Model.PageCursor.Page != 0)

        {
          @: &cursor=@(Model.Cursor)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
        <JsonPath Expr="entity_status" Id="Status" Title="Status" Converter="String"/>
        <JsonPath Expr="daily_budget_amount_local_micro" Id="DailyBudget" Title="Daily Budget" Converter="Int"/>
        <JsonPath Expr="total_budget_amount_local_micro" Id="TotalBudget" Title="Total Budget" Converter="Int"/>
        <JsonPath Expr="start_time" Id="StartTime" Title="Start Time" Converter="Auto" DefaultValue=""/>
        <JsonPath Expr="end_time" Id="EndTime" Title="End Time" Converter="Auto"/>
        <JsonPath Expr="funding_instrument_id" Id="FundingInstrumentId" Title="Funding Instrument Id" Converter="String"/>
        <JsonPath Expr="servable" Id="Servable" Title="Servable" Converter="Bool"/>
        <Compute Id="ReasonsNotServable" Title="Reasons not Servable" Converter="String">
          <Compute.Expr>
            <![CDATA[
            @{
              var temp = Regex.Replace(Model.ReasonsNotServableInput, @"\s+", " ");
              var stripped = temp.Substring(1,temp.Length-2);
            }
            @stripped
            ]]>
          </Compute.Expr>
        <JsonPath Expr="reasons_not_servable" Id="ReasonsNotServableInput" Converter="String"/>
        </Compute>
        <JsonPath Expr="duration_in_days" Id="DayDuration" Title="DayDuration" Converter="Int" Defaultvalue=" "/>
        <JsonPath Expr="standard_delivery" Id="StandardDelivery" Title="Standar dDelivery" Converter="Bool"/>
        <JsonPath Expr="frequency_cap" Id="FrequencyCap" Title="Frequency Cap" Converter="String"/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String"/>
        <JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
        <JsonPath Expr="updated_at" Id="Updated" Title="Updated	" Converter="DateTime"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="LineItems" Title="Ad Groups Overview" HelpUrl="https://dev.twitter.com/ads/reference/get/accounts/account_id/line_items">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Select Id="Sort" Title="Sort Results by" Required="false" DefaultValue="created_at-desc">
        <DataSource>
          <Resource Id="LineItemsSortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="100" EvenPages="false">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_count"/>
        <JsonPath Id="Cursor" Expr="next_cursor"/>
      </Parse>
    </Paging>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/line_items?
        count=@(Model.PageCursor.NextTake)
        &sort_by=@(Model.Sort)
        @if(Model.PageCursor.Page != 0)
        {
          @: &cursor=@(Model.Cursor)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String"/>
        <JsonPath Expr="entity_status" Id="Status" Title="Status" Converter="String"/>
        <JsonPath Expr="bid_type" Id="BidType" Title="Bid Type" Converter="String"/>
        <JsonPath Expr="objective" Id="Objective" Title="Objective" Converter="String"/>
        <JsonPath Expr="bid_amount_local_micro" Id="BidAmount" Title="Bid Amount" Converter="Int"/>
        <JsonPath Expr="total_budget_amount_local_micro" Id="TotalBudgetAmount" Title="Total Budget Amount" Converter="Int"/>
        <Compute Id="Placements" Title="Placements" Converter="String">
          <Compute.Expr>
            <![CDATA[
            @{
              var temp = Regex.Replace(Model.PlacementsInput, @"\s+", " ");
              var stripped = temp.Substring(1,temp.Length-2);
            }
            @stripped
            ]]>
          </Compute.Expr>
        <JsonPath Expr="placements" Id="PlacementsInput" Converter="String"/>
        </Compute>
        <JsonPath Expr="charge_by" Id="ChargeBy" Title="Charge By" Converter="String"/>
        <JsonPath Expr="automatically_select_bid" Id="AutoSelectBid" Title="Auto Select Bid" Converter="String"/>
        <JsonPath Expr="advertiser_domain" Id="AdvertiserDomain" Title="Advertiser Domain" Converter="String"/>
        <JsonPath Expr="product_type" Id="ProductType" Title="Product Type" Converter="String"/>
        <JsonPath Expr="bid_unit" Id="BidUnit" Title="Bid Unit" Converter="String"/>
        <JsonPath Expr="optimization" Id="Optimization" Title="Optimization" Converter="String"/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String"/>
        <JsonPath Expr="include_sentiment" Id="IncludeSentiment" Title="Include Sentiment" Converter="String"/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String"/>
        <JsonPath Expr="campaign_id" Id="CampaignId" Title="Campaign Id" Converter="String"/>
        <JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
        <JsonPath Expr="updated_at" Id="Updated" Title="Updated	" Converter="DateTime"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PromotedTweets" Title="Promoted Tweets Overview" HelpUrl="https://dev.twitter.com/ads/reference/get/accounts/%3Aaccount_id/promoted_tweets">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Select Id="Sort" Title="Sort Results by" Required="false" DefaultValue="created_at-desc">
        <DataSource>
          <Resource Id="PromotedTweetsSortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="100" EvenPages="false">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_count"/>
        <JsonPath Id="Cursor" Expr="next_cursor"/>
      </Parse>
    </Paging>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/promoted_tweets?
        count=@(Model.PageCursor.NextTake)
        &sort_by=@(Model.Sort)
        @if(Model.PageCursor.Page != 0)
        {
          @: &cursor=@(Model.Cursor)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="tweet_id" Id="TweetId" Title="TweetId" Converter="String"/>
        <Compute Id="TweetUrl" Title="Tweet URL">
          <Compute.Expr>
            <![CDATA[
            http://www.twitter.com/statuses/@(Model.TweetIdInput)/
            ]]>
          </Compute.Expr>
          <JsonPath Expr="tweet_id" Id="TweetIdInput" Converter="String"/>
        </Compute>
        <JsonPath Expr="line_item_id" Id="LiteItemId" Title="Lite Item Id" Converter="String"/>
        <JsonPath Expr="approval_status" Id="ApprovedStatus" Title="Approved Status" Converter="String"/>
        <JsonPath Expr="deleted" Id="Deleted" Title="Deleted" Converter="Bool"/>
        <JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
        <JsonPath Expr="updated_at" Id="Updated" Title="Updated	" Converter="DateTime"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="FundingInstruments" Title="Funding Instruments Overview" HelpUrl="https://dev.twitter.com/ads/reference/get/accounts/%3Aaccount_id/funding_instruments">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Select Id="Sort" Title="Sort Results by" Required="false" DefaultValue="created_at-desc">
        <DataSource>
          <Resource Id="FundingInstrumentsSortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="100" EvenPages="false">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_count"/>
        <JsonPath Id="Cursor" Expr="next_cursor"/>
      </Parse>
    </Paging>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/funding_instruments?
        count=@(Model.PageCursor.NextTake)
        &sort_by=@(Model.Sort)
        @if(Model.PageCursor.Page != 0)
        {
          @: &cursor=@(Model.Cursor)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String"/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String"/>
        <JsonPath Expr="start_time" Id="Started" Title="Started" Converter="DateTime"/>
        <JsonPath Expr="funded_amount_local_micro" Id="FundedAmount" Title="Funded Amount" Converter="Int"/>
        <JsonPath Expr="credit_limit_local_micro" Id="CreditLimit" Title="Credit Limit" Converter="Int"/>
        <JsonPath Expr="credit_remaining_local_micro" Id="CreditRemaining" Title="Credit Remaining" Converter="Int"/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String"/>
        <JsonPath Expr="able_to_fund" Id="AbletoFund" Title="Able to Fund" Converter="Bool"/>
        <JsonPath Expr="deleted" Id="Deleted" Title="Deleted" Converter="Bool"/>
        <JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime"/>
        <JsonPath Expr="updated_at" Id="Updated" Title="Updated	" Converter="DateTime"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AccountStatistics" Title="Account Statistics" HelpUrl="https://dev.twitter.com/ads/reference/1/get/stats/accounts/account_id">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="Granularity" Title="Granularity" DefaultValue="TOTAL" Required="false">
        <DataSource>
          <Item Id="DAY" Title="Daily"/>
          <Item Id="HOUR" Title="Hourly"/>
          <Item Id="TOTAL" Title="Total"/>
        </DataSource>
      </Radio>
      <Radio Id="Placement" Title="Placement" DefaultValue="ALL_ON_TWITTER" Required="false">
        <DataSource>
          <Item Id="ALL_ON_TWITTER" Title="All on Twitter"/>
          <Item Id="PUBLISHER_NETWORK" Title="Publisher Network"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/stats/accounts/@(Model.AccountId)
        ?entity=ACCOUNT
				&entity_ids=@(Model.AccountId)
        &placement=@(Model.Placement)
        &start_time=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
        &end_time=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
        &granularity=@(Model.Granularity)
        &metric_groups=ENGAGEMENT
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data[*].id_data[*].metrics.impressions[*]">
        <JsonPath Expr="." Id="Impressions" Title="Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.engagements[*]">
        <JsonPath Expr="." Id="Engagements" Title="Engagements" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.follows[*]">
        <JsonPath Expr="." Id="Follows" Title="Follows" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.retweets[*]">
        <JsonPath Expr="." Id="Retweets" Title="Retweets" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.likes[*]">
        <JsonPath Expr="." Id="Likes" Title="Likes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.replies[*]">
        <JsonPath Expr="." Id="Replies" Title="Replies" Converter="Int"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="CampaignStatistics" Title="Campaign Statistics" HelpUrl="https://dev.twitter.com/ads/reference/1/get/stats/accounts/account_id">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Text Id="CampaignId" Title="Campaign Id" DefaultValue="" Debug.DefaultValue="" Required="true" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="Granularity" Title="Granularity" DefaultValue="TOTAL" Required="false">
        <DataSource>
          <Item Id="DAY" Title="Daily"/>
          <Item Id="HOUR" Title="Hourly"/>
          <Item Id="TOTAL" Title="Total"/>
        </DataSource>
      </Radio>
      <Radio Id="Placement" Title="Placement" DefaultValue="ALL_ON_TWITTER" Required="false">
        <DataSource>
          <Item Id="ALL_ON_TWITTER" Title="All on Twitter"/>
          <Item Id="PUBLISHER_NETWORK" Title="Publisher Network"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/stats/accounts/@(Model.AccountId)
        ?entity=CAMPAIGN&entity_ids=@(Model.CampaignId)
        &placement=@(Model.Placement)
        &start_time=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
        &end_time=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
        &granularity=@(Model.Granularity)
        &metric_groups=ENGAGEMENT,BILLING
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data[*].id_data[*].metrics.impressions[*]">
        <JsonPath Expr="." Id="Impressions" Title="Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.qualified_impressions[*]">
        <JsonPath Expr="." Id="QualifiedImpressions" Title="Qualified Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.follows[*]">
        <JsonPath Expr="." Id="Follows" Title="Follows" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.retweets[*]">
        <JsonPath Expr="." Id="Retweets" Title="Retweets" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.likes[*]">
        <JsonPath Expr="." Id="Likes" Title="Likes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.replies[*]">
        <JsonPath Expr="." Id="Replies" Title="Replies" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.tweets_send[*]">
        <JsonPath Expr="." Id="TweetsSend" Title="Tweets Send" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.clicks[*]">
        <JsonPath Expr="." Id="Clicks" Title="Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.url_clicks[*]">
        <JsonPath Expr="." Id="UrlClicks" Title="URL Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.card_engagements[*]">
        <JsonPath Expr="." Id="CardEngagements" Title="Card Engagements" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.carousel_swipes[*]">
        <JsonPath Expr="." Id="CarouselSwipes" Title="Carousel Swipes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_charge_local_micro[*]">
        <JsonPath Expr="." Id="BilledCharge" Title="BilledCharge" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_engagements[*]">
        <JsonPath Expr="." Id="BilledEngagements" Title="Billed Engagements" Converter="Int"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="LineItemsStatistics" Title="Ad Groups Statistics" HelpUrl="https://dev.twitter.com/ads/reference/1/get/stats/accounts/account_id">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Text Id="LineItemId" Title="Ad Group Id" DefaultValue="" Debug.DefaultValue="" Required="true" Select.Connector="LineItemsHidden" Select.IdField="Id" Select.TitleField="Name"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="Granularity" Title="Granularity" DefaultValue="TOTAL" Required="false">
        <DataSource>
          <Item Id="DAY" Title="Daily"/>
          <Item Id="HOUR" Title="Hourly"/>
          <Item Id="TOTAL" Title="Total"/>
        </DataSource>
      </Radio>
      <Radio Id="Placement" Title="Placement" DefaultValue="ALL_ON_TWITTER" Required="false">
        <DataSource>
          <Item Id="ALL_ON_TWITTER" Title="All on Twitter"/>
          <Item Id="PUBLISHER_NETWORK" Title="Publisher Network"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/stats/accounts/@(Model.AccountId)
        ?entity=LINE_ITEM&entity_ids=@(Model.LineItemId)
        &placement=@(Model.Placement)
        &start_time=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
        &end_time=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
        &granularity=@(Model.Granularity)
        &metric_groups=ENGAGEMENT,BILLING
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data[*].id_data[*].metrics.impressions[*]">
        <JsonPath Expr="." Id="Impressions" Title="Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.qualified_impressions[*]">
        <JsonPath Expr="." Id="QualifiedImpressions" Title="Qualified Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.follows[*]">
        <JsonPath Expr="." Id="Follows" Title="Follows" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.retweets[*]">
        <JsonPath Expr="." Id="Retweets" Title="Retweets" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.likes[*]">
        <JsonPath Expr="." Id="Likes" Title="Likes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.replies[*]">
        <JsonPath Expr="." Id="Replies" Title="Replies" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.tweets_send[*]">
        <JsonPath Expr="." Id="TweetsSend" Title="Tweets Send" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.clicks[*]">
        <JsonPath Expr="." Id="Clicks" Title="Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.url_clicks[*]">
        <JsonPath Expr="." Id="UrlClicks" Title="URL Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.card_engagements[*]">
        <JsonPath Expr="." Id="CardEngagements" Title="Card Engagements" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.carousel_swipes[*]">
        <JsonPath Expr="." Id="CarouselSwipes" Title="Carousel Swipes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_charge_local_micro[*]">
        <JsonPath Expr="." Id="BilledCharge" Title="BilledCharge" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_engagements[*]">
        <JsonPath Expr="." Id="BilledEngagements" Title="Billed Engagements" Converter="Int"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PromotedTweetsStatistics" Title="Promoted Tweets Statistics" HelpUrl="https://dev.twitter.com/ads/reference/1/get/stats/accounts/account_id">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Text Id="PromotedTweetId" Title="Promoted Tweet Id" DefaultValue="" Debug.DefaultValue="" Required="true" Select.Connector="PromotedTweetsHidden" Select.IdField="Id" Select.TitleField="TweetUrl"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="Granularity" Title="Granularity" DefaultValue="TOTAL" Required="false">
        <DataSource>
          <Item Id="DAY" Title="Daily"/>
          <Item Id="HOUR" Title="Hourly"/>
          <Item Id="TOTAL" Title="Total"/>
        </DataSource>
      </Radio>
      <Radio Id="Placement" Title="Placement" DefaultValue="ALL_ON_TWITTER" Required="false">
        <DataSource>
          <Item Id="ALL_ON_TWITTER" Title="All on Twitter"/>
          <Item Id="PUBLISHER_NETWORK" Title="Publisher Network"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/stats/accounts/@(Model.AccountId)
        ?entity=PROMOTED_TWEET&entity_ids=@(Model.PromotedTweetId)
        &placement=@(Model.Placement)
        &start_time=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
        &end_time=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
        &granularity=@(Model.Granularity)
        &metric_groups=ENGAGEMENT,BILLING
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data[*].id_data[*].metrics.impressions[*]">
        <JsonPath Expr="." Id="Impressions" Title="Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.qualified_impressions[*]">
        <JsonPath Expr="." Id="QualifiedImpressions" Title="Qualified Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.follows[*]">
        <JsonPath Expr="." Id="Follows" Title="Follows" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.retweets[*]">
        <JsonPath Expr="." Id="Retweets" Title="Retweets" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.likes[*]">
        <JsonPath Expr="." Id="Likes" Title="Likes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.replies[*]">
        <JsonPath Expr="." Id="Replies" Title="Replies" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.tweets_send[*]">
        <JsonPath Expr="." Id="TweetsSend" Title="Tweets Send" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.clicks[*]">
        <JsonPath Expr="." Id="Clicks" Title="Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.url_clicks[*]">
        <JsonPath Expr="." Id="UrlClicks" Title="URL Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.card_engagements[*]">
        <JsonPath Expr="." Id="CardEngagements" Title="Card Engagements" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.carousel_swipes[*]">
        <JsonPath Expr="." Id="CarouselSwipes" Title="Carousel Swipes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_charge_local_micro[*]">
        <JsonPath Expr="." Id="BilledCharge" Title="BilledCharge" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_engagements[*]">
        <JsonPath Expr="." Id="BilledEngagements" Title="Billed Engagements" Converter="Int"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="FundingInstrumentsStatistics" Title="Funding Instruments Statistics" HelpUrl="https://dev.twitter.com/ads/reference/1/get/stats/accounts/account_id">
    <Parameters>
      <Text Id="AccountId" Title="Account Id" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Text Id="FundingInstrumentId" Title="Funding Instrument Id" DefaultValue="" Debug.DefaultValue="" Required="true" Select.Connector="FundingInstrumentsHidden" Select.IdField="Id" Select.TitleField="Description"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
      <Radio Id="Granularity" Title="Granularity" DefaultValue="TOTAL" Required="false">
        <DataSource>
          <Item Id="DAY" Title="Daily"/>
          <Item Id="HOUR" Title="Hourly"/>
          <Item Id="TOTAL" Title="Total"/>
        </DataSource>
      </Radio>
      <Radio Id="Placement" Title="Placement" DefaultValue="ALL_ON_TWITTER" Required="false">
        <DataSource>
          <Item Id="ALL_ON_TWITTER" Title="All on Twitter"/>
          <Item Id="PUBLISHER_NETWORK" Title="Publisher Network"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/stats/accounts/@(Model.AccountId)
        ?entity=FUNDING_INSTRUMENT&entity_ids=@(Model.FundingInstrumentId)
        &placement=@(Model.Placement)
        &start_time=@(Model.DateInterval.StartDate.ToString("yyyy-MM-dd"))
        &end_time=@(Model.DateInterval.EndDate.AddDays(1).ToString("yyyy-MM-dd"))
        &granularity=@(Model.Granularity)
        &metric_groups=ENGAGEMENT,BILLING
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data[*].id_data[*].metrics.impressions[*]">
        <JsonPath Expr="." Id="Impressions" Title="Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.qualified_impressions[*]">
        <JsonPath Expr="." Id="QualifiedImpressions" Title="Qualified Impressions" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.follows[*]">
        <JsonPath Expr="." Id="Follows" Title="Follows" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.retweets[*]">
        <JsonPath Expr="." Id="Retweets" Title="Retweets" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.likes[*]">
        <JsonPath Expr="." Id="Likes" Title="Likes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.replies[*]">
        <JsonPath Expr="." Id="Replies" Title="Replies" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.tweets_send[*]">
        <JsonPath Expr="." Id="TweetsSend" Title="Tweets Send" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.clicks[*]">
        <JsonPath Expr="." Id="Clicks" Title="Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.url_clicks[*]">
        <JsonPath Expr="." Id="UrlClicks" Title="URL Clicks" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.card_engagements[*]">
        <JsonPath Expr="." Id="CardEngagements" Title="Card Engagements" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.carousel_swipes[*]">
        <JsonPath Expr="." Id="CarouselSwipes" Title="Carousel Swipes" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_charge_local_micro[*]">
        <JsonPath Expr="." Id="BilledCharge" Title="BilledCharge" Converter="Int"/>
      </JsonPath>
      <JsonPath Expr="$.data[*].id_data[*].metrics.billed_engagements[*]">
        <JsonPath Expr="." Id="BilledEngagements" Title="Billed Engagements" Converter="Int"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PromotableTweets" Title="Promotable Tweets" HelpUrl="https://dev.twitter.com/ads/reference/get/accounts/%3Aaccount_id/scoped_timeline">
    <Parameters>
      <Text Id="AccountId" Title="AccountId" DefaultValue="" Debug.DefaultValue="18ce53ybec6" Required="true" Select.Connector="Accounts" Select.IdField="Id" Select.TitleField="Name"/>
      <Select Id="Objective" Title="Preferred Objective" Required="false" DefaultValue="none">
        <DataSource>
          <Resource Id="Objectives"/>
        </DataSource>
      </Select>
      <Checkbox Id="PromotedOnly" Title="Promoted Tweets Only" DefaultValue="false"/>
      </Parameters>
    <Paging PageSize="100" EvenPages="false">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_count"/>
        <JsonPath Id="Cursor" Expr="next_cursor"/>
      </Parse>
    </Paging>
    <Fetch Url="">
      <HttpSettings>
        <OAuth>
          <ConsumerKey>@Model.OAuthConsumerKey</ConsumerKey>
          <ConsumerSecret>@Model.OAuthConsumerSecret</ConsumerSecret>
          <Token>@Model.OAuthToken</Token>
          <TokenSecret>@Model.OAuthTokenSecret</TokenSecret>
        </OAuth>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://ads-api.twitter.com/3/accounts/
        @(Model.AccountId)/scoped_timeline?
        @if(Model.Objective != "none")
        {
          @: objective=@(Model.Objective)
        }
        @if(Model.PromotedOnly == true)
        {
          @: &scoped_to=none
        }
        &objective=WEBSITE_CLICKS
        &count=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &cursor=@(Model.Cursor)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id_str" Id="Id" Title="Id" Converter="String"/>
        <Compute Id="Url" Title="URL">
          <Compute.Expr>
            <![CDATA[
            https://twitter.com/@(Model.ScreenName)/status/@(Model.IdStr)
            ]]>
          </Compute.Expr>
          <JsonPath Expr="id_str" Id="IdStr" Converter="String"/>
          <JsonPath Expr="user.screen_name" Id="ScreenName" Converter="String"/>
        </Compute>
      </JsonPath>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="created_at" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="ddd MMM dd HH:mm:ss +ffff yyyy"/>
        <JsonPath Expr="text" Id="text" Title="Tweet"/>
        <Compute Id="Source" Title="Source">
          <Compute.Expr>
            <![CDATA[
            @{
            var temp = Model.Source.Substring(Model.Source.IndexOf("nofollow\">")+10);
            var stringfinal = temp.Remove(temp.Length-4);
            }
            @stringfinal
            ]]>
          </Compute.Expr>
          <JsonPath Expr="source" Id="Source" Converter="String"/>
        </Compute>
        <JsonPath Expr="retweet_count" Id="RetweetCount" Title="Retweets" Converter="Int"/>
        <JsonPath Expr="favorite_count" Id="FavoriteCount" Title="Likes" Converter="Int"/>
        <JsonPath Expr="entities.urls[0].expanded_url" Id="AttachedUrl" Title="Attached URL" Converter="String" DefaultValue=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="errors[0].message"/>
    </Fail>
  </RestConnector>

</Suite>