<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Siteimprove" Id="Siteimprove" Category="SEO" RequireVersion="7.0.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Siteimprove.xml" HelpUrl="http://seotoolsforexcel.com/siteimprove/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity" />

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/siteimprove/">
    <Text Id="Email" Title="Email" Required="true" HelpUrl="http://seotoolsforexcel.com/siteimprove/"/>
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/siteimprove/"/>
  </Settings>

  <RestConnector Id="Sites" Title="Site - List" HelpUrl="https://api.siteimprove.com/v2/documentation#!/General/get_sites" HelpText="Get a list of sites for this account.">
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="site_name" Id="Site" Title="Site" Converter="String" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
        <JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Int" HelpText=""/>
        <JsonPath Expr="policies" Id="Policies" Title="Policies" Converter="Int" HelpText=""/>
        <JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SiteLookup" Title="Site - Lookup" HelpUrl="https://api.siteimprove.com/v2/documentation#!/General/get_sites_site_id" HelpText="Get a specific site for this account.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
			<JsonPath Expr="site_name" Id="Site" Title="Site" Converter="String" HelpText=""/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
			<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Int" HelpText=""/>
			<JsonPath Expr="policies" Id="Policies" Title="Policies" Converter="Int" HelpText=""/>
			<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Int" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SiteDCI" Title="Site - DCI Scores" HelpUrl="https://api.siteimprove.com/v2/documentation#!/General/get_sites_site_id_dci_overview" HelpText="Get all DCI scores associated with this site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/dci/overview
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="total" Id="Total" Title="Total" Converter="Double" HelpText=""/>
			<JsonPath Expr="accessibility.errorpages" Id="Errorpages" Title="Errorpages" Converter="Double" HelpText=""/>
			<JsonPath Expr="accessibility.errors" Id="Errors" Title="Errors" Converter="Double" HelpText=""/>
			<JsonPath Expr="accessibility.total" Id="TotalPages" Title="Total Pages" Converter="Double" HelpText=""/>
			<JsonPath Expr="accessibility.warnings" Id="Warnings" Title="Warnings" Converter="Double" HelpText=""/>
			<JsonPath Expr="qa.content" Id="QAContent" Title="QA - Content" Converter="Double" HelpText=""/>
			<JsonPath Expr="qa.freshness" Id="QAFreshness" Title="QA - Freshness" Converter="Double" HelpText=""/>
			<JsonPath Expr="qa.security" Id="QASecurity" Title="QA - Security" Converter="Double" HelpText=""/>
			<JsonPath Expr="qa.total" Id="QATotal" Title="QA - Total" Converter="Double" HelpText=""/>
			<JsonPath Expr="qa.ux" Id="QAUx" Title="QA - UX" Converter="Double" HelpText=""/>
			<JsonPath Expr="seo.content" Id="SeoContent" Title="Seo - Content" Converter="Double" HelpText=""/>
			<JsonPath Expr="seo.mobile" Id="SeoMobile" Title="Seo - Mobile" Converter="Double" HelpText=""/>
			<JsonPath Expr="seo.technical" Id="SeoTechnical" Title="Seo - Technical" Converter="Double" HelpText=""/>
			<JsonPath Expr="seo.total" Id="SeoTotal" Title="Seo - Total" Converter="Double" HelpText=""/>
			<JsonPath Expr="seo.ux" Id="SeoUx" Title="Seo - UX" Converter="Double" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageStatusUrl" Title="Page - Status by URL" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_check_page" HelpText="Check status for a page specified by Url.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="Url" Title="URL" DefaultValue="" Debug.DefaultValue="" Required="true"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/check/page?url=@(Utils.UrlEncode(Model.Url))
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
			<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
			<JsonPath Expr="first_seen" Id="FirstSeen" Title="First Seen" Converter="String" HelpText=""/>
			<JsonPath Expr="last_seen" Id="LastSeen" Title="Last Seen" Converter="String" HelpText=""/>
			<JsonPath Expr="check_allowed" Id="CheckAllowed" Title="Check Allowed" Converter="Bool" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="PageStatusId" Title="Page - Status by Id" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_check_page_page_id" HelpText="Check status for a page via page id.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Debug.DefaultValue="" Required="true"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/check/page/@(Model.PageId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
			<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
			<JsonPath Expr="first_seen" Id="FirstSeen" Title="First Seen" Converter="DateTime" HelpText=""/>
			<JsonPath Expr="last_seen" Id="LastSeen" Title="Last Seen" Converter="DateTime" HelpText=""/>
			<JsonPath Expr="check_allowed" Id="CheckAllowed" Title="Check Allowed" Converter="Bool" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SiteCrawlStatus" Title="Site - Crawl Status" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_crawl" HelpText="Get info about the crawl status for a site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/crawl
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="last_crawl" Id="LastCrawled" Title="Last Crawled" Converter="DateTime" HelpText=""/>
			<JsonPath Expr="next_crawl" Id="NextCrawl" Title="Next Crawl" Converter="DateTime" HelpText=""/>
			<JsonPath Expr="permission" Id="Permission" Title="Permission" Converter="String" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="Pages" Title="Pages - List" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_pages" HelpText="Get list of pages for a site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="Url" Title="Filter by URL" DefaultValue="" Debug.DefaultValue="" Required="false"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(!string.IsNullOrEmpty(Model.Url))
					{
						@: &url=@Utils.UrlEncode(Model.Url)
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

 <RestConnector Id="PageDetails" Title="Page - Details" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Content/get_sites_site_id_content_pages_page_id" HelpText="Get page details for a page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Debug.DefaultValue="" Required="true"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/content/pages/@(Model.PageId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
			<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
			<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
			<JsonPath Expr="size_bytes" Id="Bytes" Title="Bytes" Converter="Long" HelpText=""/>
      <JsonPath Expr="$.summary.page">
				<JsonPath Expr="last_seen" Id="LastSeen" Title="LastSeen" Converter="Auto" HelpText=""/>
				<JsonPath Expr="check_allowed" Id="CheckAllowed" Title="Check Allowed" Converter="Bool" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="$.summary.seo">
				<JsonPath Expr="errors" Id="Errors" Title="Errors" Converter="Long" HelpText=""/>
				<JsonPath Expr="needs_review" Id="NeedsReview" Title="Needs Review" Converter="Long" HelpText=""/>
				<JsonPath Expr="warnings" Id="Warnings" Title="Warnings" Converter="Long" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="$.summary.policy">
				<JsonPath Expr="matching_policies" Id="MatchingPolicies" Title="Matching Policies" Converter="Long" HelpText=""/>
				<JsonPath Expr="high_priority_policies" Id="HighPriorityPolicies" Title="High Priority Policies" Converter="Long" HelpText=""/>
				<JsonPath Expr="high_priority_matching_policies" Id="HighPriorityMatchingPolicies" Title="High Priority Matching Policies" Converter="Long" HelpText=""/>
				<JsonPath Expr="high_priority_pending_checks" Id="HighPriorityPendingChecks" Title="High Priority Pending Checks" Converter="Long" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="$.summary.quality_assurance">
				<JsonPath Expr="misspellings" Id="Misspellings" Title="Misspellings" Converter="Long" HelpText=""/>
				<JsonPath Expr="potential_misspellings" Id="PotentialMisspellings" Title="Potential Misspellings" Converter="Long" HelpText=""/>
      </JsonPath>
      <JsonPath Expr="$.summary.accessibility">
        <JsonPath Expr="a_errors" Id="AErrors" Title="A_Errors" Converter="Long" HelpText=""/>
        <JsonPath Expr="a_issues" Id="AIssues" Title="A_Issues" Converter="Long" HelpText=""/>
        <JsonPath Expr="a_warnings" Id="AWarnings" Title="A_Warnings" Converter="Long" HelpText=""/>
        <JsonPath Expr="aa_errors" Id="AAErrors" Title="AA_Errors" Converter="Long" HelpText=""/>
        <JsonPath Expr="aa_issues" Id="AAIssues" Title="AA_Issues" Converter="Long" HelpText=""/>
        <JsonPath Expr="aa_warnings" Id="AAWarnings" Title="AA_Warnings" Converter="Long" HelpText=""/>
        <JsonPath Expr="aaa_errors" Id="AAAErrors" Title="AAA_Errors" Converter="Long" HelpText=""/>
        <JsonPath Expr="aaa_issues" Id="AAAIssues" Title="AAA_Issues" Converter="Long" HelpText=""/>
        <JsonPath Expr="aaa_warnings" Id="AAAWarnings" Title="AAA_Warnings" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SeoIssues" Title="SEO - Issues" HelpUrl="https://api.siteimprove.com/v2/documentation#!/SEO/get_sites_site_id_seo_issues" HelpText="Get all SEO issues on your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
			<Radio Id="Responsibility" Title="Responsibility" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All Types"/>
          <Item Id="editorial" Title="Editorial"/>
          <Item Id="technical" Title="Technical"/>
        </DataSource>
      </Radio>
			<Radio Id="Severity" Title="Severity" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All Types"/>
          <Item Id="review" Title="Review"/>
          <Item Id="warning" Title="Warning"/>
          <Item Id="error" Title="Error"/>
        </DataSource>
      </Radio>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/seo/issues
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.Responsibility != "all")
					{
						@: &responsibility=@(Model.Responsibility)
					}
					@if(Model.Severity != "all")
					{
						@: &severity=@(Model.Severity)
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
        <JsonPath Expr="issue_type" Id="Issue" Title="Issue" Converter="String" HelpText=""/>
        <JsonPath Expr="affected_pages" Id="AffectedPages" Title="Affected Pages" Converter="Long" HelpText=""/>
        <JsonPath Expr="role" Id="Role" Title="Role" Converter="String" HelpText=""/>
        <JsonPath Expr="severity" Id="Severity" Title="Severity" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

 <RestConnector Id="SeoPageIssues" Title="SEO - Page Issues" HelpUrl="https://api.siteimprove.com/v2/documentation#!/SEO/get_sites_site_id_seo_pages_page_id_issues" HelpText="Get SEO issues for a specific page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Debug.DefaultValue="" Required="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/seo/pages/@(Model.PageId)/issues
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="issue_type" Id="Issue" Title="Issue" Converter="String" HelpText=""/>
        <JsonPath Expr="severity" Id="Severity" Title="Severity" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="SeoPages" Title="SEO - Pages List" HelpUrl="https://api.siteimprove.com/v2/documentation#!/SEO/get_sites_site_id_seo_pages" HelpText="Get all pages that are being checked for SEO issues.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/seo/pages
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
        <Compute Id="Keywords" Title="Keywords">
          <Compute.Expr>
            <![CDATA[
            @{
              var temp = Regex.Replace(Model.KeywordsInput, @"\s+", " ");
              var temp2 = temp.Substring(1,temp.Length-2);
              var final = temp2.Replace("\"", string.Empty);
            }
            @final
            ]]>
          </Compute.Expr>
        <JsonPath Id="KeywordsInput" Expr="keywords" Converter="String"/>
        </Compute>
				<JsonPath Expr="issues" Id="Issues" Title="Issues" Converter="Long" HelpText=""/>
				<JsonPath Expr="page_level" Id="PageLevel" Title="Page Level" Converter="Long" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" DefaultValue="" HelpText=""/>
        <JsonPath Expr="_siteimprove.page_report.href" Id="PageReport" Title="Page Report" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitDepth" Title="Analytics - Visit Depth" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_depth" HelpText="Get the visit depth. Depth relates to the number of page views for each visit.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_depth?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="page_views_per_visit" Id="ViewsPerVisit" Title="Views Per Visit" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitDepthHistory" Title="Analytics - Visit Depth History" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_depth_history" HelpText="A series of historical data points showing the average amount of page views.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_depth/history?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime" HelpText=""/>
				<JsonPath Expr="page_views_average" Id="PageViewsAverage" Title="Page Views Average" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsActivityByHour" Title="Analytics - Activity by Hour" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visits_by_hour" HelpText="Get the distribution of visits and page views over hours of the day.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visits_by_hour?
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="hour_of_day" Id="Hour" Title="Hour" Converter="Long" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsActivityByMonthDay" Title="Analytics - Activity by Monthday" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visits_by_monthday" HelpText="Get the distribution of visits and page views over day of the month.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visits_by_monthday?
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="day_of_month" Id="Day" Title="Monthday" Converter="Long" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsActivityByWeekDay" Title="Analytics - Activity by Weekday" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visits_by_weekday" HelpText="Get the distribution of visits and page views over weekday.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visits_by_weekday?
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="day_of_week" Id="Day" Title="Weekday" Converter="Long" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitLength" Title="Analytics - Visit Length" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_length" HelpText="Get the length of a visit. Length relates to the duration (in minutes) of each visit.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_length?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="visit_duration_in_minutes" Id="VisitDuration" Title="Visit Duration" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsVisitLengthHistory" Title="Analytics - Visit Length History" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_behavior_visit_length_history" HelpText="A series of historical data points showing the average visit length. Length relates to the duration (in minutes) of each visit.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/behavior/visit_length/history?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime" HelpText=""/>
				<JsonPath Expr="visit_duration_average_in_minutes" Id="VisitDurationAverage" Title="Visit Duration Average" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsAllPages" Title="Analytics - All Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_all_pages" HelpText="Get all pages identified on your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/all_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="average_page_views_per_visit" Id="AveragePageViews" Title="Average Page Views" Converter="Double" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsEntryPages" Title="Analytics - Entry Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_entry_pages" HelpText="An entry page is the first page a visitor sees when they enter the website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/entry_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="entries" Id="Entries" Title="Entries" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExitPages" Title="Analytics - Exit Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_exit_pages" HelpText="An exit page is the last page a visitor sees before they leave the website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/exit_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="exits" Id="Exits" Title="Exits" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsLeastPopularPages" Title="Analytics - Least Popular Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_least_popular_pages" HelpText="Get the least popular pages among the top 1000 pages with the most page views.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/least_popular_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
				<JsonPath Expr="last_visited" Id="LastVisited" Title="Last Visited" Converter="DateTime" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsMostPopularPages" Title="Analytics - Most Popular Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_most_popular_pages" HelpText="Get the least most pages among the top 1000 pages with the most page views.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/most_popular_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
				<JsonPath Expr="last_visited" Id="LastVisited" Title="Last Visited" Converter="DateTime" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsNavigationDepth" Title="Analytics - Navigation Depth" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_navigation_depth" HelpText="Get the average number of clicks (pages visited) to get to a certain page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/navigation_depth?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="average_clicks" Id="AverageClicks" Title="Average Clicks" Converter="Double" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsOutboundLinks" Title="Analytics - Outbound Links" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_outbound_links" HelpText="Get links to external domains, that have been used to leave your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/outbound_links?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsOutboundLinkHistory" Title="Analytics - Outbound Link History" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_content_outbound_links_outbound_link_id_history" HelpText="A series of historical data points showing the amount of visits for a specific outbound link.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="OutboundId" Title="Outbound Link Id" DefaultValue="" Debug.DefaultValue="293077723" Required="true"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/outbound_links/@(Model.OutboundId)/history?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsPageLoadTime" Title="Analytics - Pages Load Time" HelpUrl="https://api.siteimprove.com/v2/documentation#/" HelpText="Get the average amount of time (in seconds) it takes a page to load.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/page_load_time?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="average_page_load_time" Id="AverageLoadTime" Title="Average Load Time" Converter="Auto" DefaultValue="" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="Page Views" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsBounceRates" Title="Analytics - Bounce Rates" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_entries_exits_bounce_rates" HelpText="List of pages with bounces and bounce rate.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/content/bounce_rates?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="bounces" Id="Bounces" Title="Bounces" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsEntriesExits" Title="Analytics - Entries and Exits" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_entries_exits_entry_exit_rates" HelpText="List the amount of entries and exits registered for your pages.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/entries_exits/entry_exit_rates?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="bounces" Id="Bounces" Title="Bounces" Converter="Long" HelpText=""/>
				<JsonPath Expr="entry_rate" Id="EntryRate" Title="Entry Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="entries" Id="Entries" Title="Entries" Converter="Long" HelpText=""/>
				<JsonPath Expr="exit_rate" Id="ExitRate" Title="Exit Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="exits" Id="Exits" Title="Exits" Converter="Long" HelpText=""/>
				<JsonPath Expr="last_outbound_link_clicks" Id="LastOutboundLinkClicks" Title="Last Outbound Link Clicks" Converter="Long" HelpText=""/>
				<JsonPath Expr="last_outbound_link_rate" Id="LastOutboundClickRate" Title="Last Outbound Click Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsPageLastOutboundLinks" Title="Analytics - Page Last Outbound Links" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_entries_exits_entry_exit_rates_page_id_last_outbound_links" HelpText="The last outbound links and their amount of clicks for a specific exit page.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="PageId" Title="Page Id" DefaultValue="" Debug.DefaultValue="293045864" Required="true"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/entries_exits/entry_exit_rates/@(Model.PageId)/last_outbound_links?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="clicks" Id="Clicks" Title="Clicks" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsOverviewSummary" Title="Analytics - Overview Summary" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_overview_summary" HelpText="Get a summary of the most common statistics for your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/overview/summary?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
			<JsonPath Expr="new_visitors" Id="NewVisitors" Title="New Visitors" Converter="Long" HelpText=""/>
			<JsonPath Expr="page_views" Id="PgeViews" Title="PageViews" Converter="Long" HelpText=""/>
			<JsonPath Expr="returning_visitors" Id="ReturningVisitors" Title="Returning Visitors" Converter="Long" HelpText=""/>
			<JsonPath Expr="unique_visitors" Id="UniqueVisitors" Title="Unique Visitors" Converter="Long" HelpText=""/>
			<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsOverviewHistory" Title="Analytics - Overview History" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_overview_history" HelpText="A series of historical data points showing the most common statistics for your site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/overview/history?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="new_visitors" Id="NewVisitors" Title="New Visitors" Converter="Long" HelpText=""/>
				<JsonPath Expr="page_views" Id="PgeViews" Title="PageViews" Converter="Long" HelpText=""/>
				<JsonPath Expr="returning_visitors" Id="ReturningVisitors" Title="Returning Visitors" Converter="Long" HelpText=""/>
				<JsonPath Expr="unique_visitors" Id="UniqueVisitors" Title="Unique Visitors" Converter="Long" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsOnlineVisitors" Title="Analytics - Online Visitors" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_overview_online_visitors" HelpText="Get the current online visitors.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/overview/online_visitors?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="city" Id="City" Title="City" Converter="String" HelpText=""/>
				<JsonPath Expr="region" Id="Region" Title="Region" Converter="String" HelpText=""/>
				<JsonPath Expr="country_name" Id="Country" Title="Country" Converter="String" HelpText=""/>
				<JsonPath Expr="organisation" Id="Organisation" Title="Organisation" Converter="String" HelpText=""/>
				<JsonPath Expr="page_views" Id="PageViews" Title="PageViews" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsDirectTrafficEntryPages" Title="Analytics - Direct Traffic Entry Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_direct_traffic_entry_pages" HelpText="Entry pages for the visits that have started through a direct entry to your website (for example from a bookmark) and not through an external referrer or search engine.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/direct_traffic_entry_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="title" Id="Title" Title="Title" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalReferringDomains" Title="Analytics - External Referring Domains" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_external_referring_domains" HelpText="External domains that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/external_referring_domains?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="external_referring_domain" Id="ReferringDomain" Title="Referring Domain" Converter="String" HelpText=""/>
				<JsonPath Expr="referring_pages" Id="ReferringPages" Title="Referring Pages" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalReferringPages" Title="Analytics - External Referring Pages" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_external_referring_pages" HelpText="Pages on external domains that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/external_referring_pages?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="visits_of_parent" Id="VisitsOfParent" Title="Visits of Parent" Converter="Long" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSearchTerms" Title="Analytics - External Search Terms" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_external_search_terms" HelpText="Search terms that have been used on external search engines to reach the website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/external_search_terms?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
				<JsonPath Expr="external_search_term" Id="SearchTerm" Title="Search Term" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSearchEngines" Title="Analytics - External Search Engines" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_search_engines" HelpText="Search engines that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/search_engines?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="search_engine" Id="SearchEngine" Title="Search Engine" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSocialMedia" Title="Analytics - External Social Media" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_social_media_organisations" HelpText="Get the social media organisations that have referred visitors to your website.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/social_media_organisations?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long" HelpText=""/>
				<JsonPath Expr="organisation" Id="Site" Title="Site" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="referrals" Id="Referrals" Title="Referrals" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsExternalSocialMediaSiteHistory" Title="Analytics - External Social Media Site History" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_traffic_sources_social_media_organisations_social_media_organisation_id_history" HelpText="A series of historical data points showing the visits for the specified social media site.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <Text Id="SomeSiteId" Title="Social Media Site Id" DefaultValue="" Debug.DefaultValue="1" Required="true"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/traffic_sources/social_media_organisations/@(Model.SomeSiteId)/history?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="timestamp" Id="Timestamp" Title="Timestamp" Converter="DateTime" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsBrowsers" Title="Analytics - Browsers" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_browsers" HelpText="Get the browsers used by your visitors.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/browsers?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="browser_name" Id="Browser" Title="Browser" Converter="String" DefaultValue="" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsCountries" Title="Analytics - Countries" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_countries" HelpText="Overview of where visitors come from divided by country.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/countries?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long" HelpText=""/>
				<JsonPath Expr="country_name" Id="Country" Title="Country" Converter="String" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsDevices" Title="Analytics - Devices" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_devices" HelpText="See which type of device is being utilised the most.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/devices?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="device_type" Id="Device" Title="Device" Converter="String" HelpText=""/>
				<JsonPath Expr="bounce_rate" Id="BounceRate" Title="Bounce Rate" Converter="Double" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AnalyticsOrganisations" Title="Analytics - Organisations" HelpUrl="https://api.siteimprove.com/v2/documentation#!/Analytics/get_sites_site_id_analytics_visitors_organisations" HelpText="Get a list of visiting organisations, identified through IP address.">
    <Parameters>
      <Text Id="SiteId" Title="Site Id" DefaultValue="" Debug.DefaultValue="7157903272" Required="true" Select.Connector="Sites" Select.IdField="Id" Select.TitleField="Site"/>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
    </Parameters>
    <Paging PageSize="100" EvenPages="true">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="total_items"/>
      </Parse>
    </Paging>
    <Fetch>
      <HttpSettings>
        <RequestMethod>GET</RequestMethod>
        <RequestHeaders>
					<Header Name='Accept'>application/json</Header>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
					https://api.siteimprove.com/v2/sites/@(Model.SiteId)/analytics/visitors/organisations?
					?page=@(Model.PageCursor.Page+1)
					&page_size=@(Model.PageCursor.NextTake)
					@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
					{
						@: &period=
						@Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyyMMdd"))
						@: _
						@Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyyMMdd"))
					}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items.*">
				<JsonPath Expr="id" Id="Id" Title="Id" Converter="Long" HelpText=""/>
				<JsonPath Expr="organisation" Id="Organisation" Title="Organisation" Converter="String" HelpText=""/>
				<JsonPath Expr="ip_addresses" Id="IPAddresses" Title="IPA ddresses" Converter="Long" HelpText=""/>
				<JsonPath Expr="pages" Id="Pages" Title="Pages" Converter="Long" DefaultValue="" HelpText=""/>
				<JsonPath Expr="visits" Id="Visits" Title="Visits" Converter="Long" DefaultValue="" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[
    string CreateBasicAuth()
    {
      string AuthString = Convert.ToBase64String(ASCIIEncoding.ASCII.GetBytes(Model.Email + ":" + Model.ApiKey));
      return AuthString;
    }
    ]]>
  </RazorFunctions>
</Suite>