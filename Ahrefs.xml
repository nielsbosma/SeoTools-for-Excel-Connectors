<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" Title="Ahrefs" Id="Ahrefs" RequireVersion="8.2" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Ahrefs.xml" HelpUrl="http://seotoolsforexcel.com/ahrefs/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity" />

	<SeoToolsAuthenticator StayAuthenticated="true" Key="ahrefs"/>

  <Resources>
    <Resource Id="HttpSettings">
      <HttpSettings>
				<RequestContentType>application/json</RequestContentType>
        <RequestHeaders>
          <Header Name="Authorization">Bearer @(Model.Authenticator.Token)</Header>
        </RequestHeaders>
      </HttpSettings>
    </Resource>
    <Resource Id="Fail">
			<Fail>
				<JsonPath Expr="error"/>
				<JsonPath Expr="[1]" Id="AuthFail" Fail.If="IsEqual" Fail.ComparedTo="Forbidden" Fail.Action="Message" Fail.Message="Forbidden" />
				<JsonPath Expr="[0]" Id="OtherFail" Fail.If="IsEqual" Fail.ComparedTo="Error" Fail.Action="Message" Fail.Message="Error" />
			</Fail>
    </Resource>
    <Resource Id="Mode">
      <Select Id="Mode" Title="Mode" DefaultValue="subdomains">
        <DataSource>
          <Item Id="exact" Title="URL (exact url)"/>
          <Item Id="domain" Title="Domain without subdomains (domain/*)"/>
          <Item Id="subdomains" Title="Domain with all subdomains (*.domain/*)"/>
          <Item Id="prefix" Title="Prefix (domain.com/path/*)"/>
        </DataSource>
      </Select>
    </Resource>
    <Resource Id="Country">
      <Select Id="Country" Title="Country Store" DefaultValue="us">
        <DataSource>
					<Item Id="Global"/>
          <ISOCountryCodes/>
        </DataSource>
      </Select>
    </Resource>
		<Resource Id="HistoryGrouping">
      <Select Id="HistoryGrouping" Title="History Grouping" DefaultValue="monthly">
        <DataSource>
          <Item Id="daily" Title="Daily"/>
          <Item Id="weekly" Title="Weekly"/>
          <Item Id="monthly" Title="Monthly"/>
        </DataSource>
      </Select>
		</Resource>
		<Resource Id="VolumeMode">
      <Select Id="VolumeMode" Title="Volume Mode" DefaultValue="monthly">
        <DataSource>
          <Item Id="monthly" Title="Monthly"/>
          <Item Id="average" Title="Average"/>
        </DataSource>
      </Select>
		</Resource>
		<Resource Id="Aggregation">
      <Select Id="Aggregation" Title="Aggregation" DefaultValue="similar_links">
        <DataSource>
          <Item Id="similar_links" Title="Similar Links"/>
          <Item Id="1_per_domain" Title="1 per Domain"/>
          <Item Id="all" Title="All"/>
        </DataSource>
      </Select>
		</Resource>
	</Resources>

  <RestConnector Id="DomainRating" Title="Domain Rating" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-domain-rating">
    <Parameters>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/domain-rating
				?target=@Model.Target
				&date=@Model.Date.ToString("yyyy-MM-dd")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="domain_rating.domain_rating" Id="DomainRating" Title="Domain Rating" Converter="Double"/>
      <JsonPath Expr="domain_rating.ahrefs_rank" Id="AhrefsRank" Title="Ahrefs Rank" Converter="Int"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="BacklinksStats" Title="Backlinks Stats" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-backlinks-stats">
    <Parameters>
			<Resource Id="Mode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/backlinks-stats
				?target=@Model.Target
				&mode=@Model.Mode
				&date=@Model.Date.ToString("yyyy-MM-dd")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="metrics.live" Id="Live" Title="Live" Converter="Int"/>
      <JsonPath Expr="metrics.all_time" Id="AllTime" Title="All Time" Converter="Int"/>
      <JsonPath Expr="metrics.live_refdomains" Id="LiveRefdomains" Title="Live Refdomains" Converter="Int"/>
      <JsonPath Expr="metrics.all_time_refdomains" Id="AllTimeRefdomains" Title="All Time Ref domains" Converter="Int"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="OutlinksStats" Title="Outlinks Stats" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-outlinks-stats">
    <Parameters>
			<Resource Id="Mode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/outlinks-stats
				?target=@Model.Target
				&mode=@Model.Mode
				&date=@Model.Date.ToString("yyyy-MM-dd")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="metrics.outgoing_links" Id="OutgoingLinks" Title="Outgoing Links" Converter="Int"/>
      <JsonPath Expr="metrics.outgoing_links_dofollow" Id="OutgoingLinksDofollow" Title="Outgoing Links Dofollow" Converter="Int"/>
      <JsonPath Expr="metrics.linked_domains" Id="LinkedDomains" Title="Linked Domains" Converter="Int"/>
      <JsonPath Expr="metrics.linked_domains_dofollow" Id="LinkedDomainsDofollow" Title="Linked Domains Dofollow" Converter="Int"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Metrics" Title="Metrics" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-metrics">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
      <Resource Id="VolumeMode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/metrics
				?target=@Model.Target
				&mode=@Model.Mode
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
				&date=@Model.Date.ToString("yyyy-MM-dd")
				&volume_mode=@Model.VolumeMode
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="metrics.org_keywords" Id="OrganicKeywords" Title="Organic Keywords" Converter="Int"/>
      <JsonPath Expr="metrics.paid_keywords" Id="PaidKeywords" Title="Paid Keywords" Converter="Int"/>
      <JsonPath Expr="metrics.org_keywords_1_3" Id="OrganicKeywords13" Title="Organic Keywords Top3 Results" Converter="Int"/>
      <JsonPath Expr="metrics.org_traffic" Id="OrganicTraffic" Title="Organic Traffic" Converter="Int"/>
      <JsonPath Expr="metrics.org_cost" Id="OrganicCost" Title="Organic Cost" Converter="Int"/>
      <JsonPath Expr="metrics.paid_traffic" Id="PaidTraffic" Title="Paid Traffic" Converter="Int"/>
      <JsonPath Expr="metrics.paid_cost" Id="PaidCost" Title="Paid Cost" Converter="Int"/>
      <JsonPath Expr="metrics.paid_pages" Id="PaidPages" Title="Paid Pages" Converter="Int"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RefdomainsHistory" Title="Refdomains History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-refdomains-history">
    <Parameters>
      <Resource Id="HistoryGrouping"/>
			<Resource Id="Mode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/refdomains-history
				?target=@Model.Target
				&mode=@Model.Mode
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&history_grouping=@Model.HistoryGrouping
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.refdomains[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(refdomains[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="DomainRatingHistory" Title="Domain Rating History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-domain-rating-history">
    <Parameters>
			<Resource Id="HistoryGrouping"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/domain-rating-history
				?target=@Model.Target
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&history_grouping=@Model.HistoryGrouping
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.domain_ratings[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(domain_ratings[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="UrlRatingHistory" Title="URL Rating History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-url-rating-history">
    <Parameters>
			<Resource Id="HistoryGrouping"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/url-rating-history
				?target=@Model.Target
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&history_grouping=@Model.HistoryGrouping
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.url_ratings[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(url_ratings[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PagesHistory" Title="Pages History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-pages-history">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="HistoryGrouping"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/pages-history
				?target=@Model.Target
				&mode=@Model.Mode
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&history_grouping=@Model.HistoryGrouping
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.pages[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(pages[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="MetricsHistory" Title="Metrics History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-metrics-history">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
			<Resource Id="HistoryGrouping"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/metrics-history
				?target=@Model.Target
				&mode=@Model.Mode
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&history_grouping=@Model.HistoryGrouping
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
				&volume_mode=@Model.VolumeMode
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.metrics[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(metrics[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordsHistory" Title="Keywords History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-keywords-history">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
			<Resource Id="HistoryGrouping"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/keywords-history
				?target=@Model.Target
				&mode=@Model.Mode
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&history_grouping=@Model.HistoryGrouping
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
				&volume_mode=@Model.VolumeMode
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.keywords[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(keywords[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="MetricsByCountry" Title="Metrics by Country" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-metrics-by-country">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="VolumeMode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/metrics-by-country
				?target=@Model.Target
				&mode=@Model.Mode
				&date=@Model.Date.ToString("yyyy-MM-dd")
				&volume_mode=@Model.VolumeMode
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.metrics[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(metrics[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PagesByTraffic" Title="Pages by Traffic" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-pages-by-traffic">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/pages-by-traffic
				?target=@Model.Target
				&mode=@Model.Mode
				&volume_mode=@Model.VolumeMode
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="metrics.outgoing_links" Id="OutgoingLinks" Title="Outgoing Links" Converter="Int"/>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="TotalSearchVolumeHistory" Title="Total Search Volume History" Group="Site Explorer - Overview" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/get-a-total-search-volume-history">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
			<Resource Id="HistoryGrouping"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<DateInterval Id="DateInterval" Title="Interval" DefaultValue="LastYear"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/total-search-volume-history
				?target=@Model.Target
				&mode=@Model.Mode
				&date_from=@(((DateTimeOffset)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))
				&date_to=@(((DateTimeOffset)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))
				&volume_mode=@Model.VolumeMode
				&history_grouping=@Model.HistoryGrouping
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<Table DefaultConverter="auto">
				<JsonPath Id="Headers" Expr="keys($.metrics[0])">
					<JsonPath Expr="key"/>
				</JsonPath>
				<JsonPath Id="Cells" Expr="keys(metrics[*])" DefaultValue="">
					<JsonPath Expr="value"/>
				</JsonPath>
			</Table>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Backlinks" Title="Backlinks" Group="Site Explorer - Backlinks" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-all-backlinks">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Aggregation"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
      <Number Id="Limit" Title="Limit" DefaultValue="1000" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/all-backlinks
				?target=@Model.Target
				&mode=@Model.Mode
				&aggregation=@Model.Aggregation
				&select=@SelectedFields()
				&limit=@Model.Limit
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="backlinks[*]">
				<JsonPath Expr="traffic" Id="traffic" Title="Traffic (10 units)" Tag="traffic" Converter="Int" Checked="false"/>
				<JsonPath Expr="traffic_domain" Id="traffic_domain" Title="Traffic Domain (10 units)" Tag="traffic_domain" Converter="Int" Checked="false"/>
				<JsonPath Expr="refdomains_source" Id="refdomains_source" Title="RefDomains Source (5 units)" Tag="refdomains_source" Converter="Int" Checked="false"/>
				<JsonPath Expr="refdomains_source_domain" Id="refdomains_source_domain" Title="RefDomains Source Domain (5 units)" Tag="refdomains_source_domain" Converter="Int" Checked="false"/>
				<JsonPath Expr="refdomains_target_domain" Id="refdomains_target_domain" Title="RefDomains Target Domain (5 units)" Tag="refdomains_target_domain" Converter="Int" Checked="false"/>
				<JsonPath Expr="class_c" Id="class_c" Title="Class C (5 units)" Tag="class_c" Converter="Int" Checked="false"/>
				<JsonPath Expr="ahrefs_rank_source" Id="ahrefs_rank_source" Title="Ahrefs Rank Source" Tag="ahrefs_rank_source" Converter="Int"/>
				<JsonPath Expr="ahrefs_rank_target" Id="ahrefs_rank_target" Title="Ahrefs Rank Target" Tag="ahrefs_rank_target" Converter="Int"/>
				<JsonPath Expr="alt" Id="alt" Title="Alt" Tag="alt" Converter="String"/>
				<JsonPath Expr="anchor" Id="anchor" Title="Anchor" Tag="anchor" Converter="String"/>
				<JsonPath Expr="domain_rating_source" Id="domain_rating_source" Title="Domain Rating Source" Tag="domain_rating_source" Converter="Int"/>
				<JsonPath Expr="domain_rating_target" Id="domain_rating_target" Title="Domain Rating Target" Tag="domain_rating_target" Converter="Int"/>
				<JsonPath Expr="encoding" Id="encoding" Title="Encoding" Tag="encoding" Converter="Int"/>
				<JsonPath Expr="first_seen" Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime"/>
				<JsonPath Expr="http_code" Id="http_code" Title="HTTP Code" Tag="http_code" Converter="Int"/>
				<JsonPath Expr="ip_source" Id="ip_source" Title="IP Source" Tag="ip_source" Converter="String" DefaultValue=""/>
				<JsonPath Expr="is_canonical" Id="is_canonical" Title="Canonical" Tag="is_canonical" Converter="Bool"/>
				<JsonPath Expr="is_dofollow" Id="is_dofollow" Title="Dofollow" Tag="is_dofollow" Converter="Bool"/>
				<JsonPath Expr="is_form" Id="is_form" Title="Form" Tag="is_form" Converter="Bool"/>
				<JsonPath Expr="is_frame" Id="is_frame" Title="Frame" Tag="is_frame" Converter="Bool"/>
				<JsonPath Expr="is_image" Id="is_image" Title="Image" Tag="is_image" Converter="Bool"/>
				<JsonPath Expr="is_lost" Id="is_lost" Title="Lost" Tag="is_lost" Converter="Bool"/>
				<JsonPath Expr="is_new" Id="is_new" Title="New" Tag="is_new" Converter="Bool"/>
				<JsonPath Expr="is_nofollow" Id="is_nofollow" Title="NoFollow" Tag="is_nofollow" Converter="Bool"/>
				<JsonPath Expr="is_redirect" Id="is_redirect" Title="Redirect" Tag="is_redirect" Converter="Bool"/>
				<JsonPath Expr="is_redirect_lost" Id="is_redirect_lost" Title="Redirect Lost" Tag="is_redirect_lost" Converter="Bool"/>
				<JsonPath Expr="is_root_source" Id="is_root_source" Title="Root Source" Tag="is_root_source" Converter="Bool"/>
				<JsonPath Expr="is_root_target" Id="is_root_target" Title="Root Target" Tag="is_root_target" Converter="Bool"/>
				<JsonPath Expr="is_rss" Id="is_rss" Title="RSS" Tag="is_rss" Converter="Bool"/>
				<JsonPath Expr="is_spam" Id="is_spam" Title="Spam" Tag="is_spam" Converter="Bool"/>
				<JsonPath Expr="is_sponsored" Id="is_sponsored" Title="Sponsored" Tag="is_sponsored" Converter="Bool"/>
				<JsonPath Expr="is_text" Id="is_text" Title="Text" Tag="is_text" Converter="Bool"/>
				<JsonPath Expr="is_ugc" Id="is_ugc" Title="UGC" Tag="is_ugc" Converter="Bool"/>
				<JsonPath Expr="js_crawl" Id="js_crawl" Title="JS Crawl" Tag="js_crawl" Converter="Bool"/>
				<JsonPath Expr="csv(languages)" Id="languages" Title="Languages" Tag="languages" Converter="String"/>
				<JsonPath Expr="last_seen" Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime"/>
				<JsonPath Expr="last_visited" Id="last_visited" Title="Last Visited" Tag="last_visited" Converter="DateTime"/>
				<JsonPath Expr="link_type" Id="link_type" Title="Link Type" Tag="link_type" Converter="String"/>
				<JsonPath Expr="linked_domains_source_domain" Id="linked_domains_source_domain" Title="Linked Domains Source Domain" Tag="linked_domains_source_domain" Converter="Int"/>
				<JsonPath Expr="linked_domains_source_page" Id="linked_domains_source_page" Title="Linked Domains Source Page" Tag="linked_domains_source_page" Converter="Int"/>
				<JsonPath Expr="linked_domains_target_domain" Id="linked_domains_target_domain" Title="Linked Domains Target Domain" Tag="linked_domains_target_domain" Converter="Int"/>
				<JsonPath Expr="links_external" Id="links_external" Title="Links External" Tag="links_external" Converter="Int"/>
				<JsonPath Expr="links_internal" Id="links_internal" Title="Links Internal" Tag="links_internal" Converter="Int"/>
				<JsonPath Expr="lost_reason" Id="lost_reason" Title="Lost Reason" Tag="lost_reason" Converter="String"/>
				<JsonPath Expr="name_source" Id="name_source" Title="Name Source" Tag="name_source" Converter="String"/>
				<JsonPath Expr="name_target" Id="name_target" Title="Name Target" Tag="name_target" Converter="String"/>
				<JsonPath Expr="noindex" Id="noindex" Title="NoIndex" Tag="noindex" Converter="Bool"/>
				<JsonPath Expr="page_size" Id="page_size" Title="Page Size" Tag="page_size" Converter="Int"/>
				<JsonPath Expr="port_source" Id="port_source" Title="Port Size" Tag="port_source" Converter="Int"/>
				<JsonPath Expr="port_target" Id="port_target" Title="Port Target" Tag="port_target" Converter="Int"/>
				<JsonPath Expr="positions" Id="positions" Title="Positions" Tag="positions" Converter="Int"/>
				<JsonPath Expr="root_name_source" Id="root_name_source" Title="Root Name Source" Tag="root_name_source" Converter="String"/>
				<JsonPath Expr="snippet_left" Id="snippet_left" Title="Snippet Left" Tag="snippet_left" Converter="String"/>
				<JsonPath Expr="snippet_right" Id="snippet_right" Title="Snippet Right" Tag="snippet_right" Converter="String"/>
				<JsonPath Expr="source_page_author" Id="source_page_author" Title="Source Page Author" Tag="source_page_author" Converter="String" DefaultValue=""/>
				<JsonPath Expr="title" Id="title" Title="Title" Tag="title" Converter="String"/>
				<JsonPath Expr="tld_class_source" Id="tld_class_source" Title="TLD Class Source" Tag="tld_class_source" Converter="String"/>
				<JsonPath Expr="tld_class_target" Id="tld_class_target" Title="TLD Class Target" Tag="tld_class_target" Converter="String"/>
				<JsonPath Expr="url_from" Id="url_from" Title="URL From" Tag="url_from" Converter="String"/>
				<JsonPath Expr="url_rating_source" Id="url_rating_source" Title="URL Rating Source" Tag="url_rating_source" Converter="Int"/>
				<JsonPath Expr="url_to" Id="url_to" Title="URL To" Tag="url_to" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="BrokenBacklinks" Title="Broken Backlinks" Group="Site Explorer - Backlinks" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-broken-backlinks">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Aggregation"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
      <Number Id="Limit" Title="Limit" DefaultValue="1000" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/broken-backlinks
				?target=@Model.Target
				&mode=@Model.Mode
				&aggregation=@Model.Aggregation
				&select=@SelectedFields()
				&limit=@Model.Limit
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="backlinks[*]">
				<JsonPath Expr="traffic" Id="traffic" Title="Traffic (10 units)" Tag="traffic" Converter="Int" Checked="false"/>
				<JsonPath Expr="traffic_domain" Id="traffic_domain" Title="Traffic Domain (10 units)" Tag="traffic_domain" Converter="Int" Checked="false"/>
				<JsonPath Expr="refdomains_source" Id="refdomains_source" Title="RefDomains Source (5 units)" Tag="refdomains_source" Converter="Int" Checked="false"/>
				<JsonPath Expr="refdomains_source_domain" Id="refdomains_source_domain" Title="RefDomains Source Domain (5 units)" Tag="refdomains_source_domain" Converter="Int" Checked="false"/>
				<JsonPath Expr="refdomains_target_domain" Id="refdomains_target_domain" Title="RefDomains Target Domain (5 units)" Tag="refdomains_target_domain" Converter="Int" Checked="false"/>
				<JsonPath Expr="class_c" Id="class_c" Title="Class C (5 units)" Tag="class_c" Converter="Int" Checked="false"/>
				<JsonPath Expr="ahrefs_rank_source" Id="ahrefs_rank_source" Title="Ahrefs Rank Source" Tag="ahrefs_rank_source" Converter="Int"/>
				<JsonPath Expr="ahrefs_rank_target" Id="ahrefs_rank_target" Title="Ahrefs Rank Target" Tag="ahrefs_rank_target" Converter="Int"/>
				<JsonPath Expr="alt" Id="alt" Title="Alt" Tag="alt" Converter="String"/>
				<JsonPath Expr="anchor" Id="anchor" Title="Anchor" Tag="anchor" Converter="String"/>
				<JsonPath Expr="domain_rating_source" Id="domain_rating_source" Title="Domain Rating Source" Tag="domain_rating_source" Converter="Int"/>
				<JsonPath Expr="domain_rating_target" Id="domain_rating_target" Title="Domain Rating Target" Tag="domain_rating_target" Converter="Int"/>
				<JsonPath Expr="encoding" Id="encoding" Title="Encoding" Tag="encoding" Converter="Int"/>
				<JsonPath Expr="first_seen" Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime"/>
				<JsonPath Expr="http_code" Id="http_code" Title="HTTP Code" Tag="http_code" Converter="Int"/>
				<JsonPath Expr="ip_source" Id="ip_source" Title="IP Source" Tag="ip_source" Converter="String" DefaultValue=""/>
				<JsonPath Expr="is_canonical" Id="is_canonical" Title="Canonical" Tag="is_canonical" Converter="Bool"/>
				<JsonPath Expr="is_dofollow" Id="is_dofollow" Title="Dofollow" Tag="is_dofollow" Converter="Bool"/>
				<JsonPath Expr="is_form" Id="is_form" Title="Form" Tag="is_form" Converter="Bool"/>
				<JsonPath Expr="is_frame" Id="is_frame" Title="Frame" Tag="is_frame" Converter="Bool"/>
				<JsonPath Expr="is_image" Id="is_image" Title="Image" Tag="is_image" Converter="Bool"/>
				<JsonPath Expr="is_nofollow" Id="is_nofollow" Title="NoFollow" Tag="is_nofollow" Converter="Bool"/>
				<JsonPath Expr="is_redirect" Id="is_redirect" Title="Redirect" Tag="is_redirect" Converter="Bool"/>
				<JsonPath Expr="is_root_source" Id="is_root_source" Title="Root Source" Tag="is_root_source" Converter="Bool"/>
				<JsonPath Expr="is_root_target" Id="is_root_target" Title="Root Target" Tag="is_root_target" Converter="Bool"/>
				<JsonPath Expr="is_rss" Id="is_rss" Title="RSS" Tag="is_rss" Converter="Bool"/>
				<JsonPath Expr="is_spam" Id="is_spam" Title="Spam" Tag="is_spam" Converter="Bool"/>
				<JsonPath Expr="is_sponsored" Id="is_sponsored" Title="Sponsored" Tag="is_sponsored" Converter="Bool"/>
				<JsonPath Expr="is_text" Id="is_text" Title="Text" Tag="is_text" Converter="Bool"/>
				<JsonPath Expr="is_ugc" Id="is_ugc" Title="UGC" Tag="is_ugc" Converter="Bool"/>
				<JsonPath Expr="js_crawl" Id="js_crawl" Title="JS Crawl" Tag="js_crawl" Converter="Bool"/>
				<JsonPath Expr="csv(languages)" Id="languages" Title="Languages" Tag="languages" Converter="String"/>
				<JsonPath Expr="last_seen" Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime"/>
				<JsonPath Expr="last_visited" Id="last_visited" Title="Last Visited" Tag="last_visited" Converter="DateTime"/>
				<JsonPath Expr="link_type" Id="link_type" Title="Link Type" Tag="link_type" Converter="String"/>
				<JsonPath Expr="linked_domains_source_domain" Id="linked_domains_source_domain" Title="Linked Domains Source Domain" Tag="linked_domains_source_domain" Converter="Int"/>
				<JsonPath Expr="linked_domains_source_page" Id="linked_domains_source_page" Title="Linked Domains Source Page" Tag="linked_domains_source_page" Converter="Int"/>
				<JsonPath Expr="linked_domains_target_domain" Id="linked_domains_target_domain" Title="Linked Domains Target Domain" Tag="linked_domains_target_domain" Converter="Int"/>
				<JsonPath Expr="links_external" Id="links_external" Title="Links External" Tag="links_external" Converter="Int"/>
				<JsonPath Expr="links_internal" Id="links_internal" Title="Links Internal" Tag="links_internal" Converter="Int"/>
				<JsonPath Expr="name_source" Id="name_source" Title="Name Source" Tag="name_source" Converter="String"/>
				<JsonPath Expr="name_target" Id="name_target" Title="Name Target" Tag="name_target" Converter="String"/>
				<JsonPath Expr="page_size" Id="page_size" Title="Page Size" Tag="page_size" Converter="Int"/>
				<JsonPath Expr="port_source" Id="port_source" Title="Port Size" Tag="port_source" Converter="Int"/>
				<JsonPath Expr="port_target" Id="port_target" Title="Port Target" Tag="port_target" Converter="Int"/>
				<JsonPath Expr="positions" Id="positions" Title="Positions" Tag="positions" Converter="Int"/>
				<JsonPath Expr="root_name_source" Id="root_name_source" Title="Root Name Source" Tag="root_name_source" Converter="String"/>
				<JsonPath Expr="snippet_left" Id="snippet_left" Title="Snippet Left" Tag="snippet_left" Converter="String"/>
				<JsonPath Expr="snippet_right" Id="snippet_right" Title="Snippet Right" Tag="snippet_right" Converter="String"/>
				<JsonPath Expr="source_page_author" Id="source_page_author" Title="Source Page Author" Tag="source_page_author" Converter="String" DefaultValue=""/>
				<JsonPath Expr="title" Id="title" Title="Title" Tag="title" Converter="String"/>
				<JsonPath Expr="tld_class_source" Id="tld_class_source" Title="TLD Class Source" Tag="tld_class_source" Converter="String"/>
				<JsonPath Expr="tld_class_target" Id="tld_class_target" Title="TLD Class Target" Tag="tld_class_target" Converter="String"/>
				<JsonPath Expr="url_from" Id="url_from" Title="URL From" Tag="url_from" Converter="String"/>
				<JsonPath Expr="url_rating_source" Id="url_rating_source" Title="URL Rating Source" Tag="url_rating_source" Converter="Int"/>
				<JsonPath Expr="url_to" Id="url_to" Title="URL To" Tag="url_to" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RefDomains" Title="Ref Domains" Group="Site Explorer - Backlinks" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-refdomains">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Aggregation"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
      <Number Id="Limit" Title="Limit" DefaultValue="1000" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/refdomains
				?target=@Model.Target
				&mode=@Model.Mode
				&aggregation=@Model.Aggregation
				&select=@SelectedFields()
				&limit=@Model.Limit
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="refdomains[*]">
				<JsonPath Expr="dofollow_refdomains" Id="dofollow_refdomains" Title="Dofollow Ref Domains (5 units)" Tag="dofollow_refdomains" Converter="Int" Checked="false"/>
				<JsonPath Expr="traffic_domain" Id="traffic_domain" Title="Traffic Domain (10 units)" Tag="traffic_domain" Converter="Int" Checked="false"/>

				<JsonPath Expr="dofollow_linked_domains" Id="dofollow_linked_domains" Title="Dofollow Linked Domains" Tag="dofollow_linked_domains" Converter="Int"/>
				<JsonPath Expr="dofollow_links" Id="dofollow_links" Title="Dofollow Links" Tag="dofollow_links" Converter="Int"/>
				<JsonPath Expr="domain" Id="domain" Title="Domain" Tag="domain" Converter="String"/>
				<JsonPath Expr="domain_rating" Id="domain_rating" Title="Domain Rating" Tag="domain_rating" Converter="Int"/>
				<JsonPath Expr="first_seen" Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime"/>
				<JsonPath Expr="ip_source" Id="ip_source" Title="IP Source" Tag="ip_source" Converter="String" DefaultValue=""/>
				<JsonPath Expr="is_root_domain" Id="is_root_domain" Title="Root Domain" Tag="is_root_domain" Converter="Bool"/>
				<JsonPath Expr="is_spam" Id="is_spam" Title="Spam" Tag="is_spam" Converter="Bool"/>
				<JsonPath Expr="last_seen" Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime"/>
				<JsonPath Expr="links_to_target" Id="links_to_target" Title="Links to Target" Tag="links_to_target" Converter="Int"/>
				<JsonPath Expr="lost_links" Id="lost_links" Title="Lost Links" Tag="lost_links" Converter="Int"/>
				<JsonPath Expr="new_links" Id="new_links" Title="New Links" Tag="new_links" Converter="Int"/>
				<JsonPath Expr="positions_source_domain" Id="positions_source_domain" Title="Positions Source Domain" Tag="positions_source_domain" Converter="Int"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Anchors" Title="Anchors" Group="Site Explorer - Backlinks" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-anchors">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Aggregation"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
      <Number Id="Limit" Title="Limit" DefaultValue="1000" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/anchors
				?target=@Model.Target
				&mode=@Model.Mode
				&aggregation=@Model.Aggregation
				&select=@SelectedFields()
				&limit=@Model.Limit
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="anchors[*]">
				<JsonPath Expr="refdomains" Id="refdomains" Title="Ref Domains (5 units)" Tag="refdomains" Converter="Int" Checked="false"/>

				<JsonPath Expr="anchor" Id="anchor" Title="Anchor" Tag="anchor" Converter="String" DefaultValue=""/>
				<JsonPath Expr="dofollow_links" Id="dofollow_links" Title="Dofollow Links" Tag="dofollow_links" Converter="Int"/>
				<JsonPath Expr="first_seen" Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime"/>
				<JsonPath Expr="is_spam" Id="is_spam" Title="Spam" Tag="is_spam" Converter="Bool"/>
				<JsonPath Expr="last_seen" Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime"/>
				<JsonPath Expr="links_to_target" Id="links_to_target" Title="Links to Target" Tag="links_to_target" Converter="Int"/>
				<JsonPath Expr="lost_links" Id="lost_links" Title="Lost Links" Tag="lost_links" Converter="Int"/>
				<JsonPath Expr="new_links" Id="new_links" Title="New Links" Tag="new_links" Converter="Int"/>
				<JsonPath Expr="top_domain_rating" Id="top_domain_rating" Title="Top Domain Rating" Tag="top_domain_rating" Converter="Double"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="OrganicKeywords" Title="Organic Keywords" Group="Site Explorer - Organic Search" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-organic-keywords">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/organic-keywords
				?target=@Model.Target
				&mode=@Model.Mode
				&select=@SelectedFields()
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
				&volume_mode=@Model.VolumeMode
				&date=@Model.Date.ToString("yyyy-MM-dd")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="keywords[*]">
				<JsonPath Expr="csv(all_positions)" Id="all_positions" Title="All Positions (5 units)" Tag="all_positions" Converter="String" Checked="false"/>
				<JsonPath Expr="keyword_difficulty" Id="keyword_difficulty" Title="Keyword Difficulty (5 units)" Tag="keyword_difficulty" Converter="Int" Checked="false"/>
				<JsonPath Expr="sum_paid_traffic" Id="sum_paid_traffic" Title="Sum paid Traffic (10 units)" Tag="sum_paid_traffic" Converter="Int" Checked="false"/>
				<JsonPath Expr="sum_traffic" Id="sum_traffic" Title="Sum Traffic (10 units)" Tag="sum_traffic" Converter="Int" Checked="false"/>
				<JsonPath Expr="volume" Id="volume" Title="Volume (10 units)" Tag="volume" Converter="Int" Checked="false"/>

				<JsonPath Expr="best_position" Id="best_position" Title="Best Position" Tag="best_position" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="best_position_kind" Id="best_position_kind" Title="Best Position Kind" Tag="best_position_kind" Converter="String" DefaultValue=""/>
				<JsonPath Expr="best_position_set" Id="best_position_set" Title="Best Position Set" Tag="best_position_set" Converter="String" DefaultValue=""/>
				<JsonPath Expr="best_position_url" Id="best_position_url" Title="Best Position URL" Tag="best_position_url" Converter="String" DefaultValue=""/>
				<JsonPath Expr="cpc" Id="cpc" Title="CPC" Tag="cpc" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="csv(entities)" Id="entities" Title="Entities" Tag="entities" Converter="String" DefaultValue=""/>
				<JsonPath Expr="is_branded" Id="is_branded" Title="Branded" Tag="is_branded" Converter="Bool"/>
				<JsonPath Expr="is_commercial" Id="is_commercial" Title="Commercial" Tag="is_commercial" Converter="Bool"/>
				<JsonPath Expr="is_informational" Id="is_informational" Title="Informational" Tag="is_informational" Converter="Bool"/>
				<JsonPath Expr="is_local" Id="is_local" Title="Local" Tag="is_local" Converter="Bool"/>
				<JsonPath Expr="is_navigational" Id="is_navigational" Title="Navigational" Tag="is_navigational" Converter="Bool"/>
				<JsonPath Expr="is_transactional" Id="is_transactional" Title="Transactional" Tag="is_transactional" Converter="Bool"/>
				<JsonPath Expr="keyword" Id="keyword" Title="Keyword" Tag="keyword" Converter="String" DefaultValue=""/>
				<JsonPath Expr="keyword_country" Id="keyword_country" Title="Keyword Country" Tag="keyword_country" Converter="String" DefaultValue=""/>
				<JsonPath Expr="language" Id="language" Title="Language" Tag="language" Converter="String" DefaultValue=""/>
				<JsonPath Expr="last_update" Id="last_update" Title="Last Update" Tag="last_update" Converter="DateTime"/>
				<JsonPath Expr="csv(serp_features)" Id="serp_features" Title="SERP Features" Tag="serp_features" Converter="String" DefaultValue=""/>
				<JsonPath Expr="serp_features_count" Id="serp_features_count" Title="SERP Features Count" Tag="serp_features_count" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="serp_target_main_positions_count" Id="serp_target_main_positions_count" Title="SERP Target Main Positions Count" Tag="serp_target_main_positions_count" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="serp_target_positions_count" Id="serp_target_positions_count" Title="SERP Target Positions Count" Tag="serp_target_positions_count" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="volume_desktop_pct" Id="volume_desktop_pct" Title="Volume Desktop PCT" Tag="volume_desktop_pct" Converter="Double" DefaultValue="0"/>
				<JsonPath Expr="volume_mobile_pct" Id="volume_mobile_pct" Title="Volume Mobile PCT" Tag="volume_mobile_pct" Converter="Double" DefaultValue="0"/>
				<JsonPath Expr="words" Id="words" Title="Words" Tag="words" Converter="Int" DefaultValue=""/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="OrganicCompetitors" Title="Organic Competitors" Group="Site Explorer - Organic Search" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-organic-competitors">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/organic-competitors
				?target=@Model.Target
				&mode=@Model.Mode
				&select=@SelectedFields()
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
				&volume_mode=@Model.VolumeMode
				&date=@Model.Date.ToString("yyyy-MM-dd")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="competitors[*]">
				<JsonPath Expr="traffic" Id="traffic" Title="Share (10 units)" Tag="traffic" Converter="Int" DefaultValue="0" Checked="false"/>
				<JsonPath Expr="value" Id="value" Title="Value (10 units)" Tag="value" Converter="Int" DefaultValue="0" Checked="false"/>

				<JsonPath Expr="competitor_domain" Id="competitor_domain" Title="Competitor Domain" Tag="competitor_domain" Converter="String" DefaultValue=""/>
				<JsonPath Expr="competitor_url" Id="competitor_url" Title="Competitor URL" Tag="competitor_url" Converter="String" DefaultValue=""/>
				<JsonPath Expr="domain_rating" Id="domain_rating" Title="Domain Rating" Tag="domain_rating" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="keywords_common" Id="keywords_common" Title="Keywords Common" Tag="keywords_common" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="keywords_competitor" Id="keywords_competitor" Title="Keywords Competitor" Tag="keywords_competitor" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="keywords_target" Id="keywords_target" Title="Keywords Target" Tag="keywords_target" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="pages" Id="pages" Title="Pages" Tag="pages" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="share" Id="share" Title="Share" Tag="share" Converter="Double" DefaultValue="0"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="TopPages" Title="Top Pages" Group="Site Explorer - Organic Search" HelpUrl="https://docs.ahrefs.com/docs/api/site-explorer/operations/list-top-pages">
    <Parameters>
			<Resource Id="Mode"/>
			<Resource Id="Country"/>
			<Resource Id="VolumeMode"/>
      <Text Id="Target" Title="Target" Debug.DefaultValue="ahrefs.com" Required="true"/>
			<Date Id="Date" Title="Date"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.ahrefs.com/v3/site-explorer/top-pages
				?target=@Model.Target
				&mode=@Model.Mode
				&select=@SelectedFields()
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
				&volume_mode=@Model.VolumeMode
				&date=@Model.Date.ToString("yyyy-MM-dd")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="pages[*]">
				<JsonPath Expr="referring_domains" Id="referring_domains" Title="Reffering Domains (5 units)" Tag="referring_domains" Converter="Int" Checked="false"/>
				<JsonPath Expr="sum_traffic" Id="sum_traffic" Title="Sum Traffic (10 units)" Tag="sum_traffic" Converter="Int" Checked="false"/>
				<JsonPath Expr="top_keyword_volume" Id="top_keyword_volume" Title="Top Keyword Volume (10 units)" Tag="top_keyword_volume" Converter="Int" Checked="false"/>
				<JsonPath Expr="value" Id="value" Title="Value (10 units)" Tag="value" Converter="Int" DefaultValue="0" Checked="false"/>

				<JsonPath Expr="keywords" Id="keywords" Title="Keywords" Tag="keywords" Converter="Int"/>
				<JsonPath Expr="raw_url" Id="raw_url" Title="Raw URL" Tag="raw_url" Converter="String"/>
				<JsonPath Expr="top_keyword" Id="top_keyword" Title="Top Keyword" Tag="top_keyword" Converter="String"/>
				<JsonPath Expr="top_keyword_best_position" Id="top_keyword_best_position" Title="Top Keyword Best Position" Tag="top_keyword_best_position" Converter="Int"/>
				<JsonPath Expr="top_keyword_best_position_kind" Id="top_keyword_best_position_kind" Title="Top Keyword Best Position Kind" Tag="top_keyword_best_position_kind" Converter="String" DefaultValue=""/>
				<JsonPath Expr="top_keyword_best_position_title" Id="top_keyword_best_position_title" Title="Top Keyword Best Position Title" Tag="top_keyword_best_position_title" Converter="String" DefaultValue=""/>
				<JsonPath Expr="top_keyword_country" Id="top_keyword_country" Title="Top Keyword Country" Tag="top_keyword_country" Converter="String"/>
				<JsonPath Expr="ur" Id="ur" Title="URL Rating" Tag="ur" Converter="Int" DefaultValue="0"/>
				<JsonPath Expr="url" Id="url" Title="URL" Tag="url" Converter="String"/>
			</JsonPath>
    </Parse>
		<Resource Id="Fail"/>
  </RestConnector>


  <RazorFunctions>
    <![CDATA[
      string SelectedFields() {
        string[] fields = ((string)Model.Fields).Split(',').Select(e => e.Trim().ToLower()).ToArray();
        return string.Join(",",((ResultField[])Model.Headers).Where(e => !string.IsNullOrEmpty(e.Tag) && fields.Contains(e.Identifier.ToLower())).Select(e => e.Tag).Distinct().ToArray());
      }
    ]]>
  </RazorFunctions>

</Suite>
