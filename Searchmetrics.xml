<?xml version="1.0" encoding="UTF-8"?>
<Suite Category="SEO" Title="Searchmetrics" Id="Searchmetrics" RequireVersion="8.0.15" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Searchmetrics.xml" HelpUrl="http://seotoolsforexcel.com/searchmetrics/" HelpText="Documentation">

  <Author Name="Niels Bosma" Url="http://seotoolsforexcel.com"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/searchmetrics/">
    <Text Id="OAuthConsumerKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/searchmetrics/"/>
    <Text Id="OAuthConsumerSecret" Title="API Secret" Required="true"/>
  </Settings>

  <Resources>
    <Resource Id="SelectCountry">
      <Select Id="Country" Title="Country" Required="true" DefaultValue="US">
        <DataSource>
          <Item Id="AR" Title="Argentina"/>
          <Item Id="AU" Title="Australia"/>
          <Item Id="AT" Title="Austria"/>
          <Item Id="BR" Title="Brazil"/>
          <Item Id="CA" Title="Canada"/>
          <Item Id="DK" Title="Denmark"/>
          <Item Id="FI" Title="Finland"/>
          <Item Id="FR" Title="France"/>
          <Item Id="DE" Title="Germany"/>
          <Item Id="HK" Title="Hong Kong"/>
          <Item Id="IN" Title="India"/>
          <Item Id="IT" Title="Italy"/>
          <Item Id="JP" Title="Japan"/>
          <Item Id="MX" Title="Mexico"/>
          <Item Id="NL" Title="Netherlands"/>
          <Item Id="NO" Title="Norway"/>
          <Item Id="PL" Title="Poland"/>
          <Item Id="RU" Title="Russian Federation"/>
          <Item Id="SG" Title="Singapore"/>
          <Item Id="ZA" Title="South Africa"/>
          <Item Id="ES" Title="Spain"/>
          <Item Id="SE" Title="Sweden"/>
          <Item Id="CH" Title="Switzerland"/>
          <Item Id="TR" Title="Turkey"/>
          <Item Id="US" Title="USA"/>
          <Item Id="GB" Title="United Kingdom"/>
        </DataSource>
      </Select>
    </Resource>
    <Resource Id="SelectCurrency">
      <Select Id="Currency" Title="Currency" Required="true" DefaultValue="USD">
        <DataSource>
          <Item Id="USD" Title="USD"/>
          <Item Id="EUR" Title="EUR"/>
          <Item Id="GBP" Title="GBP"/>
        </DataSource>
      </Select>
    </Resource>
  </Resources>

  <!-- HIDDEN: -->
  <RestConnector Id="Authorization" Title="Authorization" HelpUrl="http://api.searchmetrics.com/v3/documentation/start" Hidden="true">
    <Fetch Url="http://api.searchmetrics.com/v3/token">
      <HttpSettings>
        <RequestContentType>application/x-www-form-urlencoded</RequestContentType>
        <RequestMethod>POST</RequestMethod>
        <RequestForm>
          <Param Name='grant_type'>client_credentials</Param>
          <Param Name='client_id'>@(Model.OAuthConsumerKey)</Param>
          <Param Name='client_secret'>@(Model.OAuthConsumerSecret)</Param>
        </RequestForm>
      </HttpSettings>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.access_token" Id="Authorization"/>
    </Parse>
  </RestConnector>
  <!-- //HIDDEN -->

  <RestConnector Id="ResearchOrganicGetCountDomainKeyword" Title="Organic Domain Keyword Count" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetCountDomainKeyword" HelpText="Number of organic keywords for a given domain.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <Text Id="FilterMonth" Title="Specific Month (Format: YYYYMM)" Debug.DefaultValue="201602" Required="false" HelpText=""/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetCountDomainKeyword
        @if(!string.IsNullOrEmpty(Model.FilterMonth))
        {
          @: Historic
        }
        .json?
        countrycode=@(Model.Country)
        &url=@(Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host))
        @if(!string.IsNullOrEmpty(Model.FilterMonth))
        {
          @: &year_month=@(Model.FilterMonth)
        }
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.response" Converter="Int"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListCommonKeywords" Title="Organic Common Keywords" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListCommonKeywords" HelpText="Overview comparison of the most relevant shared keywords (comeptititve keywords) for two URLs in organic search results.">
    <Parameters>
      <Text Id="Domain1" Title="First Domain" Debug.DefaultValue="google.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Text Id="Domain2" Title="Second Domain" Debug.DefaultValue="bing.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListCommonKeywords.json?
        url_1=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain1).Host)
        &url_2=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain2).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Common keyword"/>
        <JsonPath Expr="dom1_pos" Id="Url1Pos" Title="URL1 Position" Converter="Int" HelpText="Position of the first URL"/>
        <JsonPath Expr="dom2_pos" Id="Url2Pos" Title="URL2 Position" Converter="Int" HelpText="Position of second URL"/>
        <JsonPath Expr="dom1_traffic" Id="Url1AvgTraffic" Title="Url1 Avg Traffic" Converter="Double" HelpText="Average traffic for the first URL"/>
        <JsonPath Expr="dom2_traffic" Id="Url2AvgTraffic" Title="Url2 Avg Traffic" Converter="Double" HelpText="Average traffic for the second URL"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListCompetitors" Title="Organic Competitors" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListCompetitors" HelpText="Competitor domains in the organic search.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListCompetitors.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="domain" Id="Domain" Title="Domain" Converter="String" HelpText=""/>
        <JsonPath Expr="avg_position_1" Id="AVGPosition1" Title="Avg Position 1" Converter="Double" HelpText="The average position of the given domain with the shared keywords with the respective competitor domain."/>
        <JsonPath Expr="avg_position_2" Id="AVGposition2" Title="Avg Position 2" Converter="Double" HelpText="The average position of the respective competitor domain with the shared keywords with the given domain."/>
        <JsonPath Expr="common_keywords" Id="CommonKeywords" Title="Common Keywords" Converter="Int" HelpText="Number of shared keywords of the competitor with the given domain."/>
        <JsonPath Expr="traffic_1" Id="Traffic1" Title="Traffic 1" Converter="Int" HelpText="Organic traffic index of the given domain via the shared keywords with the respective competitor domain."/>
        <JsonPath Expr="traffic_2" Id="Traffic2" Title="Traffic 2" Converter="Int" HelpText="Organic traffic index of the competitor domain via the shared keywords with the given domain."/>
        <JsonPath Expr="costs" Id="Costs" Title="Costs" Converter="Double" HelpText="Value of the Competitor Traffic Index if it was bought via AdWords in EUR."/>
        <JsonPath Expr="total_kw_count" Id="TotalKWCount" Title="Total Keyword Count" Converter="Int" HelpText="Total number of keyword rankings of the competitor domain in the organic search."/>
        <JsonPath Expr="diff_keywords" Id="DiffKeywords" Title="Diff Keywords" Converter="Int" HelpText="Number of keyword rankings of the competitor domain in the organic search that are not shared with the given domain."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListIndustrySpread" Title="Organic Domain Keyword Industry Spread " HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListIndustrySpread" HelpText="Industry sector classification of a domain">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListIndustrySpread.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="category" Id="CategoryId" Title="Category Id" Converter="Int" HelpText="ID of the industry sector"/>
        <Compute Id="Category" Title="Category">
          <Compute.Expr>
            <![CDATA[
            @if(Model.category == 194590)
            {
              @: Sports and Fitness
            }
            else if(Model.category == 194593)
            {
              @: Finance
            }
            else if(Model.category == 194594)
            {
              @: Home and Garden
            }
            else if(Model.category == 194595)
            {
              @: Hobbies and Leisure
            }
            else if(Model.category == 194597)
            {
              @: Vehicles
            }
            else if(Model.category == 194598)
            {
              @: Media and Events
            }
            else if(Model.category == 194600)
            {
              @: Travel and Tourism
            }
            else if(Model.category == 194601)
            {
              @: Gifts and Occasions
            }
            else if(Model.category == 194602)
            {
              @: Family and Community
            }
            else if(Model.category == 194603)
            {
              @: Health
            }
            else if(Model.category == 194605)
            {
              @: Real Estate
            }
            else if(Model.category == 194606)
            {
              @: Apparel
            }
            else if(Model.category == 194608)
            {
              @: Food
            }
            else if(Model.category == 194610)
            {
              @: Beauty and Personal Care
            }
            else if(Model.category == 194849)
            {
              @: Law and Government Products
            }
            else if(Model.category == 196581)
            {
              @: Consumer Electronics
            }
            else if(Model.category == 196722)
            {
              @: Computers
            }
            ]]>
          </Compute.Expr>
          <JsonPath Expr="category" Id="category" Converter="Int"/>
        </Compute>
        <JsonPath Expr="percent" Id="Share" Title="Share" Converter="Double" HelpText="Percentage of keywords of the respective domain that belong to the respective industry sector"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListSubdomains" Title="Organic Subdomains" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListSubdomains" HelpText="Subdomains for one given domain">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="google.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListSubdomains.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="spi_aboslute" Id="SPIAbsolute" Title="SPI Absolute" Converter="Int" HelpText="Subdomain visibility"/>
        <JsonPath Expr="spi_percent" Id="SPIPercent" Title="SPI Percentage" Converter="Double" HelpText="Subdomain visibility in percent"/>
        <JsonPath Expr="host" Id="Host" Title="Host" Converter="String" HelpText="Subdomain"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>


  <RestConnector Id="ResearchOrganicGetListRankingsDomain" Title="Organic Domain Rankings" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListRankingsDomain" HelpText="Keyword rankings for a given domain in organic search results.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText="Either a domain or a subdomain"/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListRankingsDomain.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Ranking position in Google's organic search."/>
        <JsonPath Expr="page" Id="Page" Title="Page" Converter="Int" HelpText="Ranking Page in Google's organic search."/>
        <JsonPath Expr="last_months_count" Id="LastMonthsCount" Title="Last Months Count" Converter="Int" HelpText="Local Google search volume in Google (exact match)."/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Int" HelpText="Google Advertising competition on the keyword."/>
        <JsonPath Expr="avg_popularity" Id="AvgPopularity" Title="Avg Popularity" Converter="Int" HelpText="Global Google search volume in Google (exact match)."/>
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC for the keyword in EUR."/>
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String"/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText="Title of the entry in Google's organic ranking."/>
        <JsonPath Expr="url" Id="Rrl" Title="URL" Converter="String" HelpText="URL of the entry Google's organic ranking."/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText="Description of the entry in the organic Google ranking."/>
        <JsonPath Expr="traffic" Id="Traffic" Title="Traffic" Converter="Double" HelpText="Estimation of traffic based on search volume and position."/>
        <JsonPath Expr="adbudget" Id="AdBudget" Title="Ad Budget" Converter="Double" HelpText="AdWords budget spent on the keyword in the last month in our database."/>
        <JsonPath Expr="potential" Id="Potential" Title="Potential" Converter="Int" HelpText="Traffic potential in absolute clicks in relation with top ranking position 1."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListRankingsKeyword" Title="Organic Keyword Rankings" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListRankingsKeyword" HelpText="Rankings for a given keyword in organic search results.">
    <Parameters>
      <Text Id="Keyword" Title="Keyword" Debug.DefaultValue="dogs" Required="true" HelpText=""/>
      <Date Id="DisplayDate" Title="Display Date" Required="false" Nullable="true"/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListRankingsKeyword
        @if(!Utils.IsNullDate(Model.DisplayDate))
        {
          @: Historic
        }
        .json?
        keyword=@(Utils.UrlEncode(Model.Keyword))
        &countrycode=@Model.Country
        @if(!Utils.IsNullDate(Model.DisplayDate))
        {
          @: &date=@Model.DisplayDate.ToString("yyyMMdd")
        }
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="URL of the search engine entry."/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText="Title of the search engine entry."/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="SERP = search engine ranking position."/>
        <JsonPath Expr="page" Id="Page" Title="Page" Converter="Int" HelpText="Number of Google result page."/>
        <JsonPath Expr="trend.trend" Id="Trend" Title="Trend" Converter="Int"/>
        <JsonPath Expr="trend.abs" Id="Abs" Title="Trend Absolute Change" Converter="Int" HelpText="The absolute change in the visibility in comparison to the previous week."/>
        <JsonPath Expr="trend.per" Id="Per" Title="Trend Relative Change" Converter="Double" HelpText="The relative/percentual change in the visibility in comparison to the previous week."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListSeoVisibilityCountry" Title="Organic Visibility by Country" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListSeoVisibilityCountry" HelpText="Searchmetrics SEO Visibility per country for a given URL.">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="http://searchmetrics.de" Required="true" HelpText="Either a domain or a subdomain."/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListSeoVisibilityCountry.json?
        url=@(Utils.UrlEncode(Model.Url))
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="country_code" Id="CountryCode" Title="Country Code" Converter="String" HelpText="A two letter country code as specified in ISO 3166-1 Format: US, GB, DE etc."/>
        <JsonPath Expr="visibility" Id="Visibility" Title="Visibility" Converter="Int" HelpText="Searchmetrics Organic Visibility"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListSeoVisibilityTop100Losers" Title="Organic Visibility Top100 Losers" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListSeoVisibilityTop100Losers" HelpText="Top100 Searchmetrics Organic Visibility losers in a given country">
    <Parameters>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListSeoVisibilityTop100Losers.json?
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="host" Id="Host" Title="Host" Converter="String" HelpText="Domain or subdomain"/>
        <JsonPath Expr="difference" Id="Difference" Title="Difference" Converter="Int" HelpText="Absolute difference in Searchmetrics visibility between current and previous wek"/>
        <JsonPath Expr="seo_visibility_actual" Id="SeoVisibilityActual" Title="Visibility" Converter="Int" HelpText="Current Searchmetrics Organic Visibility"/>
        <JsonPath Expr="seo_visibility_last" Id="SeoVisibilityLast" Title="Visibility Last Week" Converter="Int" HelpText="Searchmetrics Organic Visibility of the previous week"/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Position the Searchmetrics Organic Visibility Loser ranking"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListSeoVisibilityTop100Winners" Title="Organic Visibility Top100 Winners" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListSeoVisibilityTop100Winners" HelpText="Top100 Organic Visibility winners in a given country">
    <Parameters>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListSeoVisibilityTop100Winners.json?
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="host" Id="Host" Title="Host" Converter="String" HelpText="Domain or subdomain"/>
        <JsonPath Expr="difference" Id="Difference" Title="Difference" Converter="Int" HelpText="Absolute difference in Searchmetrics visibility between current and previous wek"/>
        <JsonPath Expr="seo_visibility_actual" Id="SeoVisibilityActual" Title="Visibility" Converter="Int" HelpText="Current Searchmetrics Organic Visibility"/>
        <JsonPath Expr="seo_visibility_last" Id="SeoVisibilityLast" Title="Visibility Last Week" Converter="Int" HelpText="Searchmetrics Organic Visibility of the previous week"/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Position the Searchmetrics Organic Visibility Loser ranking"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetValueSeoVisibility" Title="Organic Visibility" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetValueSeoVisibility" HelpText="Searchmetrics SEO Visibility for a given URL in a given country.">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="http://searchmetrics.de" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetValueSeoVisibility.json?
        url=@(Utils.UrlEncode(Model.Url))
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.visibility" Id="Visibility" Title="Visibility" Converter="Int" HelpText="Searchmetrics SEO Visibility"/>
      <JsonPath Expr="response.trend.trend" Id="Trend" Title="Trend" Converter="Int" Checked="false"/>
      <JsonPath Expr="response.trend.abs" Id="Abs" Title="Trend Absolute Change" Converter="Int" Checked="false" HelpText="The absolute change in the visibility in comparison to the previous week."/>
      <JsonPath Expr="response.trend.per" Id="Per" Title="Trend Relative Change" Converter="Double" Checked="false" HelpText="The relative/percentual change in the visibility in comparison to the previous week."/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="Backlinks" Title="Backlinks" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetListBacklinks" HelpText="Number of backlinks for a given domain, subdomain or URL.">
    <Parameters>
      <Text Id="Url" Title="Domain/URL" Debug.DefaultValue="http://seotoolsforexcel.com" Required="true" HelpText=""/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetListBacklinks.json?
        url=@Utils.UrlEncode(Model.Url)
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="backlinkpage" Id="BacklinkPage" Title="Backlink Page" Converter="String" HelpText="URL on which the backlink was found."/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText="Page title of the page on which the backlink was found."/>
        <JsonPath Expr="linktext" Id="LinkText" Title="Link Text" Converter="String" HelpText="Anchor text."/>
        <JsonPath Expr="extL" Id="ExtL" Title="External Links" Converter="Int" HelpText="Number of links on the backlink page that go to external pages."/>
        <JsonPath Expr="intL" Id="IntL" Title="Internal Links" Converter="Int" HelpText="	Number of links on the backlink page that go to internal pages."/>
        <JsonPath Expr="sumL" Id="SumL" Title="Total Links" Converter="Int" HelpText="Number of links on the backlink page."/>
        <JsonPath Expr="sr" Id="Sr" Title="SearchMetrics Page Strength" Converter="Int" HelpText="Searchmetrics calculates for each page the page strength from the weighted backlinks that point to this page. A page with many links is given a high Searchmetrics Page Strength (SPS); a page with no or only a few links a low SPS."/>
        <JsonPath Expr="pos" Id="Pos" Title="Link Position" Converter="Int" HelpText="All links on the backlink page are numbered in order of appearance. This number therefore reflects the position of the link on the backlink page. &quot;1&quot; is the first position. The higher the number is the lower is the position of the link."/>
        <JsonPath Expr="linktarget" Id="LinkTarget" Title="Link Target" Converter="String" HelpText="Target URL of the link."/>
        <JsonPath Expr="tag" Id="Tag" Title="Tag" Converter="String" HelpText="	Link type (text/image/javascript/iframe etc.)"/>
        <JsonPath Expr="nofollow" Id="NoFollow" Title="No follow" Converter="Bool" HelpText=""/>
        <JsonPath Expr="ip" Id="Ip" Title="Ip" Converter="String" HelpText="IP of the backlink page"/>
        <JsonPath Expr="ccode" Id="CCode" Title="Country Code" Converter="String" HelpText="Country code of the server location of the backlink page."/>
        <JsonPath Expr="country" Id="Country" Title="Country" Converter="String" HelpText="	Country name of the server location of the backlink page."/>
        <JsonPath Expr="city" Id="City" Title="City" Converter="String" HelpText="City of the server location of the backlink page."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchLinksGetCountDeeplinkRatio" Title="Deeplink Ratio" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetCountDeeplinkRatio" HelpText="Ratio of homepage links and deeplinks for a given domain">
    <Parameters>
      <Text Id="Url" Title="Domain/URL" Debug.DefaultValue="http://seotoolsforexcel.com" Required="true" HelpText=""/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetCountDeeplinkRatio.json?
        url=@Utils.UrlEncode(Model.Url)
        &access_token=@(Model.Authorization)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
        <JsonPath Expr="$.response[0].homelinks" Id="Homelinks" Title="Homelinks" Converter="Int" HelpText="Number of links pointing to the homepage of the given domain"/>
        <JsonPath Expr="$.response[1].deeplinks" Id="Deeplinks" Title="Deeplinks" Converter="Int" HelpText="Number of links pointing to subpages of the given domain (deeplinks)"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetValueSeoRank" Title="Organic Rank" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetValueSeoRank" HelpText="SEO visibility rank of the domain (SEORank).">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetValueSeoRank.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="domain" Id="Domain" Title="Domain" Converter="String" HelpText="Domain for which the SEORank is queried"/>
        <JsonPath Expr="visibility" Id="Visibility" Title="Visibility" Converter="Int" HelpText="Searchmetrics SEO Visibility"/>
        <JsonPath Expr="id" Id="Id" Title="SEO Rank" Converter="Int" HelpText="SEORank"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetValueSeoVisibilityWorld" Title="Organic Visibility Global" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetValueSeoVisibilityWorld" HelpText="Searchmetrics SEO Worldwide Visibility for a given URL.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetValueSeoVisibilityWorld.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &access_token=@(Model.Authorization)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.sum" Id="Sum" Title="Sum" Converter="Int" HelpText="Searchmetrics Organic Worldwide Visibility"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchKeywordsGetListKeywordInfo" Title="Keyword Info" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchKeywordsGetListKeywordinfo" HelpText="This call returns search-related information for a given keyword for a given country for the current month.">
    <Parameters>
      <Text Id="keyword" Title="Keyword" Debug.DefaultValue="boat" Required="true" HelpText=""/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchKeywordsGetListKeywordinfo.json?
        keyword=@(Utils.UrlEncode(Model.keyword).ToLower())
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the specific keyword."/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Int" HelpText="This is an indicator for the competion for the given keyword in the Paid Index. The higher it is the more domains that have placed AdWords ads for the keyword."/>
        <JsonPath Expr="search_volume" Id="SearchVolume" Title="Search Volume" Converter="Int" HelpText="Current monthly search volume in Google."/>
        <JsonPath Expr="trend" Id="Trend" Title="Trend" Converter="String" HelpText="The relative distribution of the search volume per month over the year for the respective keyword."/>
        <JsonPath Expr="ad_budget" Id="AdBudget" Title="Ad Budget" Converter="Double" HelpText="Monthly Google AdWords ad budget that is spent on the keyword."/>
        <JsonPath Expr="integration" Id="Integration" Title="Integration" Converter="String" HelpText="The types of universal search integrations that can be found for this keyword."/>
        <JsonPath Expr="advertiser_count" Id="AdvertiserCount" Title="Advertiser Count" Converter="Int" HelpText="Number of advertisers bidding on the keyword."/>
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is returned."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchKeywordsGetListLosers" Title="Keyword Losers" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchKeywordsGetListLosers" HelpText="Keywords with the highest absolute losses in organic search traffic for a given domain">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchKeywordsGetListLosers.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is shown."/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="URL of the indexed landing page."/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Actual position of the given domain for the respective keyword in Google's organic search index."/>
        <JsonPath Expr="trend_position" Id="TrendPosition" Title="Trend Position" Converter="Int" HelpText="Difference in keyword position between current and previous month."/>
        <JsonPath Expr="position_last" Id="PositionLast" Title="Position Last" Converter="Int" HelpText="Position of the given domain for the respective keyword in Google's organic search index in the previous month."/>
        <JsonPath Expr="delta_traffic_monthly" Id="DeltaTrafficMonthly" Title="Delta Traffic Monthly" Converter="Int" HelpText="Difference in estimated monthly traffic between current and last month via the respective keyword for the given domain."/>
        <JsonPath Expr="search_volume_monthly" Id="SearchVolumeMonthly" Title="Search Volume Monthly" Converter="Int" HelpText="Estimated search volume in Google for the respective Keyword."/>
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the respective keyword."/>
        <JsonPath Expr="traffic_monthly" Id="TrafficMonthly" Title="Traffic Monthly" Converter="Int" HelpText="Estimated current monthly traffic of the given domain from Google via the respective keyword."/>
        <JsonPath Expr="traffic_monthly_last" Id="TrafficMonthlyLast" Title="Traffic Monthly Last" Converter="Int" HelpText="Estimated monthly traffic last month of the given domain from Google via the respective keyword."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchKeywordsGetListLosersHistoric" Title="Keyword Losers History" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchKeywordsGetListLosersHistoric" HelpText="Keywords with the highest absolute losses in organic search traffic for a given domain for a given date">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Date Id="DisplayDate" Title="Display Date" Required="false" Nullable="true"/>
    <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchKeywordsGetListLosersHistoric.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &date=&date=@Model.DisplayDate.ToString("yyyMMdd")
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is shown."/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="URL of the indexed landing page."/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Actual position of the given domain for the respective keyword in Google's organic search index."/>
        <JsonPath Expr="trend_position" Id="TrendPosition" Title="Trend Position" Converter="Int" HelpText="Difference in keyword position between current and previous month."/>
        <JsonPath Expr="position_last" Id="PositionLast" Title="Position Last" Converter="Int" HelpText="Position of the given domain for the respective keyword in Google's organic search index in the previous month."/>
        <JsonPath Expr="delta_traffic_monthly" Id="DeltaTrafficMonthly" Title="Delta Traffic Monthly" Converter="Int" HelpText="Difference in estimated monthly traffic between current and last month via the respective keyword for the given domain."/>
        <JsonPath Expr="search_volume_monthly" Id="SearchVolumeMonthly" Title="Search Volume Monthly" Converter="Int" HelpText="Estimated search volume in Google for the respective Keyword."/>
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the respective keyword."/>
        <JsonPath Expr="traffic_monthly" Id="TrafficMonthly" Title="Traffic Monthly" Converter="Int" HelpText="Estimated current monthly traffic of the given domain from Google via the respective keyword."/>
        <JsonPath Expr="traffic_monthly_last" Id="TrafficMonthlyLast" Title="Traffic Monthly Last" Converter="Int" HelpText="Estimated monthly traffic last month of the given domain from Google via the respective keyword."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchKeywordsGetListWinners" Title="Keyword Winners" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchKeywordsGetListWinners" HelpText="Keywords with the highest absolute gains in organic search traffic for a given domain">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchKeywordsGetListWinners.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is shown."/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="URL of the indexed landing page."/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Actual position of the given domain for the respective keyword in Google's organic search index."/>
        <JsonPath Expr="trend_position" Id="TrendPosition" Title="Trend Position" Converter="Int" HelpText="Difference in keyword position between current and previous month."/>
        <JsonPath Expr="position_last" Id="PositionLast" Title="Position Last" Converter="Int" HelpText="Position of the given domain for the respective keyword in Google's organic search index in the previous month."/>
        <JsonPath Expr="delta_traffic_monthly" Id="DeltaTrafficMonthly" Title="Delta Traffic Monthly" Converter="Int" HelpText="Difference in estimated monthly traffic between current and last month via the respective keyword for the given domain."/>
        <JsonPath Expr="search_volume_monthly" Id="SearchVolumeMonthly" Title="Search Volume Monthly" Converter="Int" HelpText="Estimated search volume in Google for the respective Keyword."/>
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the respective keyword."/>
        <JsonPath Expr="traffic_monthly" Id="TrafficMonthly" Title="Traffic Monthly" Converter="Int" HelpText="Estimated current monthly traffic of the given domain from Google via the respective keyword."/>
        <JsonPath Expr="traffic_monthly_last" Id="TrafficMonthlyLast" Title="Traffic Monthly Last" Converter="Int" HelpText="Estimated monthly traffic last month of the given domain from Google via the respective keyword."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchKeywordsGetListWinnersHistoric" Title="Keyword Winners History" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchKeywordsGetListWInnersHistoric" HelpText="Keywords with the highest absolute gains in organic search traffic for a given domain with access to historic data">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Date Id="DisplayDate" Title="Display Date" Required="false" Nullable="true"/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchKeywordsGetListWinnersHistoric.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &date=&date=@Model.DisplayDate.ToString("yyyMMdd")
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is shown."/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="URL of the indexed landing page."/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Actual position of the given domain for the respective keyword in Google's organic search index."/>
        <JsonPath Expr="trend_position" Id="TrendPosition" Title="Trend Position" Converter="Int" HelpText="Difference in keyword position between current and previous month."/>
        <JsonPath Expr="position_last" Id="PositionLast" Title="Position Last" Converter="Int" HelpText="Position of the given domain for the respective keyword in Google's organic search index in the previous month."/>
        <JsonPath Expr="delta_traffic_monthly" Id="DeltaTrafficMonthly" Title="Delta Traffic Monthly" Converter="Int" HelpText="Difference in estimated monthly traffic between current and last month via the respective keyword for the given domain."/>
        <JsonPath Expr="search_volume_monthly" Id="SearchVolumeMonthly" Title="Search Volume Monthly" Converter="Int" HelpText="Estimated search volume in Google for the respective Keyword."/>
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the respective keyword."/>
        <JsonPath Expr="traffic_monthly" Id="TrafficMonthly" Title="Traffic Monthly" Converter="Int" HelpText="Estimated current monthly traffic of the given domain from Google via the respective keyword."/>
        <JsonPath Expr="traffic_monthly_last" Id="TrafficMonthlyLast" Title="Traffic Monthly Last" Converter="Int" HelpText="Estimated monthly traffic last month of the given domain from Google via the respective keyword."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetListAdVariations" Title="Paid Ad Variations" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchPaidGetListAdVariations" HelpText="Get a list of different ad variations">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetListAdVariations.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText="Title of the ad"/>
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="Display URL of the ad"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetValueTrafficValue" Title="Organic Traffic Value Last Month" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetValueTrafficValue" HelpText="Estimated paid value of organic search traffic.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="cnn.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetValueTrafficValue.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
        <JsonPath Expr="$..traffic_value" Id="Value" Title="Value" Converter="Double" HelpText="Estimated paid value of organic search traffic."/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchKeywordsGetListSimilarKeywords" Title="Keywords Similar" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchKeywordsGetListSimilarKeywords" HelpText="List of keywords that contain a selected keyword.">
    <Parameters>
      <Text Id="Keyword" Title="Keyword" Debug.DefaultValue="boat" Required="true" HelpText=""/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchKeywordsGetListSimilarKeywords.json?
        keyword=@Utils.UrlEncode(Model.Keyword.ToLower())
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is returned."/>
        <JsonPath Expr="search_volume" Id="SearchVolume" Title="Search Volume" Converter="Int" HelpText="Current monthly search volume in Google."/>
        <JsonPath Expr="trend" Id="Trend" Title="Trend" Converter="String" HelpText="Trend for the search volume of the keyword in the previous year."/>
        <JsonPath Expr="cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the specific keyword."/>
        <JsonPath Expr="advertiser_count" Id="AdvertiserCount" Title="Advertiser Count" Converter="Int" HelpText="Number of advertisers bidding on the keyword."/>
        <JsonPath Expr="integration" Id="Integration" Title="Integration" Converter="String" HelpText="Universal search items that can be found in the search results for this keyword (e.g. news,video,images etc.)."/>
        <JsonPath Expr="adbudget" Id="AdBudget" Title="Ad Budget" Converter="Double" HelpText="Monthly Google AdWords ad budget that is spent on the keyword."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetCountDomainKeyword" Title="Paid Domain Keyword Count" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchPaidGetCountDomainKeyword" HelpText="Number of paid keywords for a domain in a given country.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetCountDomainKeyword.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.response" Converter="Int"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetListKeywords" Title="Paid Keywords" HelpUrl="http://api.searchmetrics.com/api-calls/service/ResearchPaidGetListKeywords" HelpText="Paid keywords with advertisements for a given domain.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetListKeywords.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword" Converter="String" HelpText="Keyword for which the data is returned."/>
        <JsonPath Expr="position" Id="Position" Title="Position" Converter="Int" HelpText="Keyword position in Google's paid search."/>
        <JsonPath Expr="page" Id="Page" Title="Page" Converter="Int" HelpText="Result page in Google's paid search."/>
        <JsonPath Expr="traffic_monthly" Id="TrafficMonthly" Title="Traffic Monthly" Converter="Int" HelpText="Estimation of monthly traffic based on search volume and position."/>
        <JsonPath Expr="cpc" Id="cpc" Title="Cpc" Converter="Double" HelpText="Estimated CPC in AdWords for the specific keyword."/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Int" HelpText="An indicator for the advertising competition on the keyword. The higher it is the stronger is the competition. Minimum is 0, maximum is 100."/>
        <JsonPath Expr="search_volume_monthly" Id="SearchVolumeMonthly" Title="Search Volume Monthly" Converter="Int" HelpText="Current monthly search volume in Google."/>
        <JsonPath Expr="adbudget_monthly" Id="AdBudgetMonthly" Title="Adbudget Monthly" Converter="Double" HelpText="Monthly Google AdWords ad budget that is spent on the keyword."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetListCompetitors" Title="Paid Competitors" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchPaidGetListCompetitors" HelpText="Competitor domains in the paid search.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetListCompetitors.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="domain" Id="dDain" Title="Domain" Converter="String" HelpText="Competitor domain"/>
        <JsonPath Expr="avg_position_1" Id="AvgPosition1" Title="Avg Position 1" Converter="Double" HelpText="The average position of the given domain with the shared keywords with the respective competitor domain."/>
        <JsonPath Expr="avg_position_2" Id="Avgposition2" Title="Avg Position 2" Converter="Double" HelpText="The average position of the respective competitor domain with the shared keywords with the given domain."/>
        <JsonPath Expr="common_keywords" Id="CommonKeywords" Title="Common Keywords" Converter="Int" HelpText="Number of shared keywords of the competitor with the given domain."/>
        <JsonPath Expr="traffic_1" Id="Traffic1" Title="Traffic 1" Converter="Double" HelpText="Organic traffic index of the given domain via the shared keywords with the respective competitor domain."/>
        <JsonPath Expr="traffic_2" Id="Traffic2" Title="Traffic 2" Converter="Double" HelpText="Organic traffic index of the competitor domain via the shared keywords with the given domain."/>
        <JsonPath Expr="costs" Id="Costs" Title="Costs" Converter="Double" HelpText="Value of the Competitor Traffic Index if it was bought via AdWords."/>
        <JsonPath Expr="total_kw_count" Id="TotalKwCount" Title="Total Keyword Count" Converter="Int" HelpText="Total number of keyword rankings of the competitor domain in the organic search."/>
        <JsonPath Expr="diff_keywords" Id="DiffKeywords" Title="Diff Keywords" Converter="Int" HelpText="Number of keyword rankings of the competitor domain in the organic search that are not shared with the given domain."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetValuePaidKpis" Title="Paid KPIs" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchPaidGetValuePaidKpis" HelpText="Collection of paid search KPIs: paid traffic, ad budget, clicks per day, average CPC, Paid Rank.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetValuePaidKpis.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.traffic" Id="Traffic" Title="Traffic" Converter="Int" HelpText="Estimated number of visitors per month that visit the page through paid advertisements. Paid search traffic index is calculated from a domains advertisement keywords and their positions."/>
      <JsonPath Expr="response.ad_budget" Id="AdBudget" Title="Ad Budget" Converter="Double" HelpText="Estimated monthly Google AdWords advertising budget."/>
      <JsonPath Expr="response.clicks_day" Id="ClicksDay" Title="Clicks per Pay" Converter="Double" HelpText="Estimated clicks per day through paid advertisements."/>
      <JsonPath Expr="response.cpc" Id="Cpc" Title="Cpc" Converter="Double" HelpText="Estimated average CPC."/>
      <JsonPath Expr="response.rank" Id="Rank" Title="Rank" Converter="Int" HelpText="Average rank of the paid advertisements."/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetValuePaidRank" Title="Paid Rank" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchPaidGetValuePaidRank" HelpText="Searchmetrics Paid Visibility rank of the domain">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetValuePaidRank.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="domain" Id="Domain" Title="Domain" Converter="String" HelpText="Domain for which the PaidRank is queried."/>
        <JsonPath Expr="visibility" Id="Visibility" Title="Visibility" Converter="Int" HelpText="Searchmetrics Paid Visibility."/>
        <JsonPath Expr="id" Id="Id" Title="Paid Rank" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchPaidGetValuePaidVisibility" Title="Paid Visibility" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchPaidGetValuePaidVisibility" HelpText="Searchmetrics Paid Visibility for a given URL and a given country.">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="http://searchmetrics.de" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchPaidGetValuePaidVisibility.json?
        url=@(Utils.UrlEncode(Model.Url))
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.visibility" Id="Visibility" Title="Visibility" Converter="Int"/>
      <JsonPath Expr="response.trend.trend" Id="Trend" Title="Trend" Converter="Int" Checked="false"/>
      <JsonPath Expr="response.trend.abs" Id="Abs" Title="Trend Absolute Change" Converter="Int" Checked="false" HelpText="The absolute change in the visibility in comparison to the previous week."/>
      <JsonPath Expr="response.trend.per" Id="Per" Title="Trend Relative Change" Converter="Double" Checked="false" HelpText="The relative/percentual change in the visibility in comparison to the previous week."/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchLinksGetCountBacklinks" Title="Backlinks Count" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetCountBacklinks" HelpText="Number of backlinks for a given domain, subdomain or URL.">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Can be either a domain, a subdomain or a page."/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetCountBacklinks.json?
        url=@Utils.UrlEncode(Model.Url)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="backlinks" Id="Backlinks" Title="Backlinks" Converter="Int" HelpText="Number of referring links"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchLinksGetCountReferringDomains" Title="Referring Domains Count" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetCountReferringDomains" HelpText="Number of referring domains for a given URL. Number of referring domains for a given URL (Domain popularity).">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Can be either a domain, a subdomain or a page."/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetCountReferringDomains.json?
        url=@Utils.UrlEncode(Model.Url)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="domainpopularity" Id="DomainPopularity" Title="Domain Popularity" Converter="Int" HelpText="Number of referring domains"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchLinksGetCountReferringIps" Title="Referring IPs Count" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetCountReferringIps" HelpText="Number of referring IPs for a given URL (IP popularity).">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Can be either a domain, a subdomain or a page."/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetCountReferringIps.json?
        url=@Utils.UrlEncode(Model.Url)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="ip" Id="Ip" Title="IPs" Converter="Int" HelpText="Number of referring IPs."/>
        <JsonPath Expr="class_b" Id="ClassB" Title="Class B" Converter="Int" HelpText="Number of referring IPs with a different B-class."/>
        <JsonPath Expr="class_c" Id="ClassC" Title="Class C" Converter="Int" HelpText="Number of referring IPs with a different C-class."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchLinksGetListLinkedPages" Title="Linked Pages" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetListLinkedPages" HelpText="List of pages of a given URL with links from external pages.">
    <Parameters>
      <Text Id="Url" Title="Domain/URL" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText=""/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetListLinkedPages.json?
        url=@Utils.UrlEncode(Model.Url)
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="linkedpage" Id="LinkedPage" Title="Linked page" Converter="String" HelpText="URL of the target page."/>
        <JsonPath Expr="frequency" Id="Frequency" Title="External links" Converter="Int" HelpText="Number of external links pointing to the respective target page."/>
        <JsonPath Expr="percentage" Id="Percentage" Title="Percentage" Converter="Double" HelpText="Percentage of links pointing to the target page in relation to all links pointing to the belonging domain."/>
        <JsonPath Expr="refdoms" Id="RefDoms" Title="Referring domains" Converter="Int" HelpText="Number of referring domains pointing to the respective target page."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchLinksGetListLinktext" Title="Anchor Texts" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchLinksGetListLinktext" HelpText="Most frequently used link anchor texts for a given URL.">
    <Parameters>
      <Text Id="Url" Title="Domain/URL" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText=""/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchLinksGetListLinktext.json?
        url=@Utils.UrlEncode(Model.Url)
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="anchortext" Id="anchortext" Title="Anchor Text" Converter="String" HelpText=""/>
        <JsonPath Expr="frequency" Id="frequency" Title="Frequency" Converter="String" HelpText="Absolute total frequency of the anchor text."/>
        <JsonPath Expr="percentage" Id="percentage" Title="Percentage" Converter="Double" HelpText="Percentual frequency of the anchor text in relation to all anchor texts."/>
        <JsonPath Expr="refdoms" Id="refdoms" Title="Referring Domains" Converter="Int" HelpText="Number of referring domains with the respective anchor text."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchContentGetListLoserUrls" Title="URL Losers" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchContentGetListLoserUrls" HelpText="Get the list of the loser urls of a given domain.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchContentGetListLoserUrls.json?
        domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &keyword_limit=0
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="A url of the given domain"/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText="Title of the url"/>
        <JsonPath Expr="total_traffic_index" Id="TotalTrafficIndex" Title="Traffic Index" Converter="Int" HelpText="Traffic index"/>
        <JsonPath Expr="delta_traffic_index" Id="DeltaTrafficIndex" Title="Delta Traffic Index" Converter="Int" HelpText="Delta between traffic index and traffic potential"/>
        <JsonPath Expr="total_search_volume" Id="TotalSearchVolume" Title="Search Volume" Converter="Int" HelpText="Ranking keywords aggregated search volume"/>
        <JsonPath Expr="total_visibility" Id="TotalVisibility" Title="Traffic Index" Converter="Int" HelpText="Visibility of the url"/>
        <JsonPath Expr="trend_average_position.abs" Id="TrendAvgPositionAbs" Title="Trend Avg Position Abs" Converter="Int" HelpText="The absolute change in the position in comparison to the previous week."/>
        <JsonPath Expr="trend_total_visibility.abs" Id="TrendVisibilityAbs" Title="Trend Visibility Abs" Converter="Int" HelpText="The absolute change in the visibility in comparison to the previous week."/>
        <JsonPath Expr="average_cpc" Id="AverageCPC" Title="Average CPC" Converter="Double" HelpText="Average cpc of the url"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchContentGetListWinnerUrls" Title="URL Winners" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchContentGetListWinnerUrls" HelpText="Get the list of the winner urls of a given domain.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Paging PageSize="100" MinTake="100" IncrementTake="100"/>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchContentGetListWinnerUrls.json?
        domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &keyword_limit=0
        &limit=@(Model.PageCursor.PageSize)
        &offset=@(Model.PageCursor.NextSkip)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="url" Id="Url" Title="URL" Converter="String" HelpText="A url of the given domain"/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String" HelpText="Title of the url"/>
        <JsonPath Expr="total_traffic_index" Id="TotalTrafficIndex" Title="Traffic Index" Converter="Int" HelpText="Traffic index"/>
        <JsonPath Expr="delta_traffic_index" Id="DeltaTrafficIndex" Title="Delta Traffic Index" Converter="Int" HelpText="Delta between traffic index and traffic potential"/>
        <JsonPath Expr="total_search_volume" Id="TotalSearchVolume" Title="Search Volume" Converter="Int" HelpText="Ranking keywords aggregated search volume"/>
        <JsonPath Expr="total_visibility" Id="TotalVisibility" Title="Traffic Index" Converter="Int" HelpText="Visibility of the url"/>
        <JsonPath Expr="trend_average_position.abs" Id="TrendAvgPositionAbs" Title="Trend Avg Position Abs" Converter="Int" HelpText="The absolute change in the position in comparison to the previous week."/>
        <JsonPath Expr="trend_total_visibility.abs" Id="TrendVisibilityAbs" Title="Trend Visibility Abs" Converter="Int" HelpText="The absolute change in the visibility in comparison to the previous week."/>
        <JsonPath Expr="average_cpc" Id="AverageCPC" Title="Average CPC" Converter="Double" HelpText="Average cpc of the url"/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchContentGetValueSeoValueDomain" Title="SEO Value Domain" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchContentGetValueSeoValue" HelpText="Get the SEO value and the SEO value potential of a given domain.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchContentGetValueSeoValue.json?
        domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
       <JsonPath Expr="response.seo_value" Id="SeoValue" Title="Value" Converter="Double" HelpText="SEO value"/>
       <JsonPath Expr="response.seo_value_potential" Id="SeoPotential" Title="Potential" Converter="Double" HelpText="SEO value potential"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchContentGetValueSeoValueUrl" Title="SEO Value URL" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchContentGetValueSeoValue" HelpText="Get the SEO value and the SEO value potential of a given URL.">
    <Parameters>
      <Text Id="Url" Title="Domain/URL" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" HelpText=""/>
      <Resource Id="SelectCountry"/>
      <Resource Id="SelectCurrency"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchContentGetValueSeoValue.json?
        url=@Utils.UrlEncode(Model.Url)
        &countrycode=@Model.Country
        &currency=@(Model.Currency)
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
       <JsonPath Expr="response.seo_value" Id="SeoValue" Title="Value" Converter="Double" HelpText="SEO value"/>
       <JsonPath Expr="response.seo_value_potential" Id="SeoPotential" Title="Potential" Converter="Double" HelpText="SEO value potential"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchContentGetValueTrafficIndex" Title="Traffic Index" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchContentGetValueTrafficIndex" HelpText="Get the value of traffic index and traffic index potential of a given domain.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="searchmetrics.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchContentGetValueTrafficIndex.json?
        domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
       <JsonPath Expr="response.traffic_index" Id="TrafficIndex" Title="Index" Converter="Double" HelpText="Traffic index"/>
       <JsonPath Expr="response.traffic_index_potential" Id="TrafficPotential" Title="Potential" Converter="Double" HelpText="Traffic potential"/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ResearchOrganicGetListSeoVisibilityHistoric" Title="Organic Visibility Historic" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ResearchOrganicGetListSeoVisibilityHistoric" HelpText="Searchmetrics SEO Visibility for a given URL in a given country in a given timeframe.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="seotoolsforexcel.com" Required="true" HelpText="Either a domain or a subdomain."/>
      <Resource Id="SelectCountry"/>
      <DateInterval Id="DateInterval" Title="Interval"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ResearchOrganicGetListSeoVisibilityHistoric.json?
        url=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Host)
        &countrycode=@Model.Country
        &date_from=@(Model.DateInterval.StartDate.ToString("yyyyMMdd"))
        &date_to=@(Model.DateInterval.EndDate.ToString("yyyyMMdd"))
        &access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Regex Expr="&quot;\d{8}&quot;:\d*" Group="0">
        <Regex Expr="&quot;(\d{8})&quot;:" Id="Date" Title="Date" Converter="DateTime" Converter.SourceFormat="yyyyMMdd" Group="1"/>
        <Regex Expr=":(\d*)" Id="Visibility" Title="Visibility" Converter="Int" Group="1"/>
      </Regex>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdminStatusGetValueAvailableCredits" Title="Admin Available Credits" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/AdminStatusGetValueAvailableCredits" HelpText="Returns the amount of available credits for the current period.">
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/AdminStatusGetValueAvailableCredits.json
        ?access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.response" Id="Credits" Title="Credits" Converter="Int" HelpText="Available credits."/>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdminStatusGetListProjects" Title="Projects" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/AdminStatusGetListProjects" HelpText="This call returns a complete list of all projects.">
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/AdminStatusGetListProjects.json?access_token=@(Model.Authorization)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="project_id" Id="ProjectId" Title="Project Id" Converter="Long" HelpText=""/>
        <JsonPath Expr="project_name" Id="ProjectName" Title="Project Name" Converter="String" HelpText=""/>
        <JsonPath Expr="project_url" Id="ProjectName" Title="Project Name" Converter="String" HelpText=""/>
        <JsonPath Expr="keyword_count" Id="Keywords" Title="Keywords" Converter="Long" HelpText=""/>
        <JsonPath Expr="engine_count" Id="Engines" Title="Engines" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdminStatusGetListProjectSearchEngines" Hidden="true">
    <Parameters>
      <Text Id="ProjectId" Title="Project Id" Required="true"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/AdminStatusGetListProjectSearchEngines.json
                ?access_token=@(Model.Authorization)
                &project_id=@(Model.ProjectId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="response.*">
        <JsonPath Expr="engine_id" Id="EngineId" Title="Engine Id" Converter="Long" HelpText=""/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="AdminStatusGetListProjectDomainsAndBenchmarks" Hidden="true">
    <Parameters>
      <Text Id="ProjectId" Title="Project Id" Debug.DefaultValue="1493497" Required="true" Select.Connector="AdminStatusGetListProjects" Select.IdField="ProjectId" Select.TitleField="ProjectName"/>
    </Parameters>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/AdminStatusGetListProjectDomainsAndBenchmarks.json
				?access_token=@(Model.Authorization)
				&project_id=@(Model.ProjectId)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<XPath Expr="//response/url|//response/benchmarks">
				<XPath Expr="." Id="Url" Title="URL"/>
			</XPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

  <RestConnector Id="ProjectPerformanceGetListUrlRankings" Title="Project URL Rankings" HelpUrl="http://api.searchmetrics.com/v3/documentation/api-calls/service/ProjectPerformanceGetListUrlRankings" HelpText="Get the rankings for all urls, belongs to the given project.">
    <Parameters>
      <Text Id="ProjectId" Title="Project Id" Debug.DefaultValue="" Required="true" Select.Connector="AdminStatusGetListProjects" Select.IdField="ProjectId" Select.TitleField="ProjectName"/>
      <Text Id="SearchEngineId" Title="Search Engine Id" Debug.DefaultValue="" Required="true" Select.Connector="AdminStatusGetListProjectSearchEngines" Select.IdField="EngineId" Select.TitleField="EngineId"/>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="" Required="true" Select.Connector="AdminStatusGetListProjectDomainsAndBenchmarks" Select.IdField="Url" Select.TitleField="Url"/>
			<Radio Id="Trend" Title="Trend Interval" DefaultValue="last">
			<DataSource>
				<Item Id="last" Title="Last Results" />
				<Item Id="weekly" Title="Last Week" />
				<Item Id="monthly" Title="Last Month" />
			</DataSource>
		</Radio>
    </Parameters>
    <Paging PageSize="100" MinTake="100" DefaultTake="100" EvenPages="false"/>
    <Prepare>
      <Connector Id="Authorization"/>
    </Prepare>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        http://api.searchmetrics.com/v3/ProjectPerformanceGetListUrlRankings.json
				?access_token=@(Model.Authorization)
				&project_id=@(Model.ProjectId)
				&se_id=@(Model.SearchEngineId)
				&url=@(Model.Domain)
				&trend_interval=@(Model.Trend)
				&limit=100
				@if(Model.PageCursor.Page != 0)
				{
					@: &offset=@(Model.PageCursor.Page*100)
				}
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
			<XPath Expr="//response//keywords">
				<XPath Expr="../url" Id="Url" Title="URL"/>
				<XPath Expr="./keyword" Id="Keyword" Title="Keyword"/>
				<XPath Expr="./position" Id="Position" Title="Position" Converter="Long"/>
				<XPath Expr="./traffic_volume" Id="Volume" Title="Volume" Converter="Long"/>
				<XPath Expr="./traffic" Id="Traffic" Title="Traffic" Converter="Long"/>
				<XPath Expr="./cpc" Id="CPC" Title="CPC" Converter="Long"/>
				<XPath Expr="./trend/trend" Id="Trend" Title="Trend" Converter="Long"/>
				<XPath Expr="./trend/abs" Id="Abs" Title="Trend Absolute Change" Converter="Double"/>
				<XPath Expr="./trend/per" Id="Per" Title="Trend Relative Change" Converter="Double"/>
			</XPath>
    </Parse>
    <Fail>
      <JsonPath Expr="error_message"/>
    </Fail>
  </RestConnector>

</Suite>
