<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="Twingly" Id="Twingly" Category="Social" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Twingly.xml" HelpUrl="http://links.seotoolsforexcel.com/twingly/" HelpText="Documentation">

  <Settings HelpText="What's this?" HelpUrl="">
    <Text Id="ApiKey" Title="ApiKey" Required="true" HelpUrl="http://links.seotoolsforexcel.com/twingly/"/>
  </Settings>

  <Resources>
		<Resource Id="Sortings">
			<Item Id="published%20sort-order:desc" Title="Published Descending"/>
			<Item Id="published%20sort-order:asc" Title="Published Ascending"/>
			<Item Id="inlinks%20sort-order:desc" Title="Inbound Links Descending"/>
			<Item Id="inlinks%20sort-order:asc" Title="Inbound Links Ascending"/>
			<Item Id="twinglyrank%20sort-order:desc" Title="Twingly Rank Descending"/>
			<Item Id="twinglyrank%20sort-order:asc" Title="Twingly Rank Ascending"/>
	  </Resource>
    <Resource Id="Languages">
			<Item Id="all" Title="All"/>
			<Item Id="af" Title="Afrikaans"/>
			<Item Id="sq" Title="Albanian"/>
			<Item Id="ar" Title="Arabic"/>
			<Item Id="bn" Title="Bengali"/>
			<Item Id="bg" Title="Bulgarian"/>
			<Item Id="ca" Title="Catalan"/>
			<Item Id="zh" Title="Chinese"/>
			<Item Id="hr" Title="Croatian"/>
			<Item Id="cs" Title="Czech"/>
			<Item Id="da" Title="Danish"/>
			<Item Id="nl" Title="Dutch"/>
			<Item Id="en" Title="English"/>
			<Item Id="et" Title="Estonian"/>
			<Item Id="fi" Title="Finnish"/>
			<Item Id="fr" Title="French"/>
			<Item Id="ka" Title="Georgian"/>
			<Item Id="de" Title="German"/>
			<Item Id="el" Title="Greek"/>
			<Item Id="gu" Title="Gujarati"/>
			<Item Id="he" Title="Hebrew"/>
			<Item Id="hi" Title="Hindi"/>
			<Item Id="hu" Title="Hungarian"/>
			<Item Id="is" Title="Icelandic"/>
			<Item Id="id" Title="Indonesian"/>
			<Item Id="it" Title="Italian"/>
			<Item Id="ja" Title="Japanese"/>
			<Item Id="kn" Title="Kannada"/>
			<Item Id="ko" Title="Korean"/>
			<Item Id="lt" Title="Lithuanian"/>
			<Item Id="mk" Title="Macedonian"/>
			<Item Id="ml" Title="Malayalam"/>
			<Item Id="mr" Title="Marathi"/>
			<Item Id="ne" Title="Nepali"/>
			<Item Id="no" Title="Norwegian"/>
			<Item Id="fa" Title="Persian"/>
			<Item Id="pl" Title="Polish"/>
			<Item Id="pt" Title="Portuguese"/>
			<Item Id="pa" Title="Punjabi"/>
			<Item Id="ro" Title="Romanian"/>
			<Item Id="ru" Title="Russian"/>
			<Item Id="sr" Title="Serbian"/>
			<Item Id="sk" Title="Slovak"/>
			<Item Id="sl" Title="Slovenian"/>
			<Item Id="so" Title="Somali"/>
			<Item Id="es" Title="Spanish"/>
			<Item Id="sw" Title="Swahili"/>
			<Item Id="sv" Title="Swedish"/>
			<Item Id="tl" Title="Tagalog"/>
			<Item Id="ta" Title="Tamil"/>
			<Item Id="te" Title="Telugu"/>
			<Item Id="th" Title="Thai"/>
			<Item Id="tr" Title="Turkish"/>
			<Item Id="uk" Title="Ukrainian"/>
			<Item Id="ur" Title="Urdu"/>
			<Item Id="vi" Title="Vietnamese"/>
			<Item Id="cy" Title="Welsh"/>
    </Resource>
    <Resource Id="Countries">
			<Item Id="all" Title="All"/>
			<Item Id="af" Title="Afghanistan"/>
			<Item Id="ax" Title="Aland Islands"/>
			<Item Id="al" Title="Albania"/>
			<Item Id="dz" Title="Algeria"/>
			<Item Id="as" Title="American Samoa"/>
			<Item Id="ad" Title="Andorra"/>
			<Item Id="ao" Title="Angola"/>
			<Item Id="ai" Title="Anguilla"/>
			<Item Id="aq" Title="Antarctica"/>
			<Item Id="ag" Title="Antigua and Barbuda"/>
			<Item Id="ar" Title="Argentina"/>
			<Item Id="am" Title="Armenia"/>
			<Item Id="aw" Title="Aruba"/>
			<Item Id="au" Title="Australia"/>
			<Item Id="at" Title="Austria"/>
			<Item Id="az" Title="Azerbaijan"/>
			<Item Id="bs" Title="Bahamas"/>
			<Item Id="bh" Title="Bahrain"/>
			<Item Id="bd" Title="Bangladesh"/>
			<Item Id="bb" Title="Barbados"/>
			<Item Id="by" Title="Belarus"/>
			<Item Id="be" Title="Belgium"/>
			<Item Id="bz" Title="Belize"/>
			<Item Id="bj" Title="Benin"/>
			<Item Id="bm" Title="Bermuda"/>
			<Item Id="bt" Title="Bhutan"/>
			<Item Id="bo" Title="Bolivia"/>
			<Item Id="bq" Title="Bonaire"/>
			<Item Id="ba" Title="Bosnia and Herzegovina"/>
			<Item Id="bw" Title="Botswana"/>
			<Item Id="bv" Title="Bouvet Island"/>
			<Item Id="br" Title="Brazil"/>
			<Item Id="io" Title="British Indian Ocean Territory"/>
			<Item Id="vg" Title="British Virgin Islands"/>
			<Item Id="bn" Title="Brunei Darussalam"/>
			<Item Id="bg" Title="Bulgaria"/>
			<Item Id="bf" Title="Burkina Faso"/>
			<Item Id="bi" Title="Burundi"/>
			<Item Id="kh" Title="Cambodia"/>
			<Item Id="cm" Title="Cameroon"/>
			<Item Id="ca" Title="Canada"/>
			<Item Id="cv" Title="Cape Verde"/>
			<Item Id="ky" Title="Cayman Islands"/>
			<Item Id="cf" Title="Central African Republic"/>
			<Item Id="td" Title="Chad"/>
			<Item Id="cl" Title="Chile"/>
			<Item Id="cn" Title="China"/>
			<Item Id="cx" Title="Christmas Island"/>
			<Item Id="cc" Title="Cocos"/>
			<Item Id="co" Title="Colombia"/>
			<Item Id="km" Title="Comoros"/>
			<Item Id="cg" Title="Congo"/>
			<Item Id="ck" Title="Cook Islands"/>
			<Item Id="cr" Title="Costa Rica"/>
			<Item Id="hr" Title="Croatia"/>
			<Item Id="cu" Title="Cuba"/>
			<Item Id="cw" Title="Curacao"/>
			<Item Id="cy" Title="Cyprus"/>
			<Item Id="cz" Title="Czech Republic"/>
			<Item Id="kp" Title="Democratic Peoples Republic of Korea"/>
			<Item Id="cd" Title="Democratic Republic of Congo"/>
			<Item Id="dk" Title="Denmark"/>
			<Item Id="dj" Title="Djibouti"/>
			<Item Id="dm" Title="Dominica"/>
			<Item Id="do" Title="Dominican Republic"/>
			<Item Id="ec" Title="Ecuador"/>
			<Item Id="eg" Title="Egypt"/>
			<Item Id="sv" Title="ElSalvador"/>
			<Item Id="gq" Title="Equatorial Guinea"/>
			<Item Id="er" Title="Eritrea"/>
			<Item Id="ee" Title="Estonia"/>
			<Item Id="et" Title="Ethiopia"/>
			<Item Id="fk" Title="Falkland Islands"/>
			<Item Id="fo" Title="Faroe Islands"/>
			<Item Id="fj" Title="Fiji"/>
			<Item Id="fi" Title="Finland"/>
			<Item Id="fr" Title="France"/>
			<Item Id="gf" Title="French Guiana"/>
			<Item Id="pf" Title="French Polynesia"/>
			<Item Id="tf" Title="French Southern Territories"/>
			<Item Id="ga" Title="Gabon"/>
			<Item Id="gm" Title="Gambia"/>
			<Item Id="ge" Title="Georgia"/>
			<Item Id="de" Title="Germany"/>
			<Item Id="gh" Title="Ghana"/>
			<Item Id="gi" Title="Gibraltar"/>
			<Item Id="gr" Title="Greece"/>
			<Item Id="gl" Title="Greenland"/>
			<Item Id="gd" Title="Grenada"/>
			<Item Id="gp" Title="Guadeloupe"/>
			<Item Id="gu" Title="Guam"/>
			<Item Id="gt" Title="Guatemala"/>
			<Item Id="gg" Title="Guernsey"/>
			<Item Id="gw" Title="Guinea Bissau"/>
			<Item Id="gn" Title="Guinea"/>
			<Item Id="gy" Title="Guyana"/>
			<Item Id="ht" Title="Haiti"/>
			<Item Id="hm" Title="Heard Island and Mcdonald Islands"/>
			<Item Id="va" Title="Holy See"/>
			<Item Id="hn" Title="Honduras"/>
			<Item Id="hk" Title="Hong Kong"/>
			<Item Id="hu" Title="Hungary"/>
			<Item Id="is" Title="Iceland"/>
			<Item Id="in" Title="India"/>
			<Item Id="id" Title="Indonesia"/>
			<Item Id="ir" Title="Iran"/>
			<Item Id="iq" Title="Iraq"/>
			<Item Id="ie" Title="Ireland"/>
			<Item Id="im" Title="Isle of Man"/>
			<Item Id="il" Title="Israel"/>
			<Item Id="it" Title="Italy"/>
			<Item Id="ci" Title="Ivory Coast"/>
			<Item Id="jm" Title="Jamaica"/>
			<Item Id="jp" Title="Japan"/>
			<Item Id="je" Title="Jersey"/>
			<Item Id="jo" Title="Jordan"/>
			<Item Id="kz" Title="Kazakhstan"/>
			<Item Id="ke" Title="Kenya"/>
			<Item Id="ki" Title="Kiribati"/>
			<Item Id="kw" Title="Kuwait"/>
			<Item Id="kg" Title="Kyrgyzstan"/>
			<Item Id="la" Title="Lao Peoples Democratic Republic"/>
			<Item Id="lv" Title="Latvia"/>
			<Item Id="lb" Title="Lebanon"/>
			<Item Id="ls" Title="Lesotho"/>
			<Item Id="lr" Title="Liberia"/>
			<Item Id="ly" Title="Libya"/>
			<Item Id="li" Title="Liechtenstein"/>
			<Item Id="lt" Title="Lithuania"/>
			<Item Id="lu" Title="Luxembourg"/>
			<Item Id="mo" Title="Macao"/>
			<Item Id="mk" Title="Macedonia"/>
			<Item Id="mg" Title="Madagascar"/>
			<Item Id="mw" Title="Malawi"/>
			<Item Id="my" Title="Malaysia"/>
			<Item Id="mv" Title="Maldives"/>
			<Item Id="ml" Title="Mali"/>
			<Item Id="mt" Title="Malta"/>
			<Item Id="mh" Title="Marshall Islands"/>
			<Item Id="mq" Title="Martinique"/>
			<Item Id="mr" Title="Mauritania"/>
			<Item Id="mu" Title="Mauritius"/>
			<Item Id="yt" Title="Mayotte"/>
			<Item Id="mx" Title="Mexico"/>
			<Item Id="fm" Title="Micronesia"/>
			<Item Id="md" Title="Moldova"/>
			<Item Id="mc" Title="Monaco"/>
			<Item Id="mn" Title="Mongolia"/>
			<Item Id="me" Title="Montenegro"/>
			<Item Id="ms" Title="Montserrat"/>
			<Item Id="ma" Title="Morocco"/>
			<Item Id="mz" Title="Mozambique"/>
			<Item Id="mm" Title="Myanmar"/>
			<Item Id="na" Title="Namibia"/>
			<Item Id="nr" Title="Nauru"/>
			<Item Id="np" Title="Nepal"/>
			<Item Id="nl" Title="Netherlands"/>
			<Item Id="nc" Title="New Caledonia"/>
			<Item Id="nz" Title="New Zealand"/>
			<Item Id="ni" Title="Nicaragua"/>
			<Item Id="ne" Title="Niger"/>
			<Item Id="ng" Title="Nigeria"/>
			<Item Id="nu" Title="Niue"/>
			<Item Id="nf" Title="Norfolk Island"/>
			<Item Id="mp" Title="Northern Mariana Islands"/>
			<Item Id="no" Title="Norway"/>
			<Item Id="om" Title="Oman"/>
			<Item Id="pk" Title="Pakistan"/>
			<Item Id="pw" Title="Palau"/>
			<Item Id="ps" Title="Palestine"/>
			<Item Id="pa" Title="Panama"/>
			<Item Id="pg" Title="PapuaNewGuinea"/>
			<Item Id="py" Title="Paraguay"/>
			<Item Id="pe" Title="Peru"/>
			<Item Id="ph" Title="Philippines"/>
			<Item Id="pn" Title="Pitcairn"/>
			<Item Id="pl" Title="Poland"/>
			<Item Id="pt" Title="Portugal"/>
			<Item Id="pr" Title="PuertoRico"/>
			<Item Id="qa" Title="Qatar"/>
			<Item Id="kr" Title="Republic of Korea"/>
			<Item Id="re" Title="Reunion"/>
			<Item Id="ro" Title="Romania"/>
			<Item Id="ru" Title="Russian Federation"/>
			<Item Id="rw" Title="Rwanda"/>
			<Item Id="bl" Title="Saint Barth"/>
			<Item Id="sh" Title="Saint Helena"/>
			<Item Id="kn" Title="Saint Kitts and Nevis"/>
			<Item Id="lc" Title="Saint Lucia"/>
			<Item Id="mf" Title="Saint Martin"/>
			<Item Id="pm" Title="Saint Pierre and Miquelon"/>
			<Item Id="vc" Title="Saint Vincent and the Grenadines"/>
			<Item Id="ws" Title="Samoa"/>
			<Item Id="sm" Title="SanMarino"/>
			<Item Id="st" Title="Sao Tome and Principe"/>
			<Item Id="sa" Title="Saudi Arabia"/>
			<Item Id="sn" Title="Senegal"/>
			<Item Id="rs" Title="Serbia"/>
			<Item Id="sc" Title="Seychelles"/>
			<Item Id="sl" Title="Sierra Leone"/>
			<Item Id="sg" Title="Singapore"/>
			<Item Id="sx" Title="Sint Maarten"/>
			<Item Id="sk" Title="Slovakia"/>
			<Item Id="si" Title="Slovenia"/>
			<Item Id="sb" Title="Solomon Islands"/>
			<Item Id="so" Title="Somalia"/>
			<Item Id="za" Title="South Africa"/>
			<Item Id="gs" Title="South Georgia and the South Sandwich Islands"/>
			<Item Id="ss" Title="SouthSudan"/>
			<Item Id="es" Title="Spain"/>
			<Item Id="lk" Title="Sri Lanka"/>
			<Item Id="sd" Title="Sudan"/>
			<Item Id="sr" Title="Suriname"/>
			<Item Id="sj" Title="Svalbard and Jan Mayen"/>
			<Item Id="sz" Title="Swaziland"/>
			<Item Id="se" Title="Sweden"/>
			<Item Id="ch" Title="Switzerland"/>
			<Item Id="sy" Title="Syrian Arab Republic"/>
			<Item Id="tw" Title="Taiwan"/>
			<Item Id="tj" Title="Tajikistan"/>
			<Item Id="tz" Title="Tanzania"/>
			<Item Id="th" Title="Thailand"/>
			<Item Id="tl" Title="Timor"/>
			<Item Id="tg" Title="Togo"/>
			<Item Id="tk" Title="Tokelau"/>
			<Item Id="to" Title="Tonga"/>
			<Item Id="tt" Title="Trinidad and Tobago"/>
			<Item Id="tn" Title="Tunisia"/>
			<Item Id="tr" Title="Turkey"/>
			<Item Id="tm" Title="Turkmenistan"/>
			<Item Id="tc" Title="Turks and Caicos Islands"/>
			<Item Id="tv" Title="Tuvalu"/>
			<Item Id="ug" Title="Uganda"/>
			<Item Id="ua" Title="Ukraine"/>
			<Item Id="ae" Title="United Arab Emirates"/>
			<Item Id="gb" Title="United Kingdom"/>
			<Item Id="um" Title="United States Minor Outlying Islands"/>
			<Item Id="us" Title="United States"/>
			<Item Id="uy" Title="Uruguay"/>
			<Item Id="vi" Title="US Virgin Islands"/>
			<Item Id="uz" Title="Uzbekistan"/>
			<Item Id="vu" Title="Vanuatu"/>
			<Item Id="ve" Title="Venezuela"/>
			<Item Id="vn" Title="Vietnam"/>
			<Item Id="wf" Title="Wallis and Futuna"/>
			<Item Id="eh" Title="Western Sahara"/>
			<Item Id="ye" Title="Yemen"/>
			<Item Id="zm" Title="Zambia"/>
			<Item Id="zw" Title="Zimbabwe"/>
    </Resource>
	</Resources>

  <RestConnector Id="Twingly" HelpUrl="https://developer.twingly.com/resources/search/">
    <Parameters>
      <Text Id="Query" Title="Query" Required="false" Debug.DefaultValue="almedalen" HelpText="https://developer.twingly.com/resources/search-language/"/>
      <Text Id="Domain" Title="Published on Domain" Required="false" DefaultValue=""/>
      <Text Id="PageLinking" Title="Contains Link to URL/Domain" Required="false" DefaultValue=""/>
      <Text Id="Author" Title="Author" Required="false" DefaultValue=""/>
      <Text Id="Tags" Title="Contains Tag" Required="false" DefaultValue=""/>
      <Select Id="Country" Title="Country" Required="false" DefaultValue="all">
        <DataSource>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>
      <Select Id="Language" Title="Language" Required="false" DefaultValue="sv">
        <DataSource>
          <Resource Id="Languages"/>
        </DataSource>
      </Select>
      <DateInterval Id="DateInterval" Title="Date Interval" Required="true" Nullable="true"/>
      <Select Id="Sort" Title="Sort" DefaultValue="published%20sort-order:desc" Required="false">
        <DataSource>
          <Resource Id="Sortings"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <XPath Id="AvaliableRows" Expr="twinglydata" Attribute="numberOfMatchesTotal" Converter="Int"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
			https://api.twingly.com/blog/search/api/v3/search?apikey=@(Model.ApiKey)
			&q=
       @if(!string.IsNullOrEmpty(Model.Domain))
			{
				@: site:@Utils.UrlEncode(Model.Domain)
				@: %20
			}
       @if(!string.IsNullOrEmpty(Model.PageLinking))
			{
				@: link:@Utils.UrlEncode(Model.PageLinking)
				@: %20
			}
       @if(!string.IsNullOrEmpty(Model.Tags))
			{
				@: tag:@Utils.UrlEncode(Model.Tags)
				@: %20
			}
      @if(!string.IsNullOrEmpty(Model.Author))
			{
				@: tag:@Utils.UrlEncode(Model.Author)
				@: %20
			}
			@if(Model.DateInterval.StartDate != null && Model.DateInterval.EndDate != null)
			{
				@: start-date:%22 @Utils.UrlEncode(((DateTime)Model.DateInterval.StartDate).ToString("yyyy-MM-dd"))%2000:00:00%22
				@: %20end-date:%22 @Utils.UrlEncode(((DateTime)Model.DateInterval.EndDate).ToString("yyyy-MM-dd"))%2023:59:59%22
				@: %20
			}			
			@Utils.UrlEncode(Model.Query)%20
			@if(Model.Country != "all")
			{
				@: location:@(Model.Country)
				@: %20
			}
			@if(Model.Language != "all")
			{
				@: lang:@(Model.Language)
				@: %20
			}
      page:@(Model.PageCursor.Page+1)%20page-size:@(Model.PageCursor.PageSize)%20
      sort:@(Model.Sort)
			&format=xml
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <XPath Expr="//post">
				<XPath Title="URL" Id="Url" Expr="url" Converter="String"/>
				<XPath Title="Date" Id="Date" Expr="publishedat" Converter="DateTime"/>
				<XPath Title="Title" Id="Title" Expr="title" Converter="String"/>
        <Compute Id="Summary" Title="Summary">
          <Compute.Expr>
            <![CDATA[
            @{
              var InputString = Model.Summary;
              if(InputString.Length > 7500)
              {
                InputString = InputString.Substring(0, 7500);
              }
            }
            @InputString
            ]]>
          </Compute.Expr>
					<XPath Title="Summary" Id="Summary" Expr="text" Converter="String"/>
        </Compute>
				<XPath Title="Language" Id="Language" Expr="languagecode" Converter="String"/>
				<XPath Title="Location" Id="Location" Expr="locationcode" Converter="String"/>				
				<XPath Title="Blog URL" Id="BlogUrl" Expr="blogurl" Converter="String"/>
				<XPath Title="Blog Name" Id="BlogName" Expr="blogname" Converter="String"/>
				<XPath Title="Blog Author" Id="BlogAuthor" Expr="author" Converter="String"/>
				<XPath Title="Inlinks" Id="InboundLinks" Expr="inlinkscount" Converter="Int"/>
				<XPath Title="BlogRank" Id="BlogRank" Expr="blogrank" Converter="Int"/>
				<XPath Title="Inbounds" Id="Authority" Expr="authority" Converter="Int"/>
			</XPath>
    </Parse>
  </RestConnector>

</Suite>