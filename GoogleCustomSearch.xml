<?xml version="1.0" encoding="utf-8" ?>
<Suite RequireVersion="7.0" Title="Google Custom Search" Id="GoogleCustomSearch" Category="SEO" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/GoogleCustomSearch.xml" HelpUrl="http://seotoolsforexcel.com/google-custom-search/" HelpText="Documentation">

  <Author Name="Victor" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Resources>
    <Resource Id="Countries">
			<Item Id="all" Title="All"/>
			<Item Id="countryAF" Title="Afghanistan"/>
			<Item Id="countryAL" Title="Albania"/>
			<Item Id="countryDZ" Title="Algeria"/>
			<Item Id="countryAS" Title="American Samoa"/>
			<Item Id="countryAD" Title="Andorra"/>
			<Item Id="countryAO" Title="Angola"/>
			<Item Id="countryAI" Title="Anguilla"/>
			<Item Id="countryAQ" Title="Antarctica"/>
			<Item Id="countryAG" Title="Antigua and Barbuda"/>
			<Item Id="countryAR" Title="Argentina"/>
			<Item Id="countryAM" Title="Armenia"/>
			<Item Id="countryAW" Title="Aruba"/>
			<Item Id="countryAU" Title="Australia"/>
			<Item Id="countryAT" Title="Austria"/>
			<Item Id="countryAZ" Title="Azerbaijan"/>
			<Item Id="countryBS" Title="Bahamas"/>
			<Item Id="countryBH" Title="Bahrain"/>
			<Item Id="countryBD" Title="Bangladesh"/>
			<Item Id="countryBB" Title="Barbados"/>
			<Item Id="countryBY" Title="Belarus"/>
			<Item Id="countryBE" Title="Belgium"/>
			<Item Id="countryBZ" Title="Belize"/>
			<Item Id="countryBJ" Title="Benin"/>
			<Item Id="countryBM" Title="Bermuda"/>
			<Item Id="countryBT" Title="Bhutan"/>
			<Item Id="countryBO" Title="Bolivia"/>
			<Item Id="countryBA" Title="Bosnia and Herzegovina"/>
			<Item Id="countryBW" Title="Botswana"/>
			<Item Id="countryBV" Title="Bouvet Island"/>
			<Item Id="countryBR" Title="Brazil"/>
			<Item Id="countryIO" Title="British Indian Ocean Territory"/>
			<Item Id="countryBN" Title="Brunei Darussalam"/>
			<Item Id="countryBG" Title="Bulgaria"/>
			<Item Id="countryBF" Title="Burkina Faso"/>
			<Item Id="countryBI" Title="Burundi"/>
			<Item Id="countryKH" Title="Cambodia"/>
			<Item Id="countryCM" Title="Cameroon"/>
			<Item Id="countryCA" Title="Canada"/>
			<Item Id="countryCV" Title="Cape Verde"/>
			<Item Id="countryKY" Title="Cayman Islands"/>
			<Item Id="countryCF" Title="Central African Republic"/>
			<Item Id="countryTD" Title="Chad"/>
			<Item Id="countryCL" Title="Chile"/>
			<Item Id="countryCN" Title="China"/>
			<Item Id="countryCX" Title="Christmas Island"/>
			<Item Id="countryCC" Title="Cocos (Keeling) Islands"/>
			<Item Id="countryCO" Title="Colombia"/>
			<Item Id="countryKM" Title="Comoros"/>
			<Item Id="countryCG" Title="Congo"/>
			<Item Id="countryCD" Title="Congo, the Democratic Republic of the"/>
			<Item Id="countryCK" Title="Cook Islands"/>
			<Item Id="countryCR" Title="Costa Rica"/>
			<Item Id="countryCI" Title="Cote D'ivoire"/>
			<Item Id="countryHR" Title="Croatia (Hrvatska)"/>
			<Item Id="countryCU" Title="Cuba"/>
			<Item Id="countryCY" Title="Cyprus"/>
			<Item Id="countryCZ" Title="Czech Republic"/>
			<Item Id="countryDK" Title="Denmark"/>
			<Item Id="countryDJ" Title="Djibouti"/>
			<Item Id="countryDM" Title="Dominica"/>
			<Item Id="countryDO" Title="Dominican Republic"/>
			<Item Id="countryTP" Title="East Timor"/>
			<Item Id="countryEC" Title="Ecuador"/>
			<Item Id="countryEG" Title="Egypt"/>
			<Item Id="countrySV" Title="El Salvador"/>
			<Item Id="countryGQ" Title="Equatorial Guinea"/>
			<Item Id="countryER" Title="Eritrea"/>
			<Item Id="countryEE" Title="Estonia"/>
			<Item Id="countryET" Title="Ethiopia"/>
			<Item Id="countryEU" Title="European Union"/>
			<Item Id="countryFK" Title="Falkland Islands (Malvinas)"/>
			<Item Id="countryFO" Title="Faroe Islands"/>
			<Item Id="countryFJ" Title="Fiji"/>
			<Item Id="countryFI" Title="Finland"/>
			<Item Id="countryFR" Title="France"/>
			<Item Id="countryFX" Title="France, Metropolitan"/>
			<Item Id="countryGF" Title="French Guiana"/>
			<Item Id="countryPF" Title="French Polynesia"/>
			<Item Id="countryTF" Title="French Southern Territories"/>
			<Item Id="countryGA" Title="Gabon"/>
			<Item Id="countryGM" Title="Gambia"/>
			<Item Id="countryGE" Title="Georgia"/>
			<Item Id="countryDE" Title="Germany"/>
			<Item Id="countryGH" Title="Ghana"/>
			<Item Id="countryGI" Title="Gibraltar"/>
			<Item Id="countryGR" Title="Greece"/>
			<Item Id="countryGL" Title="Greenland"/>
			<Item Id="countryGD" Title="Grenada"/>
			<Item Id="countryGP" Title="Guadeloupe"/>
			<Item Id="countryGU" Title="Guam"/>
			<Item Id="countryGT" Title="Guatemala"/>
			<Item Id="countryGN" Title="Guinea"/>
			<Item Id="countryGW" Title="Guinea-Bissau"/>
			<Item Id="countryGY" Title="Guyana"/>
			<Item Id="countryHT" Title="Haiti"/>
			<Item Id="countryHM" Title="Heard Island and Mcdonald Islands"/>
			<Item Id="countryVA" Title="Holy See (Vatican City State)"/>
			<Item Id="countryHN" Title="Honduras"/>
			<Item Id="countryHK" Title="Hong Kong"/>
			<Item Id="countryHU" Title="Hungary"/>
			<Item Id="countryIS" Title="Iceland"/>
			<Item Id="countryIN" Title="India"/>
			<Item Id="countryID" Title="Indonesia"/>
			<Item Id="countryIR" Title="Iran, Islamic Republic of"/>
			<Item Id="countryIQ" Title="Iraq"/>
			<Item Id="countryIE" Title="Ireland"/>
			<Item Id="countryIL" Title="Israel"/>
			<Item Id="countryIT" Title="Italy"/>
			<Item Id="countryJM" Title="Jamaica"/>
			<Item Id="countryJP" Title="Japan"/>
			<Item Id="countryJO" Title="Jordan"/>
			<Item Id="countryKZ" Title="Kazakhstan"/>
			<Item Id="countryKE" Title="Kenya"/>
			<Item Id="countryKI" Title="Kiribati"/>
			<Item Id="countryKP" Title="Korea, Democratic People's Republic of"/>
			<Item Id="countryKR" Title="Korea, Republic of"/>
			<Item Id="countryKW" Title="Kuwait"/>
			<Item Id="countryKG" Title="Kyrgyzstan"/>
			<Item Id="countryLA" Title="Lao People's Democratic Republic"/>
			<Item Id="countryLV" Title="Latvia"/>
			<Item Id="countryLB" Title="Lebanon"/>
			<Item Id="countryLS" Title="Lesotho"/>
			<Item Id="countryLR" Title="Liberia"/>
			<Item Id="countryLY" Title="Libyan Arab Jamahiriya"/>
			<Item Id="countryLI" Title="Liechtenstein"/>
			<Item Id="countryLT" Title="Lithuania"/>
			<Item Id="countryLU" Title="Luxembourg"/>
			<Item Id="countryMO" Title="Macao"/>
			<Item Id="countryMK" Title="Macedonia, the Former Yugosalv Republic of"/>
			<Item Id="countryMG" Title="Madagascar"/>
			<Item Id="countryMW" Title="Malawi"/>
			<Item Id="countryMY" Title="Malaysia"/>
			<Item Id="countryMV" Title="Maldives"/>
			<Item Id="countryML" Title="Mali"/>
			<Item Id="countryMT" Title="Malta"/>
			<Item Id="countryMH" Title="Marshall Islands"/>
			<Item Id="countryMQ" Title="Martinique"/>
			<Item Id="countryMR" Title="Mauritania"/>
			<Item Id="countryMU" Title="Mauritius"/>
			<Item Id="countryYT" Title="Mayotte"/>
			<Item Id="countryMX" Title="Mexico"/>
			<Item Id="countryFM" Title="Micronesia, Federated States of"/>
			<Item Id="countryMD" Title="Moldova, Republic of"/>
			<Item Id="countryMC" Title="Monaco"/>
			<Item Id="countryMN" Title="Mongolia"/>
			<Item Id="countryMS" Title="Montserrat"/>
			<Item Id="countryMA" Title="Morocco"/>
			<Item Id="countryMZ" Title="Mozambique"/>
			<Item Id="countryMM" Title="Myanmar"/>
			<Item Id="countryNA" Title="Namibia"/>
			<Item Id="countryNR" Title="Nauru"/>
			<Item Id="countryNP" Title="Nepal"/>
			<Item Id="countryNL" Title="Netherlands"/>
			<Item Id="countryAN" Title="Netherlands Antilles"/>
			<Item Id="countryNC" Title="New Caledonia"/>
			<Item Id="countryNZ" Title="New Zealand"/>
			<Item Id="countryNI" Title="Nicaragua"/>
			<Item Id="countryNE" Title="Niger"/>
			<Item Id="countryNG" Title="Nigeria"/>
			<Item Id="countryNU" Title="Niue"/>
			<Item Id="countryNF" Title="Norfolk Island"/>
			<Item Id="countryMP" Title="Northern Mariana Islands"/>
			<Item Id="countryNO" Title="Norway"/>
			<Item Id="countryOM" Title="Oman"/>
			<Item Id="countryPK" Title="Pakistan"/>
			<Item Id="countryPW" Title="Palau"/>
			<Item Id="countryPS" Title="Palestinian Territory"/>
			<Item Id="countryPA" Title="Panama"/>
			<Item Id="countryPG" Title="Papua New Guinea"/>
			<Item Id="countryPY" Title="Paraguay"/>
			<Item Id="countryPE" Title="Peru"/>
			<Item Id="countryPH" Title="Philippines"/>
			<Item Id="countryPN" Title="Pitcairn"/>
			<Item Id="countryPL" Title="Poland"/>
			<Item Id="countryPT" Title="Portugal"/>
			<Item Id="countryPR" Title="Puerto Rico"/>
			<Item Id="countryQA" Title="Qatar"/>
			<Item Id="countryRE" Title="Reunion"/>
			<Item Id="countryRO" Title="Romania"/>
			<Item Id="countryRU" Title="Russian Federation"/>
			<Item Id="countryRW" Title="Rwanda"/>
			<Item Id="countrySH" Title="Saint Helena"/>
			<Item Id="countryKN" Title="Saint Kitts and Nevis"/>
			<Item Id="countryLC" Title="Saint Lucia"/>
			<Item Id="countryPM" Title="Saint Pierre and Miquelon"/>
			<Item Id="countryVC" Title="Saint Vincent and the Grenadines"/>
			<Item Id="countryWS" Title="Samoa"/>
			<Item Id="countrySM" Title="San Marino"/>
			<Item Id="countryST" Title="Sao Tome and Principe"/>
			<Item Id="countrySA" Title="Saudi Arabia"/>
			<Item Id="countrySN" Title="Senegal"/>
			<Item Id="countryCS" Title="Serbia and Montenegro"/>
			<Item Id="countrySC" Title="Seychelles"/>
			<Item Id="countrySL" Title="Sierra Leone"/>
			<Item Id="countrySG" Title="Singapore"/>
			<Item Id="countrySK" Title="Slovakia"/>
			<Item Id="countrySI" Title="Slovenia"/>
			<Item Id="countrySB" Title="Solomon Islands"/>
			<Item Id="countrySO" Title="Somalia"/>
			<Item Id="countryZA" Title="South Africa"/>
			<Item Id="countryGS" Title="South Georgia and the South Sandwich Islands"/>
			<Item Id="countryES" Title="Spain"/>
			<Item Id="countryLK" Title="Sri Lanka"/>
			<Item Id="countrySD" Title="Sudan"/>
			<Item Id="countrySR" Title="Suriname"/>
			<Item Id="countrySJ" Title="Svalbard and Jan Mayen"/>
			<Item Id="countrySZ" Title="Swaziland"/>
			<Item Id="countrySE" Title="Sweden"/>
			<Item Id="countryCH" Title="Switzerland"/>
			<Item Id="countrySY" Title="Syrian Arab Republic"/>
			<Item Id="countryTW" Title="Taiwan, Province of China"/>
			<Item Id="countryTJ" Title="Tajikistan"/>
			<Item Id="countryTZ" Title="Tanzania, United Republic of"/>
			<Item Id="countryTH" Title="Thailand"/>
			<Item Id="countryTG" Title="Togo"/>
			<Item Id="countryTK" Title="Tokelau"/>
			<Item Id="countryTO" Title="Tonga"/>
			<Item Id="countryTT" Title="Trinidad and Tobago"/>
			<Item Id="countryTN" Title="Tunisia"/>
			<Item Id="countryTR" Title="Turkey"/>
			<Item Id="countryTM" Title="Turkmenistan"/>
			<Item Id="countryTC" Title="Turks and Caicos Islands"/>
			<Item Id="countryTV" Title="Tuvalu"/>
			<Item Id="countryUG" Title="Uganda"/>
			<Item Id="countryUA" Title="Ukraine"/>
			<Item Id="countryAE" Title="United Arab Emirates"/>
			<Item Id="countryUK" Title="United Kingdom"/>
			<Item Id="countryUS" Title="United States"/>
			<Item Id="countryUM" Title="United States Minor Outlying Islands"/>
			<Item Id="countryUY" Title="Uruguay"/>
			<Item Id="countryUZ" Title="Uzbekistan"/>
			<Item Id="countryVU" Title="Vanuatu"/>
			<Item Id="countryVE" Title="Venezuela"/>
			<Item Id="countryVN" Title="Vietnam"/>
			<Item Id="countryVG" Title="Virgin Islands, British"/>
			<Item Id="countryVI" Title="Virgin Islands, U.S."/>
			<Item Id="countryWF" Title="Wallis and Futuna"/>
			<Item Id="countryEH" Title="Western Sahara"/>
			<Item Id="countryYE" Title="Yemen"/>
			<Item Id="countryYU" Title="Yugoslavia"/>
			<Item Id="countryZM" Title="Zambia"/>
			<Item Id="countryZW" Title="Zimbabwe"/>
    </Resource>
  </Resources>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/google-custom-search/">
    <Text Id="APIKey" Title="API Key" Required="true"/>
    <Text Id="EngineId" Title="Custom Seach Engine Id" Required="true"/>
  </Settings>

  <RestConnector Id="GoogleCustomSearch" Title="Google Custom Search" HelpUrl="https://developers.google.com/custom-search/json-api/v1/reference/cse/list">
    <Parameters>
      <Text Id="Query" Title="Query" Debug.DefaultValue="seo" Required="true"/>
      <Text Id="Exclude" Title="Exclude Terms" Debug.DefaultValue="" Required="false"/>
      <Text Id="ContainsLink" Title="Contains Link To" Debug.DefaultValue="" Required="false"/>
      <Select Id="Country" Title="Country" Required="false" DefaultValue="all">
        <DataSource>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="10">
      <Parse>
        <JsonPath Id="AvaliableRows" Expr="$.queries.request..totalResults"/>
      </Parse>
    </Paging>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://www.googleapis.com/customsearch/v1
				?key=@(Model.APIKey)
				&cx=@(Model.EngineId)
				&q=@Utils.UrlEncode(Model.Query)
				@if(Model.Country != "all")
				{
					@: &cr=@(Model.Country)
				}
        @if(!string.IsNullOrEmpty(Model.Exclude))
        {
          @: &excludeTerms=@Utils.UrlEncode(Model.Exclude)
        }
        @if(!string.IsNullOrEmpty(Model.ContainsLink))
        {
          @: &linkSite=@Utils.UrlEncode(Model.ContainsLink)
        }
				&num=@(Model.PageCursor.NextTake)
				&start=@(Model.PageCursor.NextSkip+1)
				]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.items[*]">
        <JsonPath Expr="link" Id="Link" Title="Link" Converter="String"/>
        <JsonPath Expr="displayLink" Id="DisplayLink" Title="Display Link" Converter="String"/>
        <JsonPath Expr="title" Id="Title" Title="Title" Converter="String"/>
        <JsonPath Expr="snippet" Id="Snippet" Title="Snippet" Converter="String"/>
        <JsonPath Expr="pagemap.metatags[0]" Id="Metatags" Title="Meta Tags" Converter="String"/>
      </JsonPath>
    </Parse>
  </RestConnector>

</Suite>