<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" Title="Keywords Everywhere" Id="KeywordsEverywhere" RequireVersion="7.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/KeywordsEverywhere.xml" HelpUrl="http://seotoolsforexcel.com/keywords-everywhere/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/keywords-everywhere/">
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/keywords-everywhere/"/>
  </Settings>

  <Resources>
    <Resource Id="Currencies">
      <Item Id="aed" Title="UAE Dirham (AED)"/>
      <Item Id="all" Title="Albanian Lek (ALL)"/>
      <Item Id="ang" Title="Neth Antilles Guilder (NAƒ)"/>
      <Item Id="ars" Title="Argentine Peso ($)"/>
      <Item Id="aud" Title="Australian Dollar ($)"/>
      <Item Id="awg" Title="Aruba Florin (ƒ)"/>
      <Item Id="bbd" Title="Barbados Dollar (BBD)"/>
      <Item Id="bdt" Title="Bangladesh Taka (Tk)"/>
      <Item Id="bgn" Title="Bulgarian Lev (лв)"/>
      <Item Id="bhd" Title="Bahraini Dinar (BHD)"/>
      <Item Id="bif" Title="Burundi Franc (FBu)"/>
      <Item Id="bmd" Title="Bermuda Dollar (BD$)"/>
      <Item Id="bnd" Title="Brunei Dollar (B$)"/>
      <Item Id="bob" Title="Bolivian Boliviano (Bs)"/>
      <Item Id="brl" Title="Brazilian Real (R$)"/>
      <Item Id="bsd" Title="Bahamian Dollar (B$)"/>
      <Item Id="btn" Title="Bhutan Ngultrum (Nu)"/>
      <Item Id="bwp" Title="Botswana Pula (P)"/>
      <Item Id="byr" Title="Belarus Ruble (Br)"/>
      <Item Id="bzd" Title="Belize Dollar (BZ$)"/>
      <Item Id="cad" Title="Canadian Dollar (C$)"/>
      <Item Id="chf" Title="Swiss Franc (CHF)"/>
      <Item Id="clp" Title="Chilean Peso ($)"/>
      <Item Id="cny" Title="Chinese Yuan (¥)"/>
      <Item Id="cop" Title="Colombian Peso ($)"/>
      <Item Id="crc" Title="Costa Rica Colon (₡)"/>
      <Item Id="cup" Title="Cuban Peso ($MN)"/>
      <Item Id="cve" Title="Cape Verde Escudo (Esc)"/>
      <Item Id="czk" Title="Czech Koruna (Kč)"/>
      <Item Id="djf" Title="Djibouti Franc (Fdj)"/>
      <Item Id="dkk" Title="Danish Krone (kr)"/>
      <Item Id="dop" Title="Dominican Peso (RD$)"/>
      <Item Id="dzd" Title="Algerian Dinar (دج)"/>
      <Item Id="eek" Title="Estonian Kroon (EEK)"/>
      <Item Id="egp" Title="Egyptian Pound (EGP)"/>
      <Item Id="etb" Title="Ethiopian Birr (Br)"/>
      <Item Id="eur" Title="Euro (€)"/>
      <Item Id="fjd" Title="Fiji Dollar (FJ$)"/>
      <Item Id="fkp" Title="Falkland Islands Pound (£)"/>
      <Item Id="gbp" Title="British Pound (£)"/>
      <Item Id="ghs" Title="Ghanaian Cedi (GHS)"/>
      <Item Id="gmd" Title="Gambian Dalasi (D)"/>
      <Item Id="gnf" Title="Guinea Franc (FG)"/>
      <Item Id="gtq" Title="Guatemala Quetzal (Q)"/>
      <Item Id="gyd" Title="Guyana Dollar (GY$)"/>
      <Item Id="hkd" Title="Hong Kong Dollar (HK$)"/>
      <Item Id="hnl" Title="Honduras Lempira (L)"/>
      <Item Id="hrk" Title="Croatian Kuna (kn)"/>
      <Item Id="huf" Title="Hungarian Forint (Ft)"/>
      <Item Id="idr" Title="Indonesian Rupiah (Rp)"/>
      <Item Id="ils" Title="Israeli Shekel (₪)"/>
      <Item Id="inr" Title="Indian Rupee (Rs)"/>
      <Item Id="iqd" Title="Iraqi Dinar (IQD)"/>
      <Item Id="isk" Title="Iceland Krona (kr)"/>
      <Item Id="jod" Title="Jordanian Dinar (JOD)"/>
      <Item Id="jpy" Title="Japanese Yen (¥)"/>
      <Item Id="kes" Title="Kenyan Shilling (KSh)"/>
      <Item Id="kgs" Title="Kyrgyzstan Som (KGS)"/>
      <Item Id="khr" Title="Cambodia Riel (KHR)"/>
      <Item Id="kmf" Title="Comoros Franc (KMF)"/>
      <Item Id="kpw" Title="North Korean Won (₩)"/>
      <Item Id="krw" Title="Korean Won (₩)"/>
      <Item Id="kwd" Title="Kuwaiti Dinar (KWD)"/>
      <Item Id="kyd" Title="Cayman Islands Dollar ($)"/>
      <Item Id="kzt" Title="Kazakhstan Tenge (KZT)"/>
      <Item Id="lkr" Title="Sri Lanka Rupee (ரூ)"/>
      <Item Id="mad" Title="Moroccan Dirham (MAD)"/>
      <Item Id="mdl" Title="Moldovan Leu (MDL)"/>
      <Item Id="mkd" Title="Macedonian Denar (MKD)"/>
      <Item Id="mmk" Title="Myanmar Kyat (K)"/>
      <Item Id="mnt" Title="Mongolian Tugrik (₮)"/>
      <Item Id="mop" Title="Macau Pataca ($)"/>
      <Item Id="mro" Title="Mauritania Ougulya (UM)"/>
      <Item Id="mur" Title="Mauritius Rupee (₨)"/>
      <Item Id="mvr" Title="Maldives Rufiyaa (Rf)"/>
      <Item Id="mwk" Title="Malawi Kwacha (MK)"/>
      <Item Id="mxn" Title="Mexican Peso ($)"/>
      <Item Id="myr" Title="Malaysian Ringgit (RM)"/>
      <Item Id="nad" Title="Namibian Dollar (N$)"/>
      <Item Id="ngn" Title="Nigerian Naira (₦)"/>
      <Item Id="nio" Title="Nicaragua Cordoba (C$)"/>
      <Item Id="nok" Title="Norwegian Krone (kr)"/>
      <Item Id="npr" Title="Nepalese Rupee (₨)"/>
      <Item Id="nzd" Title="New Zealand Dollar ($)"/>
      <Item Id="omr" Title="Omani Rial (OMR)"/>
      <Item Id="pab" Title="Panama Balboa (B)"/>
      <Item Id="pen" Title="Peruvian Nuevo Sol (PEN)"/>
      <Item Id="pgk" Title="Papua New Guinea Kina (K)"/>
      <Item Id="php" Title="Philippine Peso (₱)"/>
      <Item Id="pkr" Title="Pakistani Rupee (Rs)"/>
      <Item Id="pln" Title="Polish Zloty (zł)"/>
      <Item Id="qar" Title="Qatar Rial (QAR)"/>
      <Item Id="ron" Title="Romanian New Leu (L)"/>
      <Item Id="rub" Title="Russian Rouble (руб)"/>
      <Item Id="rwf" Title="Rwanda Franc (RF)"/>
      <Item Id="sar" Title="Saudi Arabian Riyal (SAR)"/>
      <Item Id="sbd" Title="Solomon Islands Dollar (SI$)"/>
      <Item Id="scr" Title="Seychelles Rupee (SR)"/>
      <Item Id="sdg" Title="Sudanese Pound (SDG)"/>
      <Item Id="sek" Title="Swedish Krona (kr)"/>
      <Item Id="sgd" Title="Singapore Dollar (S$)"/>
      <Item Id="shp" Title="St Helena Pound (£)"/>
      <Item Id="skk" Title="Slovak Koruna (Sk)"/>
      <Item Id="sll" Title="Sierra Leone Leone (Le)"/>
      <Item Id="sos" Title="Somali Shilling (So)"/>
      <Item Id="std" Title="Sao Tome Dobra (Db)"/>
      <Item Id="svc" Title="El Salvador Colon (₡)"/>
      <Item Id="syp" Title="Syrian Pound (SYP)"/>
      <Item Id="szl" Title="Swaziland Lilageni (SZL)"/>
      <Item Id="thb" Title="Thai Baht (฿)"/>
      <Item Id="tnd" Title="Tunisian Dinar (TND)"/>
      <Item Id="top" Title="Tonga Paang (T$)"/>
      <Item Id="try" Title="Turkish Lira (YTL)"/>
      <Item Id="ttd" Title="Trinidad Tobago Dollar (TTD)"/>
      <Item Id="twd" Title="Taiwan Dollar (NT$)"/>
      <Item Id="tzs" Title="Tanzanian Shilling (x)"/>
      <Item Id="ugx" Title="Ugandan Shilling (USh)"/>
      <Item Id="usd" Title="United States Dollar ($)"/>
      <Item Id="uyu" Title="Uruguayan New Peso (UYU)"/>
      <Item Id="uzs" Title="Uzbekistan Sum (UZS)"/>
      <Item Id="vef" Title="Venezuelan Bolivar (VEF)"/>
      <Item Id="vnd" Title="Vietnam Dong (₫)"/>
      <Item Id="vuv" Title="Vanuatu Vatu (Vt)"/>
      <Item Id="wst" Title="Samoa Tala (WS$)"/>
      <Item Id="xaf" Title="CFA Franc (BEAC) (BEAC)"/>
      <Item Id="xcd" Title="East Caribbean Dollar (EC$)"/>
      <Item Id="xof" Title="CFA Franc (BCEAO) (BCEAO)"/>
      <Item Id="xpf" Title="Pacific Franc (F)"/>
      <Item Id="yer" Title="Yemen Riyal (YER)"/>
      <Item Id="zar" Title="South African Rand (R)"/>
      <Item Id="zmk" Title="Zambian Kwacha (ZMK)"/>
    </Resource>
    <Resource Id="Countries">
      <Item Id="global" Title="Global"/>
      <Item Id="au" Title="Australia"/>
      <Item Id="a" Title="Canada"/>
      <Item Id="in" Title="India"/>
      <Item Id="z" Title="New Zealand"/>
      <Item Id="za" Title="South Africa"/>
      <Item Id="k" Title="United Kingdom"/>
      <Item Id="us" Title="United States"/>
    </Resource>
  </Resources>

  <RestConnector Id="KeywordData" Title="Keyword data" HelpUrl="http://seotoolsforexcel.com/keyword-severywhere/">
    <Parameters>
      <Text Id="Keywords" Title="Keywords" Required="" Multiline="true"/>
      <Select Id="Country" Name="Country" DefaultValue="global">
        <DataSource>
          <Resource Id="Countries"/>
        </DataSource>
      </Select>
      <Select Id="Currency" Name="Currency" DefaultValue="usd">
        <DataSource>
          <Resource Id="Currencies"/>
        </DataSource>
      </Select>
    </Parameters>
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://keywordseverywhere.com/service/2/getKeywordData.php?
        apiKey=@(Model.ApiKey)
        &country=@(Model.Country != "global" ? Model.Country : "")
        &currency=@(Model.Currency != "usd" ? Model.Currency : "")
        &source=gsearc
        &kw[]=@(FetchKeywords())
        &t=@(DateTime.Now.UnixTimeStampUtc());
        ]]>
      </Fetch.Url>
    </Fetch>

    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="keyword" Id="Keyword" Title="Keyword"/>
        <JsonPath Expr="vol" Id="Volume" Title="Volume" Converter="Double"/>
        <Compute Id="Cpc" Title="CPC" DefaultValue="" Converter="Double">
          <Compute.Expr>
            <![CDATA[
            @{
              double cpc = 0;
              Regex regex = new Regex(@"[\d\.]+");
              Match match = regex.Match(Model.Inp);
              string output = match.Groups[0].Value;

               if (!Double.TryParse(output, out cpc)){
                cpc = 0;
              }
            }
            @cpc
            ]]>
          </Compute.Expr>
          <JsonPath Expr="cpc" Id="Inp" Converter="String" DefaultValue=""/>
        </Compute>
        <JsonPath Expr="competition" Id="Competition" Title="Competition" Converter="Double"/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[

    string FetchKeywords()
    {
      var lines = ((string)Model.Keywords).Trim().Split('\n').Select(e => e.Trim()).Where(e => !string.IsNullOrEmpty(e)).ToArray();
      return string.Join("&kw[]=",lines.Select((e, i) => Utils.UrlEncode(e)).ToArray());
    }
    ]]>
  </RazorFunctions>
</Suite>