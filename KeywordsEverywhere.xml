<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="" Title="KeywordsEverywhere" Id="KeywordsEverywhere" RequireVersion="7.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/KeywordsEverywhere.xml" HelpUrl="http://seotoolsforexcel.com/keywordseverywhere/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/keywordseverywhere/">
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/keywordseverywhere/"/>
  </Settings>

  <RestConnector Id="KeywordData" Title="Keyword data" HelpUrl="https://keywordseverywhere.com/">
    <Fetch>
      <Fetch.Url>
        <![CDATA[
        https://keywordseverywhere.com/service/2/getKeywordData.php?
        apiKey=854d3df2691335a05ac1
        &country=
        &currency=
        &source=gsearc
        &kw%5B%5D=best%20enduro%20bike%202018&kw%5B%5D=enduro%20bikes%20for%20sale&kw%5B%5D=enduro%20mountain%20bike%20for%20sale&kw%5B%5D=enduro%20bike%20price&kw%5B%5D=enduro%20bikes%20street%20legal&kw%5B%5D=enduro%20bikes%20yamaha&kw%5B%5D=enduro%20bikes%20honda&kw%5B%5D=enduro%20motorbike
        &t=@(DateTime.Now.UnixTimeStampUtc());
        ]]>
      </Fetch.Url>
    </Fetch>

    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="keyword" Id="" Title="Keyword"/>
        <JsonPath Expr="vol" Id="Volume" Title="Volume"/>
        <JsonPath Expr="cpc" Id="Cpc" Title="CPC"/>
        <JsonPath Expr="competition" Id="Competition" Title="Competition"/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[

    string Fetchrls()
    {
      string[] lines = (string[])Model.Urls;
      return "items=" + lines.Length + "&" + string.Join("&",lines.Select((e, i) => "item" + i + "=" + Utils.UrlEncode(e)).ToArray());
    }

    ]]>
  </RazorFunctions>
</Suite>