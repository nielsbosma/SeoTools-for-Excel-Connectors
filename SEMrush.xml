<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="SEO" Title="SEMrush" Id="SEMrush" RequireVersion="9.5.5.2" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/SEMrush.xml" HelpUrl="http://seotoolsforexcel.com/semrush/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity" />

  <Settings HelpText="What's this?" HelpUrl="https://seotoolsforexcel.com/semrush/">
    <Text Id="ApiKey" Title="API Key" Required="true"/>
  </Settings>

  <Resources>
    <Resource Id="Databases">
			<Item Id="us" Title="google.com"/>
			<Item Id="uk" Title="google.co.uk"/>
			<Item Id="ca" Title="google.ca"/>
			<Item Id="ru" Title="google.ru"/>
			<Item Id="de" Title="google.de"/>
			<Item Id="fr" Title="google.fr"/>
			<Item Id="es" Title="google.es"/>
			<Item Id="it" Title="google.it"/>
			<Item Id="br" Title="google.com.br"/>
			<Item Id="au" Title="google.com.au"/>
			<Item Id="bing-us" Title="bing.com"/>
			<Item Id="ar" Title="google.com.ar"/>
			<Item Id="be" Title="google.be"/>
			<Item Id="ch" Title="google.ch"/>
			<Item Id="dk" Title="google.dk"/>
			<Item Id="fi" Title="google.fi"/>
			<Item Id="hk" Title="google.com.hk"/>
			<Item Id="ie" Title="google.ie"/>
			<Item Id="il" Title="google.co.il"/>
			<Item Id="mx" Title="google.com.mx"/>
			<Item Id="nl" Title="google.nl"/>
			<Item Id="no" Title="google.no"/>
			<Item Id="pl" Title="google.pl"/>
			<Item Id="se" Title="google.se"/>
			<Item Id="sg" Title="google.com.sg"/>
			<Item Id="tr" Title="google.com.tr"/>
			<Item Id="mobile-us" Title="google.com"/>
			<Item Id="jp" Title="google.co.jp"/>
			<Item Id="in" Title="google.co.in"/>
			<Item Id="hu" Title="google.hu"/>
			<Item Id="af" Title="google.com.af"/>
			<Item Id="al" Title="google.al"/>
			<Item Id="dz" Title="google.dz"/>
			<Item Id="ao" Title="google.co.ao"/>
			<Item Id="am" Title="google.am"/>
			<Item Id="at" Title="google.at"/>
			<Item Id="az" Title="google.az"/>
			<Item Id="bh" Title="google.com.bh"/>
			<Item Id="bd" Title="google.com.bd"/>
			<Item Id="by" Title="google.by"/>
			<Item Id="bz" Title="google.com.bz"/>
			<Item Id="bo" Title="google.com.bo"/>
			<Item Id="ba" Title="google.ba"/>
			<Item Id="bw" Title="google.co.bw"/>
			<Item Id="bn" Title="google.com.bn"/>
			<Item Id="bg" Title="google.bg"/>
			<Item Id="cv" Title="google.cv"/>
			<Item Id="kh" Title="google.com.kh"/>
			<Item Id="cm" Title="google.cm"/>
			<Item Id="cl" Title="google.cl"/>
			<Item Id="co" Title="google.com.co"/>
			<Item Id="cr" Title="google.co.cr"/>
			<Item Id="hr" Title="google.hr"/>
			<Item Id="cy" Title="google.com.cy"/>
			<Item Id="cz" Title="google.cz"/>
			<Item Id="cd" Title="google.cd"/>
			<Item Id="do" Title="google.com.do"/>
			<Item Id="ec" Title="google.com.ec"/>
			<Item Id="eg" Title="google.com.eg"/>
			<Item Id="sv" Title="google.com.sv"/>
			<Item Id="ee" Title="google.ee"/>
			<Item Id="et" Title="google.com.et"/>
			<Item Id="ge" Title="google.ge"/>
			<Item Id="gh" Title="google.com.gh"/>
			<Item Id="gr" Title="google.gr"/>
			<Item Id="gt" Title="google.com.gt"/>
			<Item Id="gy" Title="google.gy"/>
			<Item Id="ht" Title="google.ht"/>
			<Item Id="hn" Title="google.hn"/>
			<Item Id="is" Title="google.is"/>
			<Item Id="id" Title="google.co.id"/>
			<Item Id="jm" Title="google.com.jm"/>
			<Item Id="jo" Title="google.jo"/>
			<Item Id="kz" Title="google.kz"/>
			<Item Id="kw" Title="google.com.kw"/>
			<Item Id="lv" Title="google.lv"/>
			<Item Id="lb" Title="google.com.lb"/>
			<Item Id="lt" Title="google.lt"/>
			<Item Id="lu" Title="google.lu"/>
			<Item Id="mg" Title="google.mg"/>
			<Item Id="my" Title="google.com.my"/>
			<Item Id="mt" Title="google.com.mt"/>
			<Item Id="mu" Title="google.mu"/>
			<Item Id="md" Title="google.md"/>
			<Item Id="mn" Title="google.mn"/>
			<Item Id="me" Title="google.me"/>
			<Item Id="ma" Title="google.co.ma"/>
			<Item Id="mz" Title="google.co.mz"/>
			<Item Id="na" Title="google.com.na"/>
			<Item Id="np" Title="google.com.np"/>
			<Item Id="nz" Title="google.co.nz"/>
			<Item Id="ni" Title="google.com.ni"/>
			<Item Id="ng" Title="google.com.ng"/>
			<Item Id="om" Title="google.com.om"/>
			<Item Id="py" Title="google.com.py"/>
			<Item Id="pe" Title="google.com.pe"/>
			<Item Id="ph" Title="google.com.ph"/>
			<Item Id="pt" Title="google.pt"/>
			<Item Id="ro" Title="google.ro"/>
			<Item Id="sa" Title="google.com.sa"/>
			<Item Id="sn" Title="google.sn"/>
			<Item Id="rs" Title="google.rs"/>
			<Item Id="sk" Title="google.sk"/>
			<Item Id="si" Title="google.si"/>
			<Item Id="za" Title="google.co.za"/>
			<Item Id="kr" Title="google.co.kr"/>
			<Item Id="lk" Title="google.lk"/>
			<Item Id="th" Title="google.co.th"/>
			<Item Id="bs" Title="google.bs"/>
			<Item Id="tt" Title="google.tt"/>
			<Item Id="tn" Title="google.tn"/>
			<Item Id="ua" Title="google.com.ua"/>
			<Item Id="ae" Title="google.ae"/>
			<Item Id="uy" Title="google.com.uy"/>
			<Item Id="ve" Title="google.co.ve"/>
			<Item Id="vn" Title="google.com.vn"/>
			<Item Id="zm" Title="google.co.zm"/>
			<Item Id="zw" Title="google.co.zw"/>
			<Item Id="ly" Title="google.com.ly"/>
			<Item Id="mobile-uk" Title="google.com"/>
			<Item Id="mobile-ca" Title="google.ca"/>
			<Item Id="mobile-de" Title="google.de"/>
			<Item Id="mobile-fr" Title="google.fr"/>
			<Item Id="mobile-es" Title="google.es"/>
			<Item Id="mobile-it" Title="google.it"/>
			<Item Id="mobile-br" Title="google.com.br"/>
			<Item Id="mobile-au" Title="google.com.au"/>
			<Item Id="mobile-dk" Title="google.dk"/>
			<Item Id="mobile-mx" Title="google.com.mx"/>
			<Item Id="mobile-nl" Title="google.nl"/>
			<Item Id="mobile-se" Title="google.se"/>
			<Item Id="mobile-tr" Title="google.com.tr"/>
			<Item Id="mobile-in" Title="google.co.in"/>
			<Item Id="mobile-id" Title="google.co.id"/>
			<Item Id="mobile-il" Title="google.co.il"/>
    </Resource>
		<Resource Id="Fail">
      <Fail>
        <Regex Expr="^(ERROR 50.*)" Tag="EmptyResult"/>
        <Compute>
          <Compute.Expr>
            <![CDATA[
            @if(!string.IsNullOrEmpty(Model.Error))
							@: SEMrush returned: @Model.Error
            ]]>
          </Compute.Expr>
          <Regex Id="Error" Expr="^(ERROR.*)" DefaultValue=""/>
        </Compute>
      </Fail>
    </Resource>
    <Resource Id="HttpSettings">
      <HttpSettings>
        <RequestHeaders>
          <Header Name='User-Agent'>seotools-for-excel</Header>
        </RequestHeaders>
      </HttpSettings>
    </Resource>
  </Resources>

  <RestConnector Id="DomainOverview" Title="Domain Overview" Group="Domain Reports" HelpUrl="http://www.semrush.com/api-analytics/#domain_ranks" HelpText="Provides live or historical data on a domain’s keyword rankings in both organic and paid search in all regional databases.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="all">
        <DataSource>
					<Item Id="all" Title="[all]"/>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=domain_ranks
        &key=@Model.ApiKey
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
				@FetchDate()
        &export_columns=@Model.Fields
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Db" Title="Database" Tag="Database" Converter="String" Checked="True" HelpText="Regional database (US, UK, Italy, etc.)"/>
        <Field Id="Dn" Title="Domain" Tag="Domain" Converter="String" Checked="True" HelpText="A website's position for a particular keyword in Google's top 20 organic search results."/>
        <Field Id="Rk" Title="Rank" Tag="Rank" Converter="Long" Checked="True" HelpText="The SEMrush rating of the website's popularity based on organic traffic coming from Google's top 20 organic search results."/>
        <Field Id="Or" Title="Organic Keywords" Tag="Organic Keywords" Converter="Long" Checked="True" HelpText="Keywords that bring users to a website via Google's top 20 organic search results."/>
        <Field Id="Ot" Title="Organic Traffic" Tag="Organic Traffic" Converter="Long" Checked="True" HelpText="Traffic brought to a website via Google's top 20 organic search results."/>
        <Field Id="Oc" Title="Organic Cost" Tag="Organic Cost" Converter="Long" Checked="True" HelpText="Estimated price of organic keywords in Google AdWords."/>
        <Field Id="Ad" Title="Adwords Keywords" Tag="Adwords Keywords" Converter="Long" Checked="True" HelpText="Keywords a website is buying in Google AdWords for ads that appear in paid search results."/>
        <Field Id="At" Title="Adwords Traffic" Tag="Adwords Traffic" Converter="Long" Checked="True" HelpText="Traffic brought to the website via paid search results."/>
        <Field Id="Ac" Title="Adwords Cost" Tag="Adwords Cost" Converter="Long" Checked="True" HelpText="Estimated budget spent buying keywords in Google AdWords for ads that appear in paid search results (monthly estimation)."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="DomainOrganicSearchKeywords" Title="Domain Organic Search Keywords" Group="Domain Reports" HelpUrl="https://www.semrush.com/api-analytics/#domain_organic" HelpText="Lists keywords that bring users to a domain via Google's top 20 organic search results.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Select Id="KeywordType" Title="Filter by Keyword Type" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="new" Title="New"/>
          <Item Id="lost" Title="Lost"/>
          <Item Id="rise" Title="Rise"/>
          <Item Id="fall" Title="Fall"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="tr_desc" Title="Traffic Desc"/>
          <Item Id="tr_asc" Title="Traffic Asc"/>
          <Item Id="po_desc" Title="Position Desc"/>
          <Item Id="po_asc" Title="Position Asc"/>
          <Item Id="tc_desc" Title="Competition Desc"/>
          <Item Id="tc_asc" Title="Competition Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=domain_organic
        &key=@Model.ApiKey
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        @(Model.KeywordType != "all" ? "&display_positions=" + Model.KeywordType : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" Checked="True" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Po" Title="Position" Tag="Position" Converter="Int" Checked="True" HelpText="position a URL gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Pp" Title="Previous Position" Tag="Previous Position" Converter="Int" Checked="True" HelpText="A position a domain gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Pd" Title="Position Difference" Tag="Position Difference" Converter="Int" Checked="True" HelpText="The difference between the previous position a domain was earning with a particular keyword and its current position."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" Checked="True" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Int" Checked="True" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Ur" Title="URL" Tag="Url" Converter="String" Checked="True" HelpText="The URL of the target page (Backlinks)."/>
        <Field Id="Tr" Title="Traffic (%)" Tag="Traffic (%)" Converter="Double" Checked="True" HelpText="The share of traffic driven to the website with a particular keyword for a specified period."/>
        <Field Id="Co" Title="Competition" Tag="Competition" Converter="Double" Checked="True" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Tc" Title="Traffic Cost (%)" Tag="Traffic Cost (%)" Converter="Double" Checked="True" HelpText="The total amount spent on keywords in Google AdWords for which the domain is ranking in search results."/>
        <Field Id="Nr" Title="Number of Results" Tag="Number of Results" Converter="Int" Checked="True"/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" Checked="True" HelpText="The interest of searchers in a particular keyword during the last 12 months. This metric is based on changes in the number of queries per month."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Anchors" Title="Anchors"  Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_anchors" HelpText="Lists anchor texts used in backlinks leading to the queried domain, root domain, or URL. It also includes the number of backlinks and referring domains per anchor.">
    <Parameters>
      <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="backlinks_num_desc" Title="Backlinks Desc"/>
          <Item Id="backlinks_num_asc" Title="Backlinks Asc"/>
          <Item Id="last_seen_desc" Title="Last Seen Desc"/>
          <Item Id="last_seen_asc" Title="Last Seen Asc"/>
          <Item Id="first_seen_desc" Title="First Seen Desc"/>
          <Item Id="first_seen_asc" Title="First Seen Asc"/>
          <Item Id="domains_num_desc" Title="Domains Desc"/>
          <Item Id="domains_num_asc" Title="Domains Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_anchors
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &target_type=@(Model.Type)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="anchor" Title="Anchor" Tag="anchor" Converter="String" Checked="True" HelpText="A clickable text of a backlink."/>
        <Field Id="domains_num" Title="Domains" Tag="domains_num" Converter="Int" Checked="True" HelpText="Number of Domains."/>
        <Field Id="backlinks_num" Title="Backlinks" Tag="backlinks_num" Converter="Int" Checked="True" HelpText="Number of Backlinks."/>
        <Field Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime" Converter.SourceFormat="Unix" Checked="True" HelpText="The timestamp on which SEMrush first noticed a backlink."/>
        <Field Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime" Converter.SourceFormat="Unix" Checked="True" HelpText="The timestamp on which SEMrush last noticed a backlink."/>
      	<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
			</Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Backlinks" Title="Backlinks" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks" HelpText="Lists backlinks for a domain, root domain, or URL.">
    <Parameters>
      <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="last_seen_desc" Title="Last Seen Desc"/>
          <Item Id="last_seen_asc" Title="Last Seen Asc"/>
          <Item Id="first_seen_desc" Title="First Seen Desc"/>
          <Item Id="first_seen_asc" Title="First Seen Asc"/>
          <Item Id="page_score_desc" Title="Page Score Desc"/>
          <Item Id="page_score_asc" Title="Page Score Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &target_type=@(Model.Type)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="page_score" Title="Page Score" Tag="page_score" Converter="Int" Checked="True" HelpText="Page Score."/>
        <Field Id="page_trust_score" Title="Page Trust Score" Tag="page_trust_score" Converter="Int" Checked="True" HelpText="Page Trust Score."/>
        <Field Id="response_code" Title="Response Code" Tag="response_code" Converter="Int" Checked="True"  HelpText="Server response code."/>
        <Field Id="source_size" Title="Source Size" Tag="source_size" Converter="Double" Checked="True" HelpText="The source page‘s size in bytes."/>
        <Field Id="external_num" Title="External Links" Tag="external_num" Converter="Int" Checked="True" HelpText="The number of the source page’s links that point to other websites’ pages."/>
        <Field Id="internal_num" Title="Internal Links" Tag="internal_num" Converter="Int" Checked="True" HelpText="The number of the source page’s links that point to webpages of the same website."/>
        <Field Id="redirect_url" Title="Redirect URL" Tag="redirect_url" Converter="String" Checked="True" HelpText="The last URL in a redirect chain."/>
        <Field Id="source_url" Title="Source URL" Tag="source_url" Converter="String" Checked="True" HelpText="The URL of the source page."/>
        <Field Id="source_title" Title="Source Title" Tag="source_title" Converter="String" Checked="True" HelpText="The title of the source page."/>
        <Field Id="image_url" Title="Image URL" Tag="image_url" Converter="String" Checked="True" HelpText="Url of Image"/>
        <Field Id="target_url" Title="Target URL" Tag="target_url" Converter="String" Checked="True" HelpText="The URL of the target page (Backlinks)."/>
        <Field Id="target_title" Title="Target Title" Tag="target_title" Converter="String" Checked="True" HelpText="The title of the target page."/>
        <Field Id="anchor" Title="Anchor" Tag="anchor" Converter="String" Checked="True" HelpText="A clickable text of a backlink."/>
        <Field Id="image_alt" Title="Image Alt" Tag="image_alt" Converter="String" Checked="True" HelpText="A URL of an image backlink's location."/>
        <Field Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime" Converter.SourceFormat="Unix" Checked="True" HelpText="The timestamp on which SEMrush first noticed a backlink."/>
        <Field Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime" Converter.SourceFormat="Unix" Checked="True" HelpText="The timestamp on which SEMrush last noticed a backlink."/>
        <Field Id="nofollow" Title="Nofollow" Tag="nofollow" Converter="Bool" Checked="True"/>
        <Field Id="form" Title="Form" Tag="form" Converter="Bool" Checked="True"/>
        <Field Id="frame" Title="Frame" Tag="frame" Converter="Bool" Checked="True"/>
        <Field Id="image" Title="Image" Tag="image" Converter="Bool" Checked="True"/>
        <Field Id="sitewide" Title="Sitewide" Tag="sitewide" Converter="Bool"/>
        <Field Id="newlink" Title="Newlink" Tag="newlink" Converter="Bool"/>
        <Field Id="lostlink" Title="Lostlink" Tag="lostlink" Converter="Bool"/>
				<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="BacklinksOverview" Title="Backlinks Overview" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_overview" HelpText="Provides a summary of backlinks, including their type, referring domains and IP addresses for a domain, root domain, or URL.">
    <Parameters>
      <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_overview
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &target_type=@(Model.Type)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="ascore" Title="Authority Score" Tag="ascore" Converter="Int"/>
        <Field Id="total" Title="Backlinks" Tag="total" Converter="Int"/>
        <Field Id="domains_num" Title="Domains" Tag="domains_num" Converter="Int"/>
        <Field Id="urls_num" Title="URLs" Tag="urls_num" Converter="Double"/>
        <Field Id="ips_num" Title="IP Addresses" Tag="ips_num" Converter="Int"/>
        <Field Id="ipclassc_num" Title="IP Class C" Tag="ipclassc_num" Converter="Int"/>
        <Field Id="follows_num" Title="Follows" Tag="follows_num" Converter="Int"/>
        <Field Id="nofollows_num" Title="No Follows" Tag="nofollows_num" Converter="Int"/>
        <Field Id="sponsored_num" Title="Sponsored" Tag="sponsored_num" Converter="Int"/>
        <Field Id="ugc_num" Title="User Generated Content" Tag="ugc_num" Converter="Int"/>
        <Field Id="texts_num" Title="Texts" Tag="texts_num" Converter="Int"/>
        <Field Id="images_num" Title="Images" Tag="images_num" Converter="Int"/>
        <Field Id="forms_num" Title="Forms" Tag="forms_num" Converter="Int"/>
        <Field Id="frames_num" Title="Frames" Tag="frames_num" Converter="Int"/>
				<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CompetitorsinOrganicSearch" Title="Competitors in Organic Search" Group="Domain Reports" HelpUrl="https://www.semrush.com/api-analytics/#domain_organic_organic" HelpText="Lists a domain’s competitors in organic search results.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="np_desc" Title="Common Keywords Desc"/>
          <Item Id="cr_desc" Title="Competitor Relevance Desc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=domain_organic_organic
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Dn" Title="Domain" Tag="Domain" Converter="String"/>
        <Field Id="Cr" Title="Competitor Relevance" Tag="Competitor Relevance" Converter="Double" HelpText="A website's position for a particular keyword in Google's top 20 organic search results."/>
        <Field Id="Np" Title="Common Keywords" Tag="Common Keywords" Converter="Int" HelpText="Common keywords that domains are ranking for in Google's top 20 organic search results."/>
        <Field Id="Or" Title="Organic Keywords" Tag="Organic Keywords" Converter="Int" HelpText="Keywords that bring users to a website via Google's top 20 organic search results."/>
        <Field Id="Ot" Title="Organic Traffic" Tag="Organic Traffic" Converter="Int" HelpText="Traffic brought to a website via Google's top 20 organic search results."/>
        <Field Id="Oc" Title="Organic Cost" Tag="Organic Cost" Converter="Double" HelpText="Estimated price of organic keywords in Google AdWords."/>
        <Field Id="Ad" Title="Adwords Keywords" Tag="Adwords Keywords" Converter="Int" HelpText="Keywords a website is buying in Google AdWords for ads that appear in paid search results."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CompetitorsinPaidSearch" Title="Competitors in Paid Search" Group="Domain Reports" HelpUrl="https://www.semrush.com/api-analytics/#domain_adwords_adwords" HelpText="Lists a domain’s competitors in paid search results.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="http://nintendo.com" Required="true"/>
			<Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="np_desc" Title="Common Keywords Desc"/>
          <Item Id="cr_desc" Title="Competitor Relevance Desc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=domain_adwords_adwords
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Dn" Title="Domain" Tag="Domain" Converter="String" HelpText="A website's position for a particular keyword in Google's top 20 organic search results."/>
        <Field Id="Cr" Title="Competitor Relevance" Tag="Competitor Relevance" Converter="Double" HelpText="Competition level based on the total number of keywords of each domain and the number of keywords the domains have in common."/>
        <Field Id="Np" Title="Common Keywords" Tag="Common Keywords" Converter="Int" HelpText="Common keywords that domains are ranking for in Google's top 20 organic search results."/>
        <Field Id="Ad" Title="Adwords Keywords" Tag="Adwords Keywords" Converter="Int" HelpText="Keywords a website is buying in Google AdWords for ads that appear in paid search results."/>
        <Field Id="At" Title="Adwords Traffic" Tag="Adwords Traffic" Converter="Int" HelpText="Traffic brought to the website via paid search results."/>
        <Field Id="Ac" Title="Adwords Cost" Tag="Adwords Cost" Converter="Double" HelpText="Estimated budget spent buying keywords in Google AdWords for ads that appear in paid search results (monthly estimation)."/>
        <Field Id="Or" Title="Organic Keywords" Tag="Organic Keywords" Converter="Int" HelpText="Keywords that bring users to a website via Google's top 20 organic search results."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="DomainPaidSearchKeywords" Title="Domain Paid Search Keywords" Group="Domain Reports" HelpUrl="https://www.semrush.com/api-analytics/#domain_adwords" HelpText="Lists keywords that bring users to a domain via Google's paid search results.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="http://nintendo.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Select Id="KeywordType" Title="Filter by Keyword Type" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="new" Title="New"/>
          <Item Id="lost" Title="Lost"/>
          <Item Id="rise" Title="Rise"/>
          <Item Id="fall" Title="Fall"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="tr_desc" Title="Traffic Desc"/>
          <Item Id="tr_asc" Title="Traffic Asc"/>
          <Item Id="po_desc" Title="Position Desc"/>
          <Item Id="po_asc" Title="Position Asc"/>
          <Item Id="tc_desc" Title="Competition Desc"/>
          <Item Id="tc_asc" Title="Competition Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=domain_adwords
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        @(Model.KeywordType != "all" ? "&display_positions=" + Model.KeywordType : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Po" Title="Position" Tag="Position" Converter="Int" HelpText="position a URL gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Pp" Title="Previous Position" Tag="Previous Position" Converter="Int" HelpText="A position a domain gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Pd" Title="Position Difference" Tag="Position Difference" Converter="Int" HelpText="The difference between the previous position a domain was earning with a particular keyword and its current position."/>
        <Field Id="Ab" Title="Adwords Block" Tag="Adwords Block" Converter="String" HelpText="The place on a SERP where an ad appeared (top, side, or bottom blocks)."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Int" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Tr" Title="Traffic (%)" Tag="Traffic (%)" Converter="Double" HelpText="The share of traffic driven to the website with a particular keyword for a specified period."/>
        <Field Id="Tc" Title="Competition" Tag="Competition" Converter="Double" HelpText="The total amount spent on keywords in Google AdWords for which the domain is ranking in search results."/>
        <Field Id="Co" Title="Traffic Cost (%)" Tag="Traffic Cost (%)" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Nr" Title="Number of Results" Tag="Number of Results" Converter="Int"/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" HelpText="The total number of organic results returned for a given keyword at the last date of collection."/>
        <Field Id="Tt" Title="Title" Tag="Title" Converter="String" HelpText="Ad title."/>
        <Field Id="Ds" Title="Description" Tag="Description" Converter="String" HelpText="Ad text."/>
        <Field Id="Vu" Title="Visible URL" Tag="Visible Url" Converter="String" HelpText="Visible URL."/>
        <Field Id="Ur" Title="URL" Tag="Url" Converter="String" HelpText="The URL of the target page (Backlinks)."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="IndexedPages" Title="Indexed Pages" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_pages" HelpText="Shows indexed pages of the queried domain.">
    <Parameters>
      <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="backlinks_num_desc" Title="Backlinks Desc"/>
          <Item Id="backlinks_num_asc" Title="Backlinks Asc"/>
          <Item Id="domains_num_desc" Title="Domains Desc"/>
          <Item Id="domains_num_asc" Title="Domains Asc"/>
          <Item Id="last_seen_desc" Title="Last Seen Desc"/>
          <Item Id="last_seen_asc" Title="Last Seen Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_pages
        &target_type=@Model.Type
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="source_url" Title="Source URL" Tag="source_url" Converter="String" HelpText="The URL of the source page."/>
        <Field Id="source_title" Title="Source Title" Tag="source_title" Converter="String" HelpText="The title of the source page."/>
        <Field Id="backlinks_num" Title="Backlinks" Tag="backlinks_num" Converter="Int" HelpText="Number of Backlinks."/>
        <Field Id="domains_num" Title="Domains" Tag="domains_num" Converter="Int" HelpText="Number of Domains."/>
        <Field Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime" Converter.SourceFormat="Unix" HelpText="The timestamp on which SEMrush last noticed a backlink."/>
        <Field Id="external_num" Title="External Links" Tag="external_num" Converter="Int" HelpText="The number of the source page’s links that point to other websites’ pages."/>
        <Field Id="internal_num" Title="Internal Links" Tag="internal_num" Converter="Int" HelpText="The number of the source page’s links that point to webpages of the same website."/>
        <Field Id="response_code" Title="Response Code" Tag="response_code" Converter="Int" HelpText="Server response code."/>
				<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
			</Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordOverview" Title="Keyword Overview" Group="Keyword Reports" HelpUrl="https://www.semrush.com/api-analytics/#phrase_all" HelpText="Provides a summary of a keyword, including its volume, CPC, competition, and the number of results in all regional databases.">
    <Parameters>
      <Text Id="Phrase" Title="Phrase" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="all">
        <DataSource>
					<Item Id="all" Title="[all]"/>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=phrase_all
        &phrase=@Utils.UrlEncode(Model.Phrase)
        &key=@Model.ApiKey
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Db" Title="Database" Tag="Database" Converter="String" HelpText="Regional database (US, UK, Italy, etc.)"/>
        <Field Id="Ph" Title="Phrase" Tag="Phrase" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Double" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Co" Title="Competition" Tag="Competition" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="KeywordDifficulty" Title="Keyword Difficulty" Group="Keyword Reports" HelpUrl="https://www.semrush.com/api-analytics/#phrase_kdi" HelpText="Provides keyword difficulty, an index that helps to estimate how difficult it would be to seize competitors' positions in organic search within the Google's top 20 with an indicated search term.">
    <Parameters>
      <Text Id="Ids" Title="Phrases" Required="true" HelpText="Phrases separated by newline" Multiline="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
    </Parameters>
    <Batch Parameter="Ids" Separator="\n" ItemsPerBatch="20"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=phrase_kdi
        &phrase=@(FetchPhrases())
        &key=@Model.ApiKey
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Kd" Title="Keyword Difficulty Index" Tag="Keyword Difficulty Index" Converter="Double" HelpText="Keyword Difficulty Index."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="OrganicResults" Title="Organic Results" Group="Keyword Reports" HelpUrl="https://www.semrush.com/api-analytics/#phrase_organic" HelpText="Lists domains that are ranking in Google's top 20 organic search results with a requested keyword.">
    <Parameters>
      <Text Id="Phrase" Title="Phrase" Debug.DefaultValue="test" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=phrase_organic
        &phrase=@Utils.UrlEncode(Model.Phrase)
        &key=@Model.ApiKey
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Dn" Title="Domain" Tag="Domain" Converter="String" HelpText="A website's position for a particular keyword in Google's top 20 organic search results."/>
        <Field Id="Ur" Title="URL" Tag="Url" Converter="String" HelpText="The URL of the target page (Backlinks)."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PaidResults" Title="Paid Results" Group="Keyword Reports" HelpUrl="https://www.semrush.com/api-analytics/#phrase_adwords" HelpText="Lists domains that are ranking in Google's top 20 paid search results with a requested keyword.">
    <Parameters>
      <Text Id="Phrase" Title="Phrase" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=phrase_adwords
        &phrase=@Utils.UrlEncode(Model.Phrase)
        &key=@Model.ApiKey
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Dn" Title="Domain" Tag="Domain" Converter="String" HelpText="A website's position for a particular keyword in Google's top 20 organic search results."/>
        <Field Id="Ur" Title="URL" Tag="Url" Converter="String" HelpText="The URL of the target page (Backlinks)."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="PhraseMatchKeywords" Title="Phrase Match Keywords" Group="Keyword Reports" HelpUrl="https://www.semrush.com/api-analytics/#phrase_fullsearch" HelpText="Offers a list of phrase matches and alternate search queries, including particular keywords or keyword expressions.">
    <Parameters>
      <Text Id="Phrase" Title="Phrase" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="nq_desc" Title="Search Volume Desc"/>
          <Item Id="nq_asc" Title="Search Volume Asc"/>
          <Item Id="cp_desc" Title="CPC Desc"/>
          <Item Id="cp_asc" Title="CPC Asc"/>
          <Item Id="co_desc" Title="Competition Desc"/>
          <Item Id="co_asc" Title="Competition Asc"/>
          <Item Id="nr_desc" Title="Results Desc"/>
          <Item Id="nr_asc" Title="Results Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=phrase_fullsearch
        &phrase=@Utils.UrlEncode(Model.Phrase)
        &key=@Model.ApiKey
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Double" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Co" Title="Competition" Tag="Competition" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Nr" Title="Number of Results" Tag="Number of Results" Converter="Int" HelpText="The total number of organic results returned for a given keyword at the last date of collection."/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" HelpText="The interest of searchers in a particular keyword during the last 12 months. This metric is based on changes in the number of queries per month."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ReferringDomains" Title="Referring Domains" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_refdomains" HelpText="Lists domains pointing to the queried domain, root domain, or URL.">
    <Parameters>
    <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="domain_score_desc" Title="Domain Score Desc"/>
          <Item Id="domain_score_asc" Title="Domain Score Asc"/>
          <Item Id="backlinks_desc" Title="Backlinks Desc"/>
          <Item Id="backlinks_asc" Title="Backlinks Asc"/>
          <Item Id="last_seen_desc" Title="Last Seen Desc"/>
          <Item Id="last_seen_asc" Title="Last Seen Asc"/>
          <Item Id="first_seen_desc" Title="First Seen Desc"/>
          <Item Id="first_seen_asc" Title="First Seen Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_refdomains
        &target_type=@Model.Type
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="domain_score" Title="Domain Score" Tag="domain_score" Converter="Double" HelpText="The Score of the Domain."/>
        <Field Id="domain_trust_score" Title="Domain Trust Score" Tag="domain_trust_score" Converter="Double" HelpText="The Trust Score of the Domain."/>
        <Field Id="domain" Title="Domain" Tag="domain" Converter="String" HelpText="Domain name."/>
        <Field Id="backlinks_num" Title="Backlinks" Tag="backlinks_num" Converter="Int" HelpText="Number of backlinks."/>
        <Field Id="ip" Title="IP" Tag="ip" Converter="String" HelpText="IP address."/>
        <Field Id="country" Title="Country" Tag="country" Converter="String"/>
        <Field Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime" Converter.SourceFormat="Unix" HelpText="The timestamp on which SEMrush first noticed a backlink."/>
        <Field Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime" Converter.SourceFormat="Unix" HelpText="The timestamp on which SEMrush last noticed a backlink."/>
				<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
			</Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ReferringIPs" Title="Referring IPs" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_refips" HelpText="Lists IP addresses where backlinks to a domain, root domain, or URL are coming from.">
    <Parameters>
    <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="backlinks_num_desc" Title="Backlinks Desc"/>
          <Item Id="backlinks_num_asc" Title="Backlinks Asc"/>
          <Item Id="domains_num_desc" Title="Domains Desc"/>
          <Item Id="domains_num_asc" Title="Domains Asc"/>
          <Item Id="last_seen_desc" Title="Last Seen Desc"/>
          <Item Id="last_seen_asc" Title="Last Seen Asc"/>
          <Item Id="first_seen_desc" Title="First Seen Desc"/>
          <Item Id="first_seen_asc" Title="First Seen Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_refips
        &target_type=@Model.Type
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="ip" Title="IP" Tag="ip" Converter="String" HelpText="IP address."/>
        <Field Id="country" Title="Country" Tag="country" Converter="String"/>
        <Field Id="domains_num" Title="Domains" Tag="domains_num" Converter="Int" HelpText="Number of domains."/>
        <Field Id="backlinks_num" Title="Backlinks" Tag="backlinks_num" Converter="Int" HelpText="Number of backlinks."/>
        <Field Id="first_seen" Title="First Seen" Tag="first_seen" Converter="DateTime" Converter.SourceFormat="Unix" HelpText="The timestamp on which SEMrush first noticed a backlink."/>
        <Field Id="last_seen" Title="Last Seen" Tag="last_seen" Converter="DateTime" Converter.SourceFormat="Unix" HelpText="The timestamp on which SEMrush last noticed a backlink."/>
				<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
			</Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RelatedKeywords" Title="Related Keywords" Group="Keyword Reports" HelpUrl="https://www.semrush.com/api-analytics/#phrase_related" HelpText="Provides an extended list of related keywords, synonyms, and variations relevant to a queried term in a chosen database.">
    <Parameters>
      <Text Id="Phrase" Title="Keyword/Phrase" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="nq_desc" Title="Search Volume Desc"/>
          <Item Id="nq_asc" Title="Search Volume Asc"/>
          <Item Id="cp_desc" Title="CPC Desc"/>
          <Item Id="cp_asc" Title="CPC Asc"/>
          <Item Id="co_desc" Title="Competition Desc"/>
          <Item Id="co_asc" Title="Competition Asc"/>
          <Item Id="nr_desc" Title="Results Desc"/>
          <Item Id="nr_asc" Title="Results Asc"/>
        </DataSource>
      </Select>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=phrase_related
        &phrase=@Utils.UrlEncode(Model.Phrase)
        &key=@Model.ApiKey
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Double" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Co" Title="Competition" Tag="Competition" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Nr" Title="Number of Results" Tag="Number of Results" Converter="Int" HelpText="The total number of organic results returned for a given keyword at the last date of collection."/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" HelpText="The interest of searchers in a particular keyword during the last 12 months. This metric is based on changes in the number of queries per month."/>
        <Field Id="In" Title="Intents" Tag="Intent" Converter="String" HelpText="Keyword intents (0 - Commercial, 1 - Informational, 2 - Navigational, 3 - Transactional)."/>
			</Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="UrlOrganicSearchKeywords" Title="URL Organic Search Keywords" Group="URL Reports" HelpUrl="https://www.semrush.com/api-analytics/#url_organic" HelpText="Lists keywords that bring users to a URL via Google's top 20 organic search results.">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="http://nintendo.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=url_organic
        &url=@Utils.UrlEncode(Model.Url)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Po" Title="Position" Tag="Position" Converter="Int" HelpText="Position a URL gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Int" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Co" Title="Traffic Cost (%)" Tag="Traffic Cost (%)" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Tr" Title="Traffic (%)" Tag="Traffic (%)" Converter="Double" HelpText="The share of traffic driven to the website with a particular keyword for a specified period."/>
        <Field Id="Tc" Title="Competition" Tag="Competition" Converter="Double" HelpText="The total amount spent on keywords in Google AdWords for which the domain is ranking in search results."/>
        <Field Id="Nr" Title="Number of Results" Tag="Number of Results" Converter="Int" HelpText="The total number of organic results returned for a given keyword at the last date of collection."/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" HelpText="The interest of searchers in a particular keyword during the last 12 months. This metric is based on changes in the number of queries per month."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="UrlPaidSearchKeywords" Title="URL Paid Search Keywords" Group="URL Reports" HelpUrl="https://www.semrush.com/api-analytics/#url_adwords" HelpText="Lists keywords that bring users to a URL via Google's top 20 paid search results.">
    <Parameters>
      <Text Id="Url" Title="URL" Debug.DefaultValue="http://nintendo.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>
			<Date Id="DisplayDate" Title="Display Date (Optional)" Required="false" Nullable="true" HelpText="SEMRush API forces Display Date to be the 15th of each month. Dates are autocorrected to the 15th Pre-Fetch."/>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=url_adwords
        &url=@Utils.UrlEncode(Model.Url)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
				@FetchDate()
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Po" Title="Position" Tag="Position" Converter="Int" HelpText="position a URL gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Nq" Title="Search Volume" Tag="Search Volume" Converter="Int" HelpText="The average number of times users have searched for a given keyword per month. We calculate this value over the last 12 months."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Int" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Co" Title="Traffic Cost (%)" Tag="Traffic Cost (%)" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Tr" Title="Traffic (%)" Tag="Traffic (%)" Converter="Double" HelpText="The share of traffic driven to the website with a particular keyword for a specified period."/>
        <Field Id="Tc" Title="Competition" Tag="Competition" Converter="Double" HelpText="The total amount spent on keywords in Google AdWords for which the domain is ranking in search results."/>
        <Field Id="Nr" Title="Number of Results" Tag="Number of Results" Converter="Int" HelpText="The total number of organic results returned for a given keyword at the last date of collection."/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" HelpText="The interest of searchers in a particular keyword during the last 12 months. This metric is based on changes in the number of queries per month."/>
        <Field Id="Tt" Title="Title" Tag="Title" Converter="String" HelpText="Ad title."/>
        <Field Id="Ds" Title="Description" Tag="Description" Converter="String" HelpText="Ad text."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AdsCopies" Title="Ads Copies" Group="Domain Reports" HelpUrl="https://www.semrush.com/api-analytics/#domain_adwords_unique" HelpText="Shows unique ad copies SEMrush noticed when the domain ranked in Google's paid search results for keywords from our databases.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="http://nintendo.com" Required="true"/>
      <Select Id="Database" Title="Database" DefaultValue="en">
        <DataSource>
					<Resource Id="Databases"/>
        </DataSource>
      </Select>      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/?
        type=domain_adwords_unique
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        @(Model.Database != "all" ? "&database=" + Model.Database : "")
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        &display_limit=@Model.MaxResults
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="Ph" Title="Keyword" Tag="Keyword" Converter="String" HelpText="Keyword bringing users to the website via Google's top 20 organic search results."/>
        <Field Id="Po" Title="Position" Tag="Position" Converter="Int" HelpText="position a URL gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Pp" Title="Previous Position" Tag="Previous Position" Converter="Int" HelpText="A position a domain gets with a particular keyword in Google's top 20 organic or paid search results."/>
        <Field Id="Cp" Title="CPC" Tag="CPC" Converter="Int" HelpText="Average price in US dollars advertisers pay for a user's click on an ad containing a particular keyword (Google AdWords)."/>
        <Field Id="Tr" Title="Traffic (%)" Tag="Traffic (%)" Converter="Double" HelpText="The share of traffic driven to the website with a particular keyword for a specified period."/>
        <Field Id="Co" Title="Competition" Tag="Competition" Converter="Double" HelpText="Competitive density of advertisers using the given term for their ads. One (1) means the highest competition."/>
        <Field Id="Td" Title="Trends" Tag="Trends" Converter="String" HelpText="The interest of searchers in a particular keyword during the last 12 months. This metric is based on changes in the number of queries per month."/>
        <Field Id="Tt" Title="Title" Tag="Title" Converter="String" HelpText="Ad title."/>
        <Field Id="Ds" Title="Description" Tag="Description" Converter="String" HelpText="Ad text."/>
        <Field Id="Vu" Title="Visible URL" Tag="Visible Url" Converter="String" HelpText="Visible URL."/>
        <Field Id="Ur" Title="URL" Tag="Url" Converter="String" HelpText="The URL of the target page (Backlinks)."/>
        <Field Id="Pc" Title="Number of Keywords" Tag="Number of Keywords" Converter="Int" HelpText="Number of keywords."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="TLDDistribution" Title="TLD Distribution" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_tld" HelpText="Shows referring domain distributions depending on their top-level domain type.">
    <Parameters>
    <Text Id="Target" Title="Target" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="backlinks_num_desc" Title="Backlinks Desc"/>
          <Item Id="backlinks_num_asc" Title="Backlinks Asc"/>
          <Item Id="domains_num_desc" Title="Domains Desc"/>
          <Item Id="domains_num_asc" Title="Domains Asc"/>
        </DataSource>
      </Select>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_tld
        &target_type=@Model.Type
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &key=@Model.ApiKey
        &export_columns=@Model.Fields
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="zone" Title="Zone" Tag="zone" Converter="String" HelpText="Zone of TLD."/>
        <Field Id="domains_num" Title="Domains" Tag="domains_num" Converter="Int" HelpText="Number of domains."/>
        <Field Id="backlinks_num" Title="Backlinks" Tag="backlinks_num" Converter="Int" HelpText="Number of backlinks."/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="RefDomainsbyCountry" Title="Referring Domains by Country" Group="Backlinks" HelpUrl="https://www.semrush.com/api-analytics/#backlinks_geo" HelpText="Shows referring domain distributions by country (an IP address defines a country).">
    <Parameters>
    <Text Id="Target" Title="Target(s)" Debug.DefaultValue="https://seotoolsforexcel.com" Required="true" Multiline="true"/>
      <Select Id="Type" Title="Type" DefaultValue="root_domain" Required="false">
        <DataSource>
          <Item Id="root_domain" Title="Root Domain"/>
          <Item Id="domain" Title="Domain"/>
          <Item Id="url" Title="URL"/>
        </DataSource>
      </Select>
      <Select Id="Sort" Title="Sort" Required="false" DefaultValue="default">
        <DataSource>
          <Item Id="default" Title="Default"/>
          <Item Id="backlinks_num_desc" Title="Backlinks Desc"/>
          <Item Id="backlinks_num_asc" Title="Backlinks Asc"/>
          <Item Id="domains_num_desc" Title="Domains Desc"/>
          <Item Id="domains_num_asc" Title="Domains Asc"/>
        </DataSource>
      </Select>
    </Parameters>
		<Batch Parameter="Target" Separator="\n"/>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/v1/?
        type=backlinks_geo
        &target_type=@Model.Type
        &target=@Utils.UrlEncode(Utils.UrlProperty(Model.Target).Domain)
        &key=@Model.ApiKey
        &export_columns=@ValidFields()
        @(Model.Sort != "default" ? "&display_sort=" + Model.Sort : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="country" Title="Country" Tag="country" Converter="String" HelpText="The country of TLD."/>
        <Field Id="domains_num" Title="Domains" Tag="domains_num" Converter="Int" HelpText="Number of domains."/>
        <Field Id="backlinks_num" Title="Backlinks" Tag="backlinks_num" Converter="Int" HelpText="Number of backlinks."/>
				<Field Id="SourceItem" Title="Target" Expr="@(Model.Target)"/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="DisplayAdvertisers" Title="Display Advertisers" Group="Display Advertising Reports" HelpUrl="https://www.semrush.com/api-analytics/#da_publisher_advertisers" HelpText="Lists advertisers whose display ads have appeared on a queried publisher’s website.">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="http://nintendo.com" Required="true"/>
      <Number Id="MaxResults" Title="Max Results" DefaultValue="100" Required="false" HelpText="Number of rows to be returned back"/>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://api.semrush.com/analytics/da/v2/?
        type=publisher_advertisers
        &action=report
        &domain=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        &key=@Model.ApiKey
        &display_limit=@Model.MaxResults
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
        <Field Id="domain" Title="Domain" Tag="domain" Converter="String"/>
        <Field Id="ads_count" Title="Ads Count" Tag="ads_count" Converter="Int"/>
        <Field Id="times_seen" Title="Times Seen" Tag="times_seen" Converter="Int"/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="TrafficAnalyticsSummary" Title="Traffic Analytics Summary" Group="Traffic Analytics Reports" HelpUrl="https://www.semrush.com/api-analytics/#ta_summary" HelpText="Allows you to get the main estimated traffic metrics for multiple domains on a monthly basis">
    <Parameters>
      <Text Id="Domain" Title="Domain" Debug.DefaultValue="http://nintendo.com" Required="true"/>
			<Select Id="Country" DefaultValue="Global">
        <DataSource>
					<Item Id="Global"/>
          <ISOCountryCodes/>
        </DataSource>
      </Select>
    </Parameters>
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        https://api.semrush.com/analytics/ta/api/v3/summary
        ?targets=@Utils.UrlEncode(Utils.UrlProperty(Model.Domain).Domain)
        &key=@Model.ApiKey
				@(Model.Country != "Global" ? "&country=" + Model.Country : "")
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <Csv Separator=";" HasHeader="true">
				<Field Id="domain" Converter="String"/>
				<Field Id="display_date" Converter="DateTime"/>
				<Field Id="country" Converter="String"/>
				<Field Id="total_rank" Converter="Auto"/>
				<Field Id="desktop_rank" Converter="Auto"/>
				<Field Id="mobile_rank" Converter="Auto"/>
				<Field Id="desktop_share" Converter="Auto"/>
				<Field Id="mobile_share" Converter="Auto"/>
				<Field Id="total_visits" Converter="Auto"/>
				<Field Id="mobile_visits" Converter="Auto"/>
				<Field Id="desktop_visits" Converter="Auto"/>
				<Field Id="total_unique_visitors" Converter="Auto"/>
				<Field Id="mobile_unique_visitors" Converter="Auto"/>
				<Field Id="desktop_unique_visitors" Converter="Auto"/>
				<Field Id="total_pages_per_visit" Converter="Auto"/>
				<Field Id="mobile_pages_per_visit" Converter="Auto"/>
				<Field Id="desktop_pages_per_visit" Converter="Auto"/>
				<Field Id="total_avg_visit_duration" Converter="Auto"/>
				<Field Id="mobile_avg_visit_duration" Converter="Auto"/>
				<Field Id="desktop_avg_visit_duration" Converter="Auto"/>
				<Field Id="total_bounce_rate" Converter="Auto"/>
				<Field Id="mobile_bounce_rate" Converter="Auto"/>
				<Field Id="desktop_bounce_rate" Converter="Auto"/>
      </Csv>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="AccountAPICredits" Title="Account API Credits" HelpUrl="https://www.semrush.com/api-accounts/#countapiunits" HelpText="Shows the current API balance for a given API key.">
    <Fetch>
			<Resource Id="HttpSettings"/>
      <Fetch.Url>
        <![CDATA[
        http://www.semrush.com/users/countapiunits.html?
        &key=@Model.ApiKey
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$" Id="Credits" Title="Credits" Converter="Int"/>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>


  <RazorFunctions>
    <![CDATA[
		string ValidFields() {
      string[] fields = ((string)Model.Fields).Split(',').ToArray();
			return string.Join(",", fields.Where(e => e != "SourceItem").Select(e => e).Distinct().ToArray());
    }

    string FetchPhrases() {
			string[] lines = ((string)Model.Ids).Trim().Split('\n').Select(e => e.Trim()).Where(e => !string.IsNullOrEmpty(e)).ToArray();
      return string.Join(";",lines.Select((e, i) => Utils.UrlEncode(e)).ToArray());
    }

		string FetchDate() {
			return !Utils.IsNullDate(Model.DisplayDate)
				? "&display_date=" + Model.DisplayDate.ToString("yyyyMM15")
				: string.Empty;
		}
    ]]>
  </RazorFunctions>

</Suite>