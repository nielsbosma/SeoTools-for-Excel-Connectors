<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="Finance" Title="Stripe" Id="Stripe" RequireVersion="8.0.15" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Stripe.xml" HelpUrl="http://seotoolsforexcel.com/stripe/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/stripe/">
    <Text Id="SecretKey" Title="Secret Key" Required="true" HelpUrl="http://seotoolsforexcel.com/stripe/"/>
  </Settings>

  <Resources>
    <Resource Id="TxTypes">
      <Item Id="all" Title="All"/>
      <Item Id="charge" Title="Charge"/>
      <Item Id="refund" Title="Refund"/>
      <Item Id="adjustment" Title="Adjustment"/>
      <Item Id="application_fee" Title="Application Fee"/>
      <Item Id="application_fee_refund" Title="Application Fee Refund"/>
      <Item Id="transfer" Title="Transfer"/>
      <Item Id="payment" Title="Payment"/>
      <Item Id="payout" Title="Payout"/>
      <Item Id="payout_failure" Title="Payout Failure"/>
      <Item Id="stripe_fee" Title="Stripe Fee"/>
      <Item Id="network_cost" Title="Network Cost"/>
    </Resource>
    <Resource Id="ChargeSources">
      <Item Id="all" Title="All"/>
      <Item Id="alipay_account" Title="Alipay Account"/>
      <Item Id="bank_account" Title="Bank Account"/>
      <Item Id="bitcoin_receiver" Title="Bitcoin"/>
      <Item Id="Card" Title="Card"/>
    </Resource>
    <Resource Id="Headers">
      <HttpSettings>
        <RequestHeaders>
          <RequestContentType>application/json</RequestContentType>
          <Header Name='Authorization'>Basic @(CreateBasicAuth())</Header>
        </RequestHeaders>
        <RequestContentType>application/json</RequestContentType>
      </HttpSettings>
    </Resource>
    <Resource Id="Error">
      <Fail>
        <JsonPath Expr="error.message"/>
      </Fail>
    </Resource>
  </Resources>

  <RestConnector Id="BalanceHistory" Title="Balance History" HelpUrl="https://stripe.com/docs/api#balance_history">
    <Parameters>
      <Select Id="TxType" Title="Transaction Type" Required="false" DefaultValue="all">
        <DataSource>
          <Resource Id="TxTypes"/>
        </DataSource>
      </Select>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/balance/history?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        @if(Model.TxType != "all")
        {
          @: &type=@(Model.TxType)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="amount" Id="Amount" Title="Amount" Converter="Double" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="available_on" Id="AvailableOn" Title="Available On" Converter="DateTime" Converter.SourceFormat="Unix"/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix"/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="exchange_rate" Id="ExchangeRate" Title="Exchange Rate" Converter="Double" HelpText=""/>
        <JsonPath Expr="fee" Id="Fee" Title="Fee" Converter="Double" HelpText=""/>
        <JsonPath Expr="net" Id="Net" Title="Net" Converter="Double" HelpText=""/>
        <JsonPath Expr="source" Id="Source" Title="Source" Converter="String" HelpText=""/>
        <JsonPath Expr="status" Id="Status" Title="Status" Converter="String" HelpText=""/>
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Customers" Title="Customers" HelpUrl="https://stripe.com/docs/api#list_customers">
    <Parameters>
      <Text Id="Email" Title="Filter by email" Required="true" HelpText="A filter on the list based on the customerâ€™s email field"/>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/customers?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        @if(!string.IsNullOrEmpty(Model.Email))
        {
          @: &email=@Utils.UrlEncode(Model.Email)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="Int" HelpText=""/>
        <JsonPath Expr="email" Id="Email" Title="Email" Converter="String" HelpText=""/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="account_balance" Id="AccountBalance" Title="Account Balance" Converter="Double" HelpText=""/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix"/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="default_source" Id="DefaultSource" Title="Default Source" Converter="String" HelpText=""/>
        <JsonPath Expr="delinquent" Id="Delinquent" Title="Delinquent" Converter="bool" HelpText=""/>
        <JsonPath Expr="discount" Id="Discount" Title="Discount" Converter="Auto" HelpText=""/>
        <JsonPath Expr="invoice_prefix" Id="InvoicePrefix" Title="Invoice Prefix" Converter="String" HelpText=""/>
        <JsonPath Expr="metadata" Id="Metadata" Title="Metadata" Converter="String" HelpText="" Checked="false"/>
        <JsonPath Expr="shipping" Id="Shipping" Title="Shipping" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RestConnector Id="CustomersHidden" Title="CustomersHidden" Hidden="True" HelpUrl="https://stripe.com/docs/api#list_customers">
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/customers?
        limit=100
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="email" Id="Email" Title="Email" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RestConnector Id="Charges" Title="Charges" HelpUrl="https://stripe.com/docs/api#list_charges">
    <Parameters>
      <Text Id="Customer" Title="Filter by customer" Select.Connector="CustomersHidden" Select.IdField="Id" Select.TitleField="Email" Required="false" HelpText=""/>
      <!--<Select Id="Source" Title="Charge Source" Required="false" DefaultValue="all">-->
        <!--<DataSource>-->
          <!--<Resource Id="ChargeSources"/>-->
        <!--</DataSource>-->
      <!--</Select>-->
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/charges?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="amount" Id="Amount" Title="Amount" Converter="Double" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="available_on" Id="AvailableOn" Title="Available On" Converter="DateTime" Converter.SourceFormat="Unix"/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix"/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="exchange_rate" Id="ExchangeRate" Title="Exchange Rate" Converter="Double" HelpText=""/>
        <JsonPath Expr="fee" Id="Fee" Title="Fee" Converter="Double" HelpText=""/>
        <JsonPath Expr="net" Id="Net" Title="Net" Converter="Double" HelpText=""/>
        <JsonPath Expr="source" Id="Source" Title="Source" Converter="String" HelpText="" Checked="false"/>
        <JsonPath Expr="status" Id="Status" Title="Status" Converter="String" HelpText=""/>
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Disputes" Title="Disputes" HelpUrl="https://stripe.com/docs/api#list_disputes">
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/disputes?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="amount" Id="Amount" Title="Amount" Converter="Double" HelpText=""/>
        <JsonPath Expr="balance_transaction" Id="BalanceTransaction" Title="Balance Transaction" Converter="String" HelpText=""/>
        <JsonPath Expr="charge" Id="Charge" Title="Charge Id" Converter="String" HelpText=""/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="is_charge_refundable" Id="IsChargeRefundable" Title="Charge is Refundable" Converter="Bool" HelpText=""/>
        <JsonPath Expr="evidence_details.due_by" Id="EvidenceDetailsDueBy" Title="Evidence Due By" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="evidence_details.has_evidence" Id="EvidenceDetailsHasEvidence" Title="Has Evidence" Converter="Bool" HelpText=""/>
        <JsonPath Expr="evidence_details.past_due" Id="EvidenceDetailsPastDue" Title="Evidence Past Due" Converter="Bool" HelpText=""/>
        <JsonPath Expr="evidence_details.submission_count" Id="EvidenceDetailsSubmissionCount" Title="Evidence Details Submission Count" Converter="" HelpText=""/>
        <JsonPath Expr="evidence.access_activity_log" Id="EvidenceAccessActivityLog" Title="Access Activity Log" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.billing_address" Id="EvidenceBillingAddress" Title="Billing Address" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.cancellation_policy" Id="EvidenceCancellationPolicy" Title="Cancellation Policy" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.cancellation_policy_disclosure" Id="EvidenceCancellationPolicyDisclosure" Title="Cancellation Policy Disclosure" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.cancellation_rebuttal" Id="EvidenceCancellationRebuttal" Title="ECancellation Rebuttal" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.customer_communication" Id="EvidenceCustomerCommunication" Title="Customer Communication" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.customer_email_address" Id="EvidenceCustomerEmailAddress" Title="Customer Email Address" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.customer_name" Id="EvidenceCustomerName" Title="Customer Name" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.customer_purchase_ip" Id="EvidenceCustomerPurchaseIp" Title="Customer Purchase Ip" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.customer_signature" Id="EvidenceCustomerSignature" Title="Customer Signature" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.duplicate_charge_documentation" Id="EvidenceDuplicateChargeDocumentation" Title="Duplicate Charge Documentation" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.duplicate_charge_explanation" Id="EvidenceDuplicateChargeExplanation" Title="Duplicate Charge Explanation" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.duplicate_charge_id" Id="EvidenceDuplicateChargeId" Title="Duplicate Charge Id" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.product_description" Id="EvidenceProductDescription" Title="Product Description" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.receipt" Id="EvidenceReceipt" Title="Receipt" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.refund_policy" Id="EvidenceRefundPolicy" Title="Refund Policy" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.refund_policy_disclosure" Id="EvidenceRefundPolicyDisclosure" Title="Refund Policy Disclosure" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.refund_refusal_explanation" Id="EvidenceRefundRefusalExplanation" Title="Refund Refusal Explanation" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.service_date" Id="EvidenceServiceDate" Title="Service Date" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.service_documentation" Id="EvidenceServiceDocumentation" Title="Service Documentation" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.shipping_address" Id="EvidenceShippingAddress" Title="Shipping Address" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.shipping_carrier" Id="EvidenceShippingCarrier" Title="EShipping Carrier" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.shipping_date" Id="EvidenceShippingDate" Title="Shipping Date" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.shipping_documentation" Id="EvidenceShippingDocumentation" Title="Shipping Documentation" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.shipping_tracking_number" Id="EvidenceShippingTrackingNumber" Title="Shipping Tracking Number" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.uncategorized_file" Id="EvidenceUncategorizedFile" Title="Uncategorized File" Converter="String" Checked="false" HelpText=""/>
        <JsonPath Expr="evidence.uncategorized_text" Id="EvidenceUncategorizedText" Title="Uncategorized Text" Converter="String" Checked="false" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Events" Title="Events" HelpUrl="https://stripe.com/docs/api/curl#list_events" HelpText="List events, going back up to 30 days.">
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/events?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="id" Title="Id"/>
        <JsonPath Expr="data.object.object" Id="Object" Title="Event Type"/>
        <JsonPath Expr="data.object.customer" Id="CustomerId" Title="Customer Id"/>
        <JsonPath Expr="data.object.currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="data.object.customer" Id="Customer" Title="Customer" Converter="String" HelpText=""/>
        <JsonPath Expr="data.object.date" Id="Date" Title="Date" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="data.object.description" Id="Description" Title="Description" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Payouts" Title="Payouts" HelpUrl="https://stripe.com/docs/api/curl#list_payouts" HelpText="Returns a list of existing payouts sent to third-party bank accounts or that Stripe has sent you.">
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/payouts?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="object" Id="Object" Title="Object" Converter="String" HelpText=""/>
        <JsonPath Expr="amount" Id="Amount" Title="Amount" Converter="Double" HelpText=""/>
        <JsonPath Expr="arrival_date" Id="ArrivalDate" Title="Arrival Date" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="automatic" Id="Automatic" Title="Automatic" Converter="Bool" HelpText=""/>
        <JsonPath Expr="balance_transaction" Id="BalanceTransaction" Title="Balance Transaction" Converter="String" HelpText=""/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="destination" Id="Destination" Title="Destination" Converter="String" HelpText=""/>
        <JsonPath Expr="failure_balance_transaction" Id="FailureBalanceTransaction" Title="Failure Balance Transaction" Converter="String" HelpText=""/>
        <JsonPath Expr="failure_code" Id="FailureCode" Title="Failure Code" Converter="String" HelpText=""/>
        <JsonPath Expr="failure_message" Id="FailureMessage" Title="Failure Message" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Products" Title="Products" HelpUrl="https://stripe.com/docs/api/curl#list_products" HelpText="Returns a list of your products.">
    <Parameters>
      <Checkbox Id="Active" Title="Only return active products" DefaultValue="False" HelpText=""/>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/products?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="active" Id="Active" Title="Active" Converter="Bool" HelpText=""/>
        <JsonPath Expr="attributes" Id="Attributes" Title="Attributes" Converter="String" HelpText=""/>
        <JsonPath Expr="caption" Id="Caption" Title="Caption" Converter="String" HelpText=""/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="deactivate_on" Id="DeactivateOn" Title="Deactivate On" Converter="String" HelpText=""/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <JsonPath Expr="package_dimensions" Id="PackageDimensions" Title="Package Dimensions" Converter="String" HelpText=""/>
        <JsonPath Expr="shippable" Id="Shippable" Title="Shippable" Converter="Bool" HelpText=""/>
        <JsonPath Expr="type" Id="Type" Title="Type" Converter="String" HelpText=""/>
        <JsonPath Expr="updated" Id="Updated" Title="Updated" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="url" Id="Url" Title="Url" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Refunds" Title="Refunds" HelpUrl="https://stripe.com/docs/api/curl#list_refunds" HelpText="Returns a list of all refunds youâ€™ve previously created.">
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/refunds?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="amount" Id="Amount" Title="Amount" Converter="Double" HelpText=""/>
        <JsonPath Expr="balance_transaction" Id="BalanceTransaction" Title="Balance Transaction" Converter="String" HelpText=""/>
        <JsonPath Expr="charge" Id="Charge" Title="Charge" Converter="String" HelpText=""/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="metadata" Id="Metadata" Title="Metadata" Converter="String" HelpText=""/>
        <JsonPath Expr="reason" Id="Reason" Title="Reason" Converter="String" HelpText=""/>
        <JsonPath Expr="receipt_number" Id="ReceiptNumber" Title="Receipt Number" Converter="String" HelpText=""/>
        <JsonPath Expr="status" Id="Status" Title="Status" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="BankAccounts" Title="Customer Bank Accounts" HelpUrl="https://stripe.com/docs/api/curl#customer_list_bank_accounts" HelpText="A list of the bank accounts belonging to a Customer.">
    <Parameters>
      <Text Id="Customer" Title="Customer Id" Select.Connector="CustomersHidden" Select.IdField="Id" Select.TitleField="Email" Required="true" HelpText=""/>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/customers/@(Model.Customer)/sources?object=bank_account
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="account_holder_name" Id="AccountHolderName" Title="Holder Name" Converter="String" HelpText=""/>
        <JsonPath Expr="account_holder_type" Id="AccountHolderType" Title="Holder Type" Converter="String" HelpText=""/>
        <JsonPath Expr="bank_name" Id="BankName" Title="Bank Name" Converter="String" HelpText=""/>
        <JsonPath Expr="country" Id="Country" Title="Country" Converter="String" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="customer" Id="Customer" Title="Customer" Converter="String" HelpText=""/>
        <JsonPath Expr="fingerprint" Id="Fingerprint" Title="Fingerprint" Converter="String" HelpText=""/>
        <JsonPath Expr="last4" Id="Last4" Title="Last4" Converter="String" HelpText=""/>
        <JsonPath Expr="metadata" Id="Metadata" Title="Metadata" Converter="String" HelpText=""/>
        <JsonPath Expr="routing_number" Id="RoutingNumber" Title="Routing Number" Converter="String" HelpText=""/>
        <JsonPath Expr="status" Id="Status" Title="Status" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Coupons" Title="Coupons" HelpUrl="https://stripe.com/docs/api/curl#list_coupons" HelpText="Returns a list of your coupons.">
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/coupons?
        limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="amount_off" Id="AmountOff" Title="Amount Off" Converter="Double" HelpText=""/>
        <JsonPath Expr="created" Id="Created" Title="Created" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="duration" Id="Duration" Title="Duration" Converter="String" HelpText=""/>
        <JsonPath Expr="duration_in_months" Id="DurationInMonths" Title="Duration In Months" Converter="Int" HelpText=""/>
        <JsonPath Expr="max_redemptions" Id="MaxRedemptions" Title="Max Redemptions" Converter="Double" HelpText=""/>
        <JsonPath Expr="name" Id="Name" Title="Name" Converter="String" HelpText=""/>
        <JsonPath Expr="percent_off" Id="PercentOff" Title="Percent Off" Converter="Double" HelpText=""/>
        <JsonPath Expr="redeem_by" Id="RedeemBy" Title="Redeem By" Converter="String" HelpText=""/>
        <JsonPath Expr="times_redeemed" Id="TimesRedeemed" Title="Times Redeemed" Converter="Double" HelpText=""/>
        <JsonPath Expr="valid" Id="Valid" Title="Valid" Converter="Bool" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="Invoices" Title="Invoices" HelpUrl="https://stripe.com/docs/api/curl#list_invoices" HelpText="List all invoices, or list the invoices for a specific customer.">
    <Parameters>
      <Text Id="Customer" Title="Customer Id" Select.Connector="CustomersHidden" Select.IdField="Id" Select.TitleField="Email" Required="false" HelpText=""/>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/invoices?
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        @if(!string.IsNullOrEmpty(Model.Customer))
        {
          @: &customer=@(Model.Customer)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="object" Id="Object" Title="Object" Converter="String" HelpText=""/>
        <JsonPath Expr="amount_due" Id="AmountDue" Title="Amount Due" Converter="Double" HelpText=""/>
        <JsonPath Expr="amount_paid" Id="AmountPaid" Title="Amount Paid" Converter="Double" HelpText=""/>
        <JsonPath Expr="amount_remaining" Id="AmountRemaining" Title="Amount Remaining" Converter="Double" HelpText=""/>
        <JsonPath Expr="application_fee" Id="ApplicationFee" Title="Application Fee" Converter="Auto" HelpText=""/>
        <JsonPath Expr="attempt_count" Id="AttemptCount" Title="Attempt Count" Converter="Int" HelpText=""/>
        <JsonPath Expr="attempted" Id="Attempted" Title="Attempted" Converter="Bool" HelpText=""/>
        <JsonPath Expr="auto_advance" Id="AutoAdvance" Title="Auto Advance" Converter="Bool" HelpText=""/>
        <JsonPath Expr="billing" Id="Billing" Title="Billing" Converter="String" HelpText=""/>
        <JsonPath Expr="billing_reason" Id="BillingReason" Title="Billing Reason" Converter="String" HelpText=""/>
        <JsonPath Expr="charge" Id="Charge" Title="Charge" Converter="String" HelpText=""/>
        <JsonPath Expr="closed" Id="Closed" Title="Closed" Converter="Bool" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="customer" Id="Customer" Title="Customer" Converter="String" HelpText=""/>
        <JsonPath Expr="date" Id="Date" Title="Date" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="discount" Id="Discount" Title="Discount" Converter="Auto" HelpText=""/>
        <JsonPath Expr="due_date" Id="DueDate" Title="Due Date" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="ending_balance" Id="EndingBalance" Title="Ending Balance" Converter="Double" HelpText=""/>
        <JsonPath Expr="forgiven" Id="Forgiven" Title="Forgiven" Converter="Bool" HelpText=""/>
        <JsonPath Expr="hosted_invoice_url" Id="HostedInvoiceUrl" Title="Invoice Url" Converter="String" HelpText=""/>
        <JsonPath Expr="invoice_pdf" Id="InvoicePdf" Title="Invoice PDF Url" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="InvoicesHidden" Title="Invoices Hidden" HelpUrl="https://stripe.com/docs/api/curl#list_invoices" Hidden="True">
    <Parameters>
      <Text Id="Customer" Title="Customer Id" Select.Connector="CustomersHidden" Select.IdField="Id" Select.TitleField="Email" Required="false" HelpText=""/>
    </Parameters>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/invoices?
        &limit=100
        @if(!string.IsNullOrEmpty(Model.Customer))
        {
          @: &customer=@(Model.Customer)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RestConnector Id="InvoiceItems" Title="Invoice Items" HelpUrl="https://stripe.com/docs/api/curl#list_invoices" HelpText="Returns a list of your invoice items.">
    <Parameters>
      <Text Id="Customer" Title="Filter by customer Id" Select.Connector="CustomersHidden" Select.IdField="Id" Select.TitleField="Email" Required="false" HelpText=""/>
      <Text Id="Invoice" Title="Filter by Invoice Id" Select.Connector="InvoicesHidden" Select.IdField="Id" Select.TitleField="Description" Required="false" HelpText=""/>
    </Parameters>
    <Paging PageSize="100">
      <Parse>
        <Xpath Id="NextPageToken" Expr="//data[last()]/id"/>
      </Parse>
    </Paging>
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://api.stripe.com/v1/invoiceitems?
        &limit=@(Model.PageCursor.NextTake)
        @if(Model.PageCursor.Page != 0)
        {
          @: &starting_after=@Model.NextPageToken
        }
        @if(!string.IsNullOrEmpty(Model.Customer) && string.IsNullOrEmpty(Model.Invoice))
        {
          @: &customer=@(Model.Customer)
        }
        @if(!string.IsNullOrEmpty(Model.Invoice))
        {
          @: &invoice=@(Model.Invoice)
        }
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.data.*">
        <JsonPath Expr="id" Id="Id" Title="Id" Converter="String" HelpText=""/>
        <JsonPath Expr="amount" Id="Amount" Title="Amount" Converter="Int" HelpText=""/>
        <JsonPath Expr="currency" Id="Currency" Title="Currency" Converter="String" HelpText=""/>
        <JsonPath Expr="customer" Id="Customer" Title="Customer" Converter="String" HelpText=""/>
        <JsonPath Expr="date" Id="Date" Title="Date" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="description" Id="Description" Title="Description" Converter="String" HelpText=""/>
        <JsonPath Expr="discountable" Id="Discountable" Title="Discountable" Converter="Bool" HelpText=""/>
        <JsonPath Expr="invoice" Id="Invoice" Title="Invoice" Converter="String" HelpText=""/>
        <JsonPath Expr="metadata" Id="Metadata" Title="Metadata" Converter="String" Checked="False" HelpText=""/>
        <JsonPath Expr="period.start" Id="PeriodStart" Title="Period Start" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="period.end" Id="PeriodEnd" Title="Period End" Converter="DateTime" Converter.SourceFormat="Unix" HelpText=""/>
        <JsonPath Expr="plan" Id="Plan" Title="Plan" Converter="String" HelpText=""/>
        <JsonPath Expr="proration" Id="Proration" Title="Proration" Converter="Bool" HelpText=""/>
        <JsonPath Expr="quantity" Id="Quantity" Title="Quantity" Converter="Int" HelpText=""/>
        <JsonPath Expr="subscription" Id="Subscription" Title="Subscription" Converter="String" HelpText=""/>
        <JsonPath Expr="unit_amount" Id="UnitAmount" Title="Unit Amount" Converter="Int" HelpText=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Error"/>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[
    string CreateBasicAuth()
    {
      return Convert.ToBase64String(ASCIIEncoding.ASCII.GetBytes(Model.SecretKey));
    }
    ]]>
  </RazorFunctions>

</Suite>