<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="CRM" Title="Salesforce" Id="Salesforce" RequireVersion="7.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Salesforce.xml" HelpUrl="http://seotoolsforexcel.com/salesforce/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/salesforce/">
    <Text Id="Instance" Title="Server Instance" Required="true" HelpUrl="http://seotoolsforexcel.com/salesforce"/>
  </Settings>

  <Resources>
    <Resource Id="Headers">
      <HttpSettings>
        <RequestHeaders>
          <Header Name='Authorization'><![CDATA[Bearer @(Model.Authenticator.Token)]]></Header>
        </RequestHeaders>
      </HttpSettings>
    </Resource>
    <Resource Id="Fail">
      <Fail>
        <JsonPath Expr="$..message"/>
      </Fail>
    </Resource>
  </Resources>

  <DefaultOAuthAuthenticator StayAuthenticated="true" TokenName="access_token" AuthUrl="https://login.salesforce.com/services/oauth2/authorize?response_type=token&amp;client_id=3MVG9TSaZ8P6zP1qYjMfc285hduryOwlrl9Uz_cMlqFmvRg7TVhR4XCuSxITU_BS.UIT0DPPSPZt2UANYCzSn&amp;redirect_uri={0}"/>

  <RestConnector Id="Accounts" Title="Accounts">
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://@(Model.Instance).salesforce.com/services/data/v42.0/query/?q=SELECT+
        Id,name,BillingStreet,BillingCity,BillingState,BillingPostalCode,BillingCountry,ShippingStreet,
        ShippingCity,ShippingState,ShippingPostalCode,Phone,Fax,AccountNumber,Website,PhotoUrl,Sic,Industry,
        AnnualRevenue,Ownership,Description,Rating,CreatedDate,LastModifiedDate
        +from+Account
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.records.*">
        <JsonPath Expr="Id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="Name" Id="Name" Title="Name" Converter="String"/>
        <JsonPath Expr="Phone" Id="Phone" Title="Phone" Converter="String"/>
        <JsonPath Expr="BillingStreet" Id="BillingStreet" Title="BillingStreet" Converter="String"/>
        <JsonPath Expr="BillingCity" Id="BillingCity" Title="BillingCity" Converter="String"/>
        <JsonPath Expr="BillingState" Id="BillingState" Title="BillingState" Converter="String"/>
        <JsonPath Expr="BillingPostalCode" Id="BillingPostalCode" Title="BillingPostalCode" Converter="String"/>
        <JsonPath Expr="BillingCountry" Id="BillingCountry" Title="BillingCountry" Converter="String"/>
        <JsonPath Expr="ShippingStreet" Id="ShippingStreet" Title="ShippingStreet" Converter="String"/>
        <JsonPath Expr="ShippingCity" Id="ShippingCity" Title="ShippingCity" Converter="String"/>
        <JsonPath Expr="ShippingState" Id="ShippingState" Title="ShippingState" Converter="String"/>
        <JsonPath Expr="ShippingPostalCode" Id="ShippingPostalCode" Title="ShippingPostalCode" Converter="String"/>
        <JsonPath Expr="Phone" Id="Phone" Title="Phone" Converter="String"/>
        <JsonPath Expr="Fax" Id="Fax" Title="Fax" Converter="String"/>
        <JsonPath Expr="AccountNumber" Id="AccountNumber" Title="AccountNumber" Converter="String"/>
        <JsonPath Expr="Website" Id="Website" Title="Website" Converter="String"/>
        <JsonPath Expr="PhotoUrl" Id="PhotoUrl" Title="PhotoUrl" Converter="String"/>
        <JsonPath Expr="Sic" Id="Sic" Title="Sic" Converter="String"/>
        <JsonPath Expr="Industry" Id="Industry" Title="Industry" Converter="String"/>
        <JsonPath Expr="AnnualRevenue" Id="AnnualRevenue" Title="AnnualRevenue" Converter="String"/>
        <JsonPath Expr="NumberOfEmploeyees" Id="NumberOfEmploeyees" Title="NumberOfEmploeyees" Converter="String"/>
        <JsonPath Expr="Ownership" Id="Ownership" Title="Ownership" Converter="String"/>
        <JsonPath Expr="Description" Id="Description" Title="Description" Converter="String"/>
        <JsonPath Expr="Rating" Id="Rating" Title="Rating" Converter="String"/>
        <JsonPath Expr="CreatedDate" Id="CreatedDate" Title="CreatedDate" Converter="String"/>
        <JsonPath Expr="LastModifiedDate" Id="LastModifiedDate" Title="LastModifiedDate" Converter="String"/>
        <JsonPath Expr="UpsellOpportunity" Id="UpsellOpportunity" Title="UpsellOpportunity" Converter="String"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="Campaigns" Title="Campaigns">
    <Fetch>
      <Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        https://@(Model.Instance).salesforce.com/services/data/v42.0/query/?q=SELECT+Id,Name,ParentId,Type,Status,StartDate,EndDate,
        ExpectedRevenue,BudgetedCost,ActualCost,ExpectedResponse,NumberSent,IsActive,Description,NumberOfLeads,
        NumberOfConvertedLeads,NumberOfContacts,NumberOfResponses,NumberOfOpportunities,
        NumberOfWonOpportunities,AmountAllOpportunities,AmountWonOpportunities,CreatedDate,
        LastModifiedDate+FROM+Campaign
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.records.*">
        <JsonPath Expr="Id" Id="Id" Title="Id" Converter="String"/>
        <JsonPath Expr="Name" Id="Name" Title="Name" Converter="String"/>
        <JsonPath Expr="ParentId" Id="ParentId" Title="ParentId" Converter="String" Checked="false"/>
        <JsonPath Expr="Type" Id="Type" Title="Type" Converter="String"/>
        <JsonPath Expr="Status" Id="Status" Title="Status" Converter="String"/>
        <JsonPath Expr="StartDate" Id="StartDate" Title="StartDate" Converter="DateTime"/>
        <JsonPath Expr="EndDate" Id="EndDate" Title="EndDate" Converter="DateTime"/>
        <JsonPath Expr="ExpectedRevenue" Id="ExpectedRevenue" Title="Expected Revenue" Converter="Int"/>
        <JsonPath Expr="BudgetedCost" Id="BudgetedCost" Title="Budgeted Cost" Converter="Int"/>
        <JsonPath Expr="ActualCost" Id="ActualCost" Title="Actual Cost" Converter="Int"/>
        <JsonPath Expr="ExpectedResponse" Id="ExpectedResponse" Title="Expected Response" Converter="Int"/>
        <JsonPath Expr="NumberSent" Id="NumberSent" Title="Sent" Converter="Int"/>
        <JsonPath Expr="IsActive" Id="IsActive" Title="IsActive" Converter="Bool"/>
        <JsonPath Expr="Description" Id="Description" Title="Description" Converter="String"/>
        <JsonPath Expr="NumberOfLeads" Id="NumberOfLeads" Title="Leads" Converter="Int"/>
        <JsonPath Expr="NumberOfConvertedLeads" Id="NumberOfConvertedLeads" Title="Converted Leads" Converter="Int"/>
        <JsonPath Expr="NumberOfContacts" Id="NumberOfContacts" Title="Contacts" Converter="Int"/>
        <JsonPath Expr="NumberOfResponses" Id="NumberOfResponses" Title="Responses" Converter="Int"/>
        <JsonPath Expr="NumberOfOpportunities" Id="NumberOfOpportunities" Title="Opportunities" Converter="Auto" Checked="False"/>
        <JsonPath Expr="NumberOfWonOpportunities" Id="NumberOfWonOpportunities" Title="Won Opportunities" Converter="Auto" Checked="false"/>
        <JsonPath Expr="AmountAllOpportunities" Id="AmountAllOpportunities" Title="Amount All Opportunities" Converter="Auto" Checked="false"/>
        <JsonPath Expr="AmountWonOpportunities" Id="AmountWonOpportunities" Title="Amount Won Opportunities" Converter="Auto" Checked="false"/>
        <JsonPath Expr="CreatedDate" Id="CreatedDate" Title="CreatedDate" Converter="DateTime"/>
        <JsonPath Expr="LastModifiedDate" Id="LastModifiedDate" Title="LastModifiedDate" Converter="DateTime"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[
    ]]>
  </RazorFunctions>
</Suite>