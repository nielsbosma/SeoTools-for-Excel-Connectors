<?xml version="1.0" encoding="utf-8" ?>
<Suite Category="CRM" Title="Salesforce" Id="Salesforce" RequireVersion="7.0" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Salesforce.xml" HelpUrl="http://seotoolsforexcel.com/salesforce/">

  <Author Name="Dovydas Meilunas" Url="https://github.com/dovydasm"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/salesforce/">
    <Text Id="Instance" Title="Server Instance" Required="true" HelpUrl="http://seotoolsforexcel.com/salesforce"/>
  </Settings>

  <DefaultOAuthAuthenticator StayAuthenticated="true" TokenName="access_token" AuthUrl="https://login.salesforce.com/services/oauth2/authorize?response_type=token&amp;client_id=3MVG9TSaZ8P6zP1qYjMfc285hduryOwlrl9Uz_cMlqFmvRg7TVhR4XCuSxITU_BS.UIT0DPPSPZt2UANYCzSn&amp;redirect_uri={0}"/>

  <RestConnector Id="Sobjects" Title="SObjects">
    <Fetch>
      <HttpSettings>
        <RequestHeaders>
          <Header Name='Authorization'><![CDATA[Bearer @(Model.Authenticator.Token)]]></Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
        https://@(Model.Instance).salesforce.com/services/data/v42.0/sobjects
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.sobjects.*">
      <JsonPath Expr="label" Id="Label" Title="Label" Converter="Auto" HelpText=""/>
      </JsonPath>
    </Parse>
  </RestConnector>

  <RazorFunctions>
    <![CDATA[
    ]]>
  </RazorFunctions>
</Suite>