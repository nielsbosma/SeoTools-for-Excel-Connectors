<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="TimeZoneDB" Id="TimeZoneDB" RequireVersion="8.1.20" Category="Locations" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/TimeZoneDB.xml" HelpUrl="http://seotoolsforexcel.com/TimeZoneDB/" HelpText="Documentation">

  <Author Name="Victor Sandberg" Url="http://community.seotoolsforexcel.com/users/diskborste/activity"/>

  <Settings HelpText="What's this?" HelpUrl="http://seotoolsforexcel.com/TimeZoneDB/">
    <Text Id="ApiKey" Title="API Key" Required="true" HelpUrl="http://seotoolsforexcel.com/TimeZoneDB/"/>
  </Settings>

  <Resources>
    <Resource Id="TimeZones">
    <Item Id="Asia/Kabul" Title="Asia/Kabul"/>
      <Item Id="Europe/Mariehamn" Title="Europe/Mariehamn"/>
      <Item Id="Europe/Tirane" Title="Europe/Tirane"/>
      <Item Id="Africa/Algiers" Title="Africa/Algiers"/>
      <Item Id="Pacific/Pago_Pago" Title="Pacific/Pago_Pago"/>
      <Item Id="Europe/Andorra" Title="Europe/Andorra"/>
      <Item Id="Africa/Luanda" Title="Africa/Luanda"/>
      <Item Id="America/Anguilla" Title="America/Anguilla"/>
      <Item Id="Antarctica/Casey" Title="Antarctica/Casey"/>
      <Item Id="Antarctica/Davis" Title="Antarctica/Davis"/>
      <Item Id="Antarctica/DumontDUrville" Title="Antarctica/DumontDUrville"/>
      <Item Id="Antarctica/Mawson" Title="Antarctica/Mawson"/>
      <Item Id="Antarctica/McMurdo" Title="Antarctica/McMurdo"/>
      <Item Id="Antarctica/Palmer" Title="Antarctica/Palmer"/>
      <Item Id="Antarctica/Rothera" Title="Antarctica/Rothera"/>
      <Item Id="Antarctica/Syowa" Title="Antarctica/Syowa"/>
      <Item Id="Antarctica/Troll" Title="Antarctica/Troll"/>
      <Item Id="Antarctica/Vostok" Title="Antarctica/Vostok"/>
      <Item Id="America/Antigua" Title="America/Antigua"/>
      <Item Id="America/Argentina/Buenos_Aires" Title="America/Argentina/Buenos_Aires"/>
      <Item Id="America/Argentina/Catamarca" Title="America/Argentina/Catamarca"/>
      <Item Id="America/Argentina/Cordoba" Title="America/Argentina/Cordoba"/>
      <Item Id="America/Argentina/Jujuy" Title="America/Argentina/Jujuy"/>
      <Item Id="America/Argentina/La_Rioja" Title="America/Argentina/La_Rioja"/>
      <Item Id="America/Argentina/Mendoza" Title="America/Argentina/Mendoza"/>
      <Item Id="America/Argentina/Rio_Gallegos" Title="America/Argentina/Rio_Gallegos"/>
      <Item Id="America/Argentina/Salta" Title="America/Argentina/Salta"/>
      <Item Id="America/Argentina/San_Juan" Title="America/Argentina/San_Juan"/>
      <Item Id="America/Argentina/San_Luis" Title="America/Argentina/San_Luis"/>
      <Item Id="America/Argentina/Tucuman" Title="America/Argentina/Tucuman"/>
      <Item Id="America/Argentina/Ushuaia" Title="America/Argentina/Ushuaia"/>
      <Item Id="Asia/Yerevan" Title="Asia/Yerevan"/>
      <Item Id="America/Aruba" Title="America/Aruba"/>
      <Item Id="Antarctica/Macquarie" Title="Antarctica/Macquarie"/>
      <Item Id="Australia/Adelaide" Title="Australia/Adelaide"/>
      <Item Id="Australia/Brisbane" Title="Australia/Brisbane"/>
      <Item Id="Australia/Broken_Hill" Title="Australia/Broken_Hill"/>
      <Item Id="Australia/Currie" Title="Australia/Currie"/>
      <Item Id="Australia/Darwin" Title="Australia/Darwin"/>
      <Item Id="Australia/Eucla" Title="Australia/Eucla"/>
      <Item Id="Australia/Hobart" Title="Australia/Hobart"/>
      <Item Id="Australia/Lindeman" Title="Australia/Lindeman"/>
      <Item Id="Australia/Lord_Howe" Title="Australia/Lord_Howe"/>
      <Item Id="Australia/Melbourne" Title="Australia/Melbourne"/>
      <Item Id="Australia/Perth" Title="Australia/Perth"/>
      <Item Id="Australia/Sydney" Title="Australia/Sydney"/>
      <Item Id="Europe/Vienna" Title="Europe/Vienna"/>
      <Item Id="Asia/Baku" Title="Asia/Baku"/>
      <Item Id="America/Nassau" Title="America/Nassau"/>
      <Item Id="Asia/Bahrain" Title="Asia/Bahrain"/>
      <Item Id="Asia/Dhaka" Title="Asia/Dhaka"/>
      <Item Id="America/Barbados" Title="America/Barbados"/>
      <Item Id="Europe/Minsk" Title="Europe/Minsk"/>
      <Item Id="Europe/Brussels" Title="Europe/Brussels"/>
      <Item Id="America/Belize" Title="America/Belize"/>
      <Item Id="Africa/Porto-Novo" Title="Africa/Porto-Novo"/>
      <Item Id="Atlantic/Bermuda" Title="Atlantic/Bermuda"/>
      <Item Id="Asia/Thimphu" Title="Asia/Thimphu"/>
      <Item Id="America/La_Paz" Title="America/La_Paz"/>
      <Item Id="America/Kralendijk" Title="America/Kralendijk"/>
      <Item Id="Europe/Sarajevo" Title="Europe/Sarajevo"/>
      <Item Id="Africa/Gaborone" Title="Africa/Gaborone"/>
      <Item Id="America/Araguaina" Title="America/Araguaina"/>
      <Item Id="America/Bahia" Title="America/Bahia"/>
      <Item Id="America/Belem" Title="America/Belem"/>
      <Item Id="America/Boa_Vista" Title="America/Boa_Vista"/>
      <Item Id="America/Campo_Grande" Title="America/Campo_Grande"/>
      <Item Id="America/Cuiaba" Title="America/Cuiaba"/>
      <Item Id="America/Eirunepe" Title="America/Eirunepe"/>
      <Item Id="America/Fortaleza" Title="America/Fortaleza"/>
      <Item Id="America/Maceio" Title="America/Maceio"/>
      <Item Id="America/Manaus" Title="America/Manaus"/>
      <Item Id="America/Noronha" Title="America/Noronha"/>
      <Item Id="America/Porto_Velho" Title="America/Porto_Velho"/>
      <Item Id="America/Recife" Title="America/Recife"/>
      <Item Id="America/Rio_Branco" Title="America/Rio_Branco"/>
      <Item Id="America/Santarem" Title="America/Santarem"/>
      <Item Id="America/Sao_Paulo" Title="America/Sao_Paulo"/>
      <Item Id="Indian/Chagos" Title="Indian/Chagos"/>
      <Item Id="America/Tortola" Title="America/Tortola"/>
      <Item Id="Asia/Brunei" Title="Asia/Brunei"/>
      <Item Id="Europe/Sofia" Title="Europe/Sofia"/>
      <Item Id="Africa/Ouagadougou" Title="Africa/Ouagadougou"/>
      <Item Id="Africa/Bujumbura" Title="Africa/Bujumbura"/>
      <Item Id="Asia/Phnom_Penh" Title="Asia/Phnom_Penh"/>
      <Item Id="Africa/Douala" Title="Africa/Douala"/>
      <Item Id="America/Atikokan" Title="America/Atikokan"/>
      <Item Id="America/Blanc-Sablon" Title="America/Blanc-Sablon"/>
      <Item Id="America/Cambridge_Bay" Title="America/Cambridge_Bay"/>
      <Item Id="America/Creston" Title="America/Creston"/>
      <Item Id="America/Dawson" Title="America/Dawson"/>
      <Item Id="America/Dawson_Creek" Title="America/Dawson_Creek"/>
      <Item Id="America/Edmonton" Title="America/Edmonton"/>
      <Item Id="America/Fort_Nelson" Title="America/Fort_Nelson"/>
      <Item Id="America/Glace_Bay" Title="America/Glace_Bay"/>
      <Item Id="America/Goose_Bay" Title="America/Goose_Bay"/>
      <Item Id="America/Halifax" Title="America/Halifax"/>
      <Item Id="America/Inuvik" Title="America/Inuvik"/>
      <Item Id="America/Iqaluit" Title="America/Iqaluit"/>
      <Item Id="America/Moncton" Title="America/Moncton"/>
      <Item Id="America/Nipigon" Title="America/Nipigon"/>
      <Item Id="America/Pangnirtung" Title="America/Pangnirtung"/>
      <Item Id="America/Rainy_River" Title="America/Rainy_River"/>
      <Item Id="America/Rankin_Inlet" Title="America/Rankin_Inlet"/>
      <Item Id="America/Regina" Title="America/Regina"/>
      <Item Id="America/Resolute" Title="America/Resolute"/>
      <Item Id="America/St_Johns" Title="America/St_Johns"/>
      <Item Id="America/Swift_Current" Title="America/Swift_Current"/>
      <Item Id="America/Thunder_Bay" Title="America/Thunder_Bay"/>
      <Item Id="America/Toronto" Title="America/Toronto"/>
      <Item Id="America/Vancouver" Title="America/Vancouver"/>
      <Item Id="America/Whitehorse" Title="America/Whitehorse"/>
      <Item Id="America/Winnipeg" Title="America/Winnipeg"/>
      <Item Id="America/Yellowknife" Title="America/Yellowknife"/>
      <Item Id="Atlantic/Cape_Verde" Title="Atlantic/Cape_Verde"/>
      <Item Id="America/Cayman" Title="America/Cayman"/>
      <Item Id="Africa/Bangui" Title="Africa/Bangui"/>
      <Item Id="Africa/Ndjamena" Title="Africa/Ndjamena"/>
      <Item Id="America/Santiago" Title="America/Santiago"/>
      <Item Id="Pacific/Easter" Title="Pacific/Easter"/>
      <Item Id="Asia/Shanghai" Title="Asia/Shanghai"/>
      <Item Id="Asia/Urumqi" Title="Asia/Urumqi"/>
      <Item Id="Indian/Christmas" Title="Indian/Christmas"/>
      <Item Id="Indian/Cocos" Title="Indian/Cocos"/>
      <Item Id="America/Bogota" Title="America/Bogota"/>
      <Item Id="Indian/Comoro" Title="Indian/Comoro"/>
      <Item Id="Pacific/Rarotonga" Title="Pacific/Rarotonga"/>
      <Item Id="America/Costa_Rica" Title="America/Costa_Rica"/>
      <Item Id="Europe/Zagreb" Title="Europe/Zagreb"/>
      <Item Id="America/Havana" Title="America/Havana"/>
      <Item Id="America/Curacao" Title="America/Curacao"/>
      <Item Id="Asia/Famagusta" Title="Asia/Famagusta"/>
      <Item Id="Asia/Nicosia" Title="Asia/Nicosia"/>
      <Item Id="Europe/Prague" Title="Europe/Prague"/>
      <Item Id="Africa/Kinshasa" Title="Africa/Kinshasa"/>
      <Item Id="Africa/Lubumbashi" Title="Africa/Lubumbashi"/>
      <Item Id="Europe/Copenhagen" Title="Europe/Copenhagen"/>
      <Item Id="Africa/Djibouti" Title="Africa/Djibouti"/>
      <Item Id="America/Dominica" Title="America/Dominica"/>
      <Item Id="America/Santo_Domingo" Title="America/Santo_Domingo"/>
      <Item Id="Asia/Dili" Title="Asia/Dili"/>
      <Item Id="America/Guayaquil" Title="America/Guayaquil"/>
      <Item Id="Pacific/Galapagos" Title="Pacific/Galapagos"/>
      <Item Id="Africa/Cairo" Title="Africa/Cairo"/>
      <Item Id="America/El_Salvador" Title="America/El_Salvador"/>
      <Item Id="Africa/Malabo" Title="Africa/Malabo"/>
      <Item Id="Africa/Asmara" Title="Africa/Asmara"/>
      <Item Id="Europe/Tallinn" Title="Europe/Tallinn"/>
      <Item Id="Africa/Addis_Ababa" Title="Africa/Addis_Ababa"/>
      <Item Id="Atlantic/Stanley" Title="Atlantic/Stanley"/>
      <Item Id="Atlantic/Faroe" Title="Atlantic/Faroe"/>
      <Item Id="Pacific/Fiji" Title="Pacific/Fiji"/>
      <Item Id="Europe/Helsinki" Title="Europe/Helsinki"/>
      <Item Id="Europe/Paris" Title="Europe/Paris"/>
      <Item Id="America/Cayenne" Title="America/Cayenne"/>
      <Item Id="Pacific/Gambier" Title="Pacific/Gambier"/>
      <Item Id="Pacific/Marquesas" Title="Pacific/Marquesas"/>
      <Item Id="Pacific/Tahiti" Title="Pacific/Tahiti"/>
      <Item Id="Indian/Kerguelen" Title="Indian/Kerguelen"/>
      <Item Id="Africa/Libreville" Title="Africa/Libreville"/>
      <Item Id="Africa/Banjul" Title="Africa/Banjul"/>
      <Item Id="Asia/Tbilisi" Title="Asia/Tbilisi"/>
      <Item Id="Europe/Berlin" Title="Europe/Berlin"/>
      <Item Id="Europe/Busingen" Title="Europe/Busingen"/>
      <Item Id="Africa/Accra" Title="Africa/Accra"/>
      <Item Id="Europe/Gibraltar" Title="Europe/Gibraltar"/>
      <Item Id="Europe/Athens" Title="Europe/Athens"/>
      <Item Id="America/Danmarkshavn" Title="America/Danmarkshavn"/>
      <Item Id="America/Godthab" Title="America/Godthab"/>
      <Item Id="America/Scoresbysund" Title="America/Scoresbysund"/>
      <Item Id="America/Thule" Title="America/Thule"/>
      <Item Id="America/Grenada" Title="America/Grenada"/>
      <Item Id="America/Guadeloupe" Title="America/Guadeloupe"/>
      <Item Id="Pacific/Guam" Title="Pacific/Guam"/>
      <Item Id="America/Guatemala" Title="America/Guatemala"/>
      <Item Id="Europe/Guernsey" Title="Europe/Guernsey"/>
      <Item Id="Africa/Conakry" Title="Africa/Conakry"/>
      <Item Id="Africa/Bissau" Title="Africa/Bissau"/>
      <Item Id="America/Guyana" Title="America/Guyana"/>
      <Item Id="America/Port-au-Prince" Title="America/Port-au-Prince"/>
      <Item Id="America/Tegucigalpa" Title="America/Tegucigalpa"/>
      <Item Id="Asia/Hong_Kong" Title="Asia/Hong_Kong"/>
      <Item Id="Europe/Budapest" Title="Europe/Budapest"/>
      <Item Id="Atlantic/Reykjavik" Title="Atlantic/Reykjavik"/>
      <Item Id="Asia/Kolkata" Title="Asia/Kolkata"/>
      <Item Id="Asia/Jakarta" Title="Asia/Jakarta"/>
      <Item Id="Asia/Jayapura" Title="Asia/Jayapura"/>
      <Item Id="Asia/Makassar" Title="Asia/Makassar"/>
      <Item Id="Asia/Pontianak" Title="Asia/Pontianak"/>
      <Item Id="Asia/Tehran" Title="Asia/Tehran"/>
      <Item Id="Asia/Baghdad" Title="Asia/Baghdad"/>
      <Item Id="Europe/Dublin" Title="Europe/Dublin"/>
      <Item Id="Europe/Isle_of_Man" Title="Europe/Isle_of_Man"/>
      <Item Id="Asia/Jerusalem" Title="Asia/Jerusalem"/>
      <Item Id="Europe/Rome" Title="Europe/Rome"/>
      <Item Id="Africa/Abidjan" Title="Africa/Abidjan"/>
      <Item Id="America/Jamaica" Title="America/Jamaica"/>
      <Item Id="Asia/Tokyo" Title="Asia/Tokyo"/>
      <Item Id="Europe/Jersey" Title="Europe/Jersey"/>
      <Item Id="Asia/Amman" Title="Asia/Amman"/>
      <Item Id="Asia/Almaty" Title="Asia/Almaty"/>
      <Item Id="Asia/Aqtau" Title="Asia/Aqtau"/>
      <Item Id="Asia/Aqtobe" Title="Asia/Aqtobe"/>
      <Item Id="Asia/Atyrau" Title="Asia/Atyrau"/>
      <Item Id="Asia/Oral" Title="Asia/Oral"/>
      <Item Id="Asia/Qyzylorda" Title="Asia/Qyzylorda"/>
      <Item Id="Africa/Nairobi" Title="Africa/Nairobi"/>
      <Item Id="Pacific/Enderbury" Title="Pacific/Enderbury"/>
      <Item Id="Pacific/Kiritimati" Title="Pacific/Kiritimati"/>
      <Item Id="Pacific/Tarawa" Title="Pacific/Tarawa"/>
      <Item Id="Asia/Kuwait" Title="Asia/Kuwait"/>
      <Item Id="Asia/Bishkek" Title="Asia/Bishkek"/>
      <Item Id="Asia/Vientiane" Title="Asia/Vientiane"/>
      <Item Id="Europe/Riga" Title="Europe/Riga"/>
      <Item Id="Asia/Beirut" Title="Asia/Beirut"/>
      <Item Id="Africa/Maseru" Title="Africa/Maseru"/>
      <Item Id="Africa/Monrovia" Title="Africa/Monrovia"/>
      <Item Id="Africa/Tripoli" Title="Africa/Tripoli"/>
      <Item Id="Europe/Vaduz" Title="Europe/Vaduz"/>
      <Item Id="Europe/Vilnius" Title="Europe/Vilnius"/>
      <Item Id="Europe/Luxembourg" Title="Europe/Luxembourg"/>
      <Item Id="Asia/Macau" Title="Asia/Macau"/>
      <Item Id="Europe/Skopje" Title="Europe/Skopje"/>
      <Item Id="Indian/Antananarivo" Title="Indian/Antananarivo"/>
      <Item Id="Africa/Blantyre" Title="Africa/Blantyre"/>
      <Item Id="Asia/Kuala_Lumpur" Title="Asia/Kuala_Lumpur"/>
      <Item Id="Asia/Kuching" Title="Asia/Kuching"/>
      <Item Id="Indian/Maldives" Title="Indian/Maldives"/>
      <Item Id="Africa/Bamako" Title="Africa/Bamako"/>
      <Item Id="Europe/Malta" Title="Europe/Malta"/>
      <Item Id="Pacific/Kwajalein" Title="Pacific/Kwajalein"/>
      <Item Id="Pacific/Majuro" Title="Pacific/Majuro"/>
      <Item Id="America/Martinique" Title="America/Martinique"/>
      <Item Id="Africa/Nouakchott" Title="Africa/Nouakchott"/>
      <Item Id="Indian/Mauritius" Title="Indian/Mauritius"/>
      <Item Id="Indian/Mayotte" Title="Indian/Mayotte"/>
      <Item Id="America/Bahia_Banderas" Title="America/Bahia_Banderas"/>
      <Item Id="America/Cancun" Title="America/Cancun"/>
      <Item Id="America/Chihuahua" Title="America/Chihuahua"/>
      <Item Id="America/Hermosillo" Title="America/Hermosillo"/>
      <Item Id="America/Matamoros" Title="America/Matamoros"/>
      <Item Id="America/Mazatlan" Title="America/Mazatlan"/>
      <Item Id="America/Merida" Title="America/Merida"/>
      <Item Id="America/Mexico_City" Title="America/Mexico_City"/>
      <Item Id="America/Monterrey" Title="America/Monterrey"/>
      <Item Id="America/Ojinaga" Title="America/Ojinaga"/>
      <Item Id="America/Tijuana" Title="America/Tijuana"/>
      <Item Id="Pacific/Chuuk" Title="Pacific/Chuuk"/>
      <Item Id="Pacific/Kosrae" Title="Pacific/Kosrae"/>
      <Item Id="Pacific/Pohnpei" Title="Pacific/Pohnpei"/>
      <Item Id="Europe/Chisinau" Title="Europe/Chisinau"/>
      <Item Id="Europe/Monaco" Title="Europe/Monaco"/>
    </Resource>
  </Resources>

  <RestConnector Id="TimeZoneList" Title="Time Zone List" HelpUrl="https://timezonedb.com/references/list-time-zone">
    <Parameters>
      <Text Id="CountryCodeSearch" Title="Filter by Time Zone Name Wildcard Search (*)" Required="false" DefaultValue="" HelpText="Use asterisk (*) for wildcard search."/>
      <Select Id="CountryCode" Title="Filter by Country Code" DefaultValue="all" HelpText="A valid ISO 3166 country code. Only time zones of provided country will list out.">
        <DataSource>
					<Item Id="all" Title="All"/>
          <ISOCountryCodes/>
        </DataSource>
      </Select>
    </Parameters>
  <Fetch>
    <Fetch.Url>
      <![CDATA[
      http://api.timezonedb.com/v2/list-time-zone?key=@(Model.ApiKey)&format=json
			@(Model.CountryCode != "all" ? "&cr=country" + Model.CountryCode.ToUpper() : "")
      @(!string.IsNullOrEmpty(Model.CountryCodeSearch) ? "&zone=" + Utils.UrlEncode(Model.CountryCodeSearch) : "")
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="zones.*">
        <JsonPath Expr="countryName" Id="CountryName" Title="Country Name" Converter="String" Checked="true" HelpText="Country name of the time zone."/>
        <JsonPath Expr="countryCode" Id="CountryCode" Title="Country Code" Converter="String" Checked="true" HelpText="Country name of the time zone."/>
        <JsonPath Expr="zoneName" Id="ZoneName" Title="Zone Name" Converter="String" Checked="true" HelpText="The time zone name."/>
        <JsonPath Expr="timestamp" Id="Formatted" Title="DateTime" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText=""/>
        <JsonPath Expr="timestamp" Id="TimeStamp" Title="Timestamp" Converter="Long" Checked="true" HelpText="Current local time in Unix time."/>
        <JsonPath Expr="gmtOffset" Id="GMTOffset" Title="GMT Offset" Converter="Int" Checked="true" HelpText="The time offset in seconds based on UTC time."/>
      </JsonPath>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

 <RestConnector Id="GeoPositionLookup" Title="City Lookup by Geo Position" HelpUrl="https://timezonedb.com/references/get-time-zone">
    <Parameters>
      <Text Id="Latitude" Title="Latitude (DDD.DDDDD°)" Required="true" DefaultValue="" Debug.DefaultValue="59.329324" HelpText="Latitude of a city."/>
      <Text Id="Longitude" Title="Longitude (DDD.DDDDD°)" Required="true" DefaultValue="" Debug.DefaultValue="18.068581" HelpText="Longitude of a city."/>
      <Date Id="DisplayDate" Title="Date" Required="false" Nullable="true" HelpText="Local Time of the From Time Zone."/>
    </Parameters>
  <Fetch>
    <Fetch.Url>
      <![CDATA[
      http://api.timezonedb.com/v2/get-time-zone?&by=position&format=json
      &key=@(Model.ApiKey)
      &lat=@(Model.Latitude)
      &lng=@(Model.Longitude)
      @(!Utils.IsNullDate(Model.DisplayDate) ? "&time=" + UnixConverter() : "")
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
        <JsonPath Expr="countryName" Id="CountryName" Title="Country Name" Converter="String" Checked="true" HelpText="Country name of the time zone."/>
        <JsonPath Expr="countryCode" Id="CountryCode" Title="Country Code" Converter="String" Checked="true" HelpText="Country code of the time zone."/>
        <JsonPath Expr="zoneName" Id="ZoneName" Title="Zone Name" Converter="String" Checked="true" HelpText="The time zone name."/>
        <JsonPath Expr="formatted" Id="Formatted" Title="DateTime" Converter="DateTime" Checked="true" HelpText="Current local DateTime"/>
        <JsonPath Expr="timestamp" Id="TimeStamp" Title="Timestamp" Converter="Long" Checked="true" HelpText="Current local time in Unix time."/>
        <JsonPath Expr="gmtOffset" Id="GMTOffset" Title="GMT Offset" Converter="Int" Checked="true" HelpText="The time offset in seconds based on UTC time."/>
        <JsonPath Expr="abbreviation" Id="Abbrevation" Title="Abbrevation" Converter="String" Checked="true" HelpText="Abbreviation of the time zone."/>
        <JsonPath Expr="dst" Id="DST" Title="DST" Converter="Int" Checked="true" HelpText="Whether Daylight Saving Time (DST) is used. Either 0 (No) or 1 (Yes)."/>
        <JsonPath Expr="dstStart" Id="dstStart" Title="DST Start" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText="When current time zone start."/>
        <JsonPath Expr="dstEnd" Id="dstEnd" Title="DST End" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText="when current time zone end."/>
        <JsonPath Expr="nextAbbreviation" Id="NextAbbrevation" Title="Next Abbrevation" Converter="String" Checked="true" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

 <RestConnector Id="ZoneLookup" Title="City Lookup by Zone" HelpUrl="https://timezonedb.com/references/get-time-zone">
    <Parameters>
      <Select Id="TimeZone" Title="Filter by Time Zode" Required="true" DefaultValue="Europe/Monaco" HelpText="A time zone abbreviation or time zone name.">
        <DataSource>
          <Resource Id="TimeZones"/>
        </DataSource>
      </Select>
      <Date Id="DisplayDate" Title="Date" Required="false" Nullable="true" HelpText="Local Time of the From Time Zone."/>
    </Parameters>
  <Fetch>
    <Fetch.Url>
      <![CDATA[
      http://api.timezonedb.com/v2/get-time-zone?&by=zone&format=json
      &zone=@(Model.TimeZone)
      &key=@(Model.ApiKey)
      @(!Utils.IsNullDate(Model.DisplayDate) ? "&time=" + UnixConverter() : "")
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
        <JsonPath Expr="countryName" Id="CountryName" Title="Country Name" Converter="String" Checked="true" HelpText="Country name of the time zone."/>
        <JsonPath Expr="countryCode" Id="CountryCode" Title="Country Code" Converter="String" Checked="true" HelpText="Country code of the time zone."/>
        <JsonPath Expr="zoneName" Id="ZoneName" Title="Zone Name" Converter="String" Checked="true" HelpText="The time zone name."/>
        <JsonPath Expr="formatted" Id="Formatted" Title="DateTime" Converter="DateTime" Checked="true" HelpText="Current local DateTime"/>
        <JsonPath Expr="timestamp" Id="TimeStamp" Title="Timestamp" Converter="Long" Checked="true" HelpText="Current local time in Unix time."/>
        <JsonPath Expr="gmtOffset" Id="GMTOffset" Title="GMT Offset" Converter="Int" Checked="true" HelpText="The time offset in seconds based on UTC time."/>
        <JsonPath Expr="abbreviation" Id="Abbrevation" Title="Abbrevation" Converter="String" Checked="true" HelpText="Abbreviation of the time zone."/>
        <JsonPath Expr="dst" Id="DST" Title="DST" Converter="Int" Checked="true" HelpText="Whether Daylight Saving Time (DST) is used. Either 0 (No) or 1 (Yes)."/>
        <JsonPath Expr="dstStart" Id="dstStart" Title="DST Start" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText="When current time zone start."/>
        <JsonPath Expr="dstEnd" Id="dstEnd" Title="DST End" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText="when current time zone end."/>
        <JsonPath Expr="nextAbbreviation" Id="NextAbbrevation" Title="Next Abbrevation" Converter="String" Checked="true" HelpText=""/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

 <RestConnector Id="TimeZoneConverter" Title="Time Zone Converter" HelpUrl="https://timezonedb.com/references/convert-time-zone">
    <Parameters>
      <Select Id="TimeZoneFrom" Title="From" Required="true" DefaultValue="Europe/Monaco" HelpText="A valid abbreviation or name of time zone to convert from.">
        <DataSource>
          <Resource Id="TimeZones"/>
        </DataSource>
      </Select>
      <Select Id="TimeZoneTo" Title="To" Required="true" DefaultValue="Asia/Shanghai" HelpText="A valid abbreviation or name of time zone to convert to.">
        <DataSource>
          <Resource Id="TimeZones"/>
        </DataSource>
      </Select>
      <Date Id="DisplayDate" Title="Date" Required="false" Nullable="true" HelpText="Local Time of the From Time Zone."/>
    </Parameters>
  <Fetch>
    <Fetch.Url>
      <![CDATA[
      http://api.timezonedb.com/v2/convert-time-zone?format=json
      &from=@(Model.TimeZoneFrom)
      &to=@(Model.TimeZoneTo)
      @(!Utils.IsNullDate(Model.DisplayDate) ? "&time=" + UnixConverter() : "")
      &key=@(Model.ApiKey)
      ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
        <JsonPath Expr="fromZoneName" Id="FromZoneName" Title="From Zone Name" Converter="String" Checked="true" HelpText="The time zone name of the origin city."/>
        <JsonPath Expr="fromAbbreviation" Id="FromAbbrevation" Title="From Abbrevation" Converter="String" Checked="true" HelpText="Time zone abbreviation of the origin city."/>
        <JsonPath Expr="fromTimestamp" Id="FromTimestamp" Title="From DateTime" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText="Time of the origin city in DateTime."/>
        <JsonPath Expr="fromTimestamp" Id="FromTimestamp" Title="From Timestamp" Converter="Long" Checked="true" HelpText="Time of the origin city in Unix time."/>
        <JsonPath Expr="toZoneName" Id="ToZoneName" Title="To Zone Name" Converter="String" Checked="true" HelpText="The time zone name of the destination city."/>
        <JsonPath Expr="toAbbreviation" Id="ToAbbreviation" Title="To Abbreviation" Converter="String" Checked="true" HelpText="Time zone abbreviation of the destination city."/>
        <JsonPath Expr="toTimestamp" Id="ToTimestamp" Title="To DateTime" Converter="DateTime" Converter.SourceFormat="Unix" Checked="true" HelpText="Time of the destination city in DateTime."/>
        <JsonPath Expr="toTimestamp" Id="ToTimestamp" Title="To Timestamp" Converter="Long" Checked="true" HelpText="Time of the destination city in Unix time."/>
        <JsonPath Expr="offset" Id="Offset" Title="Offset" Converter="Int" Checked="true" HelpText="Different in minute between origin time zone and destination time zone."/>
    </Parse>
    <Fail>
      <JsonPath Expr="message"/>
    </Fail>
  </RestConnector>

  <RazorFunctions>
  <![CDATA[
    String UnixConverter()
    {
      var timestamp = Model.DisplayDate;
      var unixTimestamp = timestamp.Subtract(new DateTime(1970, 1, 1)).TotalSeconds.ToString();
      return unixTimestamp;
    }
  ]]>
  </RazorFunctions>

</Suite>
