<?xml version="1.0" encoding="utf-8" ?>
<Suite Title="MailChimp" Category="Email" Id="MailChimp" RequireVersion="8.1.35" SourceUrl="https://github.com/nielsbosma/SeoTools-for-Excel-Connectors/blob/master/Mailchimp.xml" HelpUrl="http://seotoolsforexcel.com/mailchimp/" HelpText="Documentation" >

  <Author Name="Niels Bosma" Url="https://se.linkedin.com/in/bosmaniels"/>

  <SeoToolsAuthenticator StayAuthenticated="false" Key="mailchimp"/>
	
  <Resources>
    <Resource Id="Fail">
			<Fail>
				<JsonPath Expr="detail"/>
			</Fail>
    </Resource>
    <Resource Id="Prepare">
			<Prepare>
				<Connector Id="GetBaseUrl"/>
			</Prepare>	
    </Resource>		
    <Resource Id="Headers">
      <HttpSettings>
        <IntervalBetweenRequests RandomFrom="1" RandomTo="2" IfSame="Host"/>
        <RequestHeaders>
          <Header Name="Authorization">apikey @(Model.Authenticator.Token)</Header>
        </RequestHeaders>
      </HttpSettings>
    </Resource>
    <Resource Id="Paging">
			<Paging PageSize="100">
				<Parse>
					<JsonPath Id="AvaliableRows" Expr="total_items"/>
				</Parse>
			</Paging>
    </Resource>
    <Resource Id="SortTime">
      <Radio Id="Sorting" Title="Sort Time Direction" DefaultValue="DESC" Required="false">
        <DataSource>
          <Item Id="DESC" Title="Descending"/>
          <Item Id="ASC" Title="Ascending"/>
        </DataSource>
      </Radio>
    </Resource>
  </Resources>
	
  <RestConnector Id="GetBaseUrl" Hidden="true">
    <Fetch>
      <HttpSettings>
        <RequestHeaders>
          <Header Name="Authorization">Bearer @(Model.Authenticator.Token)</Header>
        </RequestHeaders>
      </HttpSettings>
      <Fetch.Url>
        <![CDATA[
         https://login.mailchimp.com/oauth2/metadata
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Id="Base" Expr="api_endpoint"/>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignsHidden" Hidden="true" HelpUrl="http://developer.mailchimp.com/documentation/mailchimp/reference/campaigns/#read-get_campaigns">
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/campaigns?count=100
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.campaigns.*">
        <JsonPath Title="Id" Id="Id" Expr="id"/>
        <JsonPath Title="Title" Id="Title" Expr="settings.title"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListsHidden" Hidden="true">
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/lists?count=100
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.lists.*">
        <JsonPath Title="Id" Id="Id" Expr="id"/>
        <JsonPath Title="Title" Id="Title" Expr="name"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>
	
  <RestConnector Id="CampaignsList" Title="Campaigns - List" Group="heeeej" HelpText="Get all campaigns in an account." HelpUrl="http://developer.mailchimp.com/documentation/mailchimp/reference/campaigns/#read-get_campaigns">
    <Parameters>
      <Text Id="ListId" Title="Filter by List Id" Required="false" HelpText="Leave Empty to include all Lists" Select.Connector="ListsHidden"/>
      <Select Id="Status" Title="Status" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="save" Title="Save"/>
          <Item Id="paused" Title="Paused"/>
          <Item Id="schedule" Title="Schedule"/>
          <Item Id="sending" Title="Sending"/>
          <Item Id="sent" Title="Sent"/>
        </DataSource>
      </Select>
      <Select Id="Type" Title="Type" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="regular" Title="Regular"/>
          <Item Id="plaintext" Title="Plaintext"/>
          <Item Id="absplit" Title="Absplit"/>
          <Item Id="rss" Title="RSS"/>
          <Item Id="variate" Title="Variate"/>
        </DataSource>
      </Select>
      <DateInterval Id="SentInterval" Title="Sent Interval" Required="false" Nullable="true"/>
			<Resource Id="SortTime"/>
    </Parameters>
		<Resource Id="Paging"/>
		<Resource Id="Prepare"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/campaigns?
				@(!string.IsNullOrEmpty(Model.ListId) ? "&list_id=" + Model.ListId : "")
        @if(Model.SentInterval.StartDate != null && Model.SentInterval.EndDate != null)
        {
            @: &since_send_time=@Model.SentInterval.StartDate.ToString("yyyy-MM-dd")T00:00:00+00:00
            @: &before_send_time=@Model.SentInterval.EndDate.ToString("yyyy-MM-dd")T00:00:00+00:00
        }
				@(Model.Status != "all" ? "status=" + Model.Status : "")
				@(Model.Type != "all" ? "type=" + Model.Type : "")
        &sort_field=send_time
        &sort_dir=@(Model.Sorting)
        &count=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.campaigns.*">
        <JsonPath Title="Id" Id="Id" Expr="id" HelpText="A string that uniquely identifies this campaign."/>
        <JsonPath Title="Title" Id="Title" DefaultValue="" Expr="settings.title" HelpText="The title of the campaign."/>
        <JsonPath Title="Subject" Id="Subject" DefaultValue="" Expr="settings.subject_line" HelpText="The subject line for the campaign."/>
        <JsonPath Title="Emails Sent" Id="EmailsSent" Expr="emails_sent" Converter="Int" HelpText="The total number of emails sent for this campaign."/>
        <JsonPath Title="Archive URL" Id="ArchiveUrl" Expr="archive_url" HelpText="The link to the campaign’s archive version."/>
        <JsonPath Title="Type" Id="Type" Expr="type" HelpText="The Type of Campaign"/>
        <JsonPath Title="Status" Id="Status" Expr="status" HelpText="The current status of the campaign."/>
        <JsonPath Title="Created" Id="Created" Expr="create_time" Converter="DateTime" HelpText="The date and time the campaign was created."/>
        <JsonPath Title="Send" Id="Send" Expr="send_time" Converter="Auto" DefaultValue="" HelpText="The date and time a campaign was sent."/>
        <JsonPath Title="Recipients List" Id="RecipientsList" Expr="recipients.list_name" Converter="String" DefaultValue="" HelpText="The name of the list."/>
        <JsonPath Title="Recipients" Id="Recipients" Expr="recipients.recipient_count" Converter="Long" DefaultValue="" HelpText="Count of the recipients on the associated list."/>
        <JsonPath Title="Opens" Id="Opens" Expr="report_summary.opens" Converter="Long" DefaultValue="" HelpText="The number of unique opens divided by the total number of successful deliveries."/>
        <JsonPath Title="Unique Opens" Id="UniqueOpens" Expr="report_summary.unique_opens" Converter="Long" DefaultValue="" HelpText="The number of unique opens."/>
        <JsonPath Title="Open Rate" Id="OpenRate" Expr="report_summary.open_rate" Converter="Double" DefaultValue="" Converter.ResultFormat="0.00%" HelpText="The number of unique opens divided by the total number of successful deliveries."/>
        <JsonPath Title="Clicks" Id="Clicks" Expr="report_summary.clicks" Converter="Long" DefaultValue="" HelpText="The total number of clicks for an campaign."/>
        <JsonPath Title="Subscriber Clicks" Id="SubscriberClicks" Expr="report_summary.subscriber_clicks" Converter="Long" DefaultValue="" HelpText="The number of unique clicks."/>
        <JsonPath Title="Click Rate" Id="ClickRate" Expr="report_summary.click_rate" Converter="Double" DefaultValue="" HelpText="The number of unique clicks divided by the total number of successful deliveries."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignsStatistics" Title="Campaigns - Statistics" Group="heeeej"  HelpText="Get detailed campaign reports." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/#read-get_reports">
    <Parameters>
      <Select Id="Type" Title="Type" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="regular" Title="Regular"/>
          <Item Id="plaintext" Title="Plaintext"/>
          <Item Id="absplit" Title="Absplit"/>
          <Item Id="rss" Title="RSS"/>
          <Item Id="variate" Title="Variate"/>
        </DataSource>
      </Select>
      <DateInterval Id="SentInterval" Title="Sent Interval" Required="false" Nullable="true"/>
      <Resource Id="SortTime"/>
    </Parameters>
    <Resource Id="Paging"/>
		<Resource Id="Prepare"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/reports?
        @if(Model.SentInterval.StartDate != null && Model.SentInterval.EndDate != null)
        {
            @: &since_send_time=@Model.SentInterval.StartDate.ToString("yyyy-MM-dd")T00:00:00+00:00
            @: &before_send_time=@Model.SentInterval.EndDate.ToString("yyyy-MM-dd")T00:00:00+00:00
        }
        @(Model.Type != "all" ? "&type=" + Model.Type : "")
        &sort_field=send_time
        &sort_dir=@(Model.Sorting)
        &count=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
    <Parse>
      <JsonPath Expr="$.reports.*">
        <JsonPath Title="Id" Id="Id" Expr="id" HelpText="A string that uniquely identifies this campaign."/>
        <JsonPath Title="Title" Id="Title" Expr="campaign_title" HelpText="The title of the campaign."/>
        <JsonPath Title="Subject" Id="Subject" Expr="subject_line" HelpText="The subject line for the campaign."/>
        <JsonPath Title="Type" Id="Type" Expr="type" HelpText="The type of campaign (regular, plain-text, ab_split, rss, automation, variate, or auto)."/>
        <JsonPath Title="List" Id="List" Expr="list_name" HelpText="The name of the list."/>
        <JsonPath Title="Send" Id="Send" Expr="send_time" Converter="DateTime" HelpText="The date and time a campaign was sent."/>
        <JsonPath Title="Emails Sent" Id="EmailsSent" Expr="emails_sent" Converter="Int" HelpText="The total number of emails sent for this campaign."/>
        <JsonPath Title="Opens" Id="Opens" Expr="opens.opens_total" Converter="Int" HelpText="The total number of opens for a campaign."/>
        <JsonPath Title="Unique Opens" Id="UniqueOpens" Expr="opens.unique_opens" Converter="Int" HelpText="The total number of unique opens."/>
        <JsonPath Title="Open Rate" Id="OpenRate" Expr="opens.open_rate" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The number of unique opens divided by the total number of successful deliveries."/>
        <JsonPath Title="Clicks" Id="Clicks" Expr="clicks.clicks_total" Converter="Int" HelpText="The total number of clicks for the campaign."/>
        <JsonPath Title="Unique Clicks" Id="UniqueClicks" Expr="clicks.unique_clicks" Converter="Int" HelpText="The total number of unique clicks for links across a campaign."/>
        <JsonPath Title="Unuque Subscriber Clicks" Id="SubscriberClicks" Expr="clicks.unique_subscriber_clicks" Converter="Int" HelpText="The total number of subscribers who clicked on a campaign."/>
        <JsonPath Title="Click Rate" Id="ClickRate" Expr="clicks.click_rate" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The number of unique clicks divided by the total number of successful deliveries."/>
        <JsonPath Title="Abuse Reports" Id="AbuseReports" Expr="abuse_reports" Converter="Int" HelpText="The number of abuse reports generated for this campaign."/>
        <JsonPath Title="Unsubscribed" Id="Unsubscribed" Expr="unsubscribed" Converter="Int" HelpText="The total number of unsubscribed members for this campaign."/>
        <JsonPath Title="Hard Bounces" Id="HardBounces" Expr="bounces.hard_bounces" Converter="Int" HelpText="The total number of hard bounced email addresses."/>
        <JsonPath Title="Soft Bounces" Id="SoftBounces" Expr="bounces.soft_bounces" Converter="Int" HelpText="The total number of soft bounced email addresses."/>
        <JsonPath Title="Syntax Errors" Id="SyntaxErrors" Expr="bounces.syntax_errors" Converter="Int" HelpText="The total number of addresses that were syntax-related bounces."/>
        <JsonPath Title="Forwards" Id="Forwards" Expr="forwards.forwards_count" Converter="Int" HelpText="How many times the campaign has been forwarded."/>
        <JsonPath Title="Forwards Opens" Id="ForwardsOpens" Expr="forwards.forwards_opens" Converter="Int" HelpText="How many times the forwarded campaign has been opened."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignDomainPerformance" Title="Campaign - Domain Performance" HelpText="Get statistics for the top-performing domains from a campaign." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/domain-performance/">
    <Parameters>
      <Text Id="CampaignId" Title="Campaign Id" Required="true" Debug.DefaultValue="0306d8ae5e" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Title"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/reports/@(Model.CampaignId)/domain-performance
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.domains.*">
        <JsonPath Title="Domain" Id="Domain" Expr="domain" Converter="String" HelpText="The name of the domain (gmail.com, hotmail.com, yahoo.com)."/>
        <JsonPath Title="Emails Sent" Id="EmailsSent" Expr="emails_sent" Converter="Int" HelpText="The number of emails sent to that specific domain. "/>
        <JsonPath Title="Bounces" Id="Bounces" Expr="bounces" Converter="Int" HelpText="The number of bounces at a domain. "/>
        <JsonPath Title="Opens" Id="Opens" Expr="opens" Converter="Int" HelpText="The number of opens for a domain. "/>
        <JsonPath Title="Clicks" Id="Clicks" Expr="clicks" Converter="Int" HelpText="The number of clicks for a domain. "/>
        <JsonPath Title="Unsubscribed" Id="Unsubscribed" Expr="unsubs" Converter="Int" HelpText="The total number of unsubscribes for a domain."/>
        <JsonPath Title="Delivered" Id="Delivered" Expr="delivered" Converter="Int" HelpText="The number of successful deliveries for a domain."/>
        <JsonPath Title="Emails Rate" Id="EmailsPCT" Expr="emails_pct" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of total emails that went to this domain. "/>
        <JsonPath Title="Bounces Rate" Id="BouncesPCT" Expr="bounces_pct" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of total bounces from this domain. "/>
        <JsonPath Title="Opens Rate" Id="OpensPCT" Expr="opens_pct" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of total opens from this domain. "/>
        <JsonPath Title="Clicks Rate" Id="ClicksPCT" Expr="clicks_pct" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of total clicks from this domain. "/>
        <JsonPath Title="Unsubscribes Rate" Id="UnsubscribesPCT" Expr="unsubs_pct" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of total clicks from this domain. "/>
        </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignLinkClicks" Title="Campaign - Link Clicks" HelpText="Get detailed information about links clicked in campaigns." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/click-details/">
    <Parameters>
      <Text Id="CampaignId" Title="Campaign Id" Required="true" Debug.DefaultValue="0306d8ae5e" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Title"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/reports/@(Model.CampaignId)/click-details
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.urls_clicked.*">
        <JsonPath Title="URL" Id="Url" Expr="url" Converter="String" HelpText="The URL for the link in the campaign."/>
        <JsonPath Title="Id" Id="Id" Expr="id" Converter="Auto" HelpText="The unique id for the link."/>
        <JsonPath Title="Clicks" Id="Clicks" Expr="total_clicks" Converter="Int" HelpText="The number of total clicks for a link."/>
        <JsonPath Title="Clicks Rate" Id="ClicksPCT" Expr="click_percentage" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of total clicks a link generated for a campaign."/>
        <JsonPath Title="Unique Clicks" Id="UniqueClicks" Expr="unique_clicks" Converter="Int" HelpText="Number of unique clicks for a link."/>
        <JsonPath Title="Unique Clicks Rate" Id="UniqueClicksPCT" Expr="unique_click_percentage" Converter="Double" Converter.ResultFormat="0.00%" HelpText="The percentage of unique clicks a link generated for a campaign."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignAbuseReports" Title="Campaign - Abuse Reports" HelpText="Get a list of abuse complaints for a specific campaign." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/abuse-reports/#read-get_reports_campaign_id_abuse_reports">
    <Parameters>
      <Text Id="CampaignId" Title="Campaign Id" Required="true" Debug.DefaultValue="0306d8ae5e" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Title"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/reports/@(Model.CampaignId)/abuse-reports
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.abuse_reports.*">
        <JsonPath Title="Email" Id="Email" Expr="email_address" Converter="String" HelpText="Email address for a subscriber."/>
        <JsonPath Title="Date" Id="Date" Expr="date" Converter="DateTime" HelpText="Date for the abuse report"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignOpenReports" Title="Campaign - Open Reports" HelpText="Get detailed information about any campaign emails that were opened by a list member." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/#read-get_reports">
    <Parameters>
      <Text Id="CampaignId" Title="Campaign Id" Required="true" Debug.DefaultValue="0306d8ae5e" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Title"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/reports/@(Model.CampaignId)/open-details?
        &count=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.members.*">
        <JsonPath Title="Email" Id="Email" Expr="email_address" Converter="String" HelpText="Email address for a subscriber."/>
        <JsonPath Title="Opens" Id="Opens" Expr="opens_count" Converter="Long" HelpText="The total number of times the this campaign was opened by the list member."/>
        <JsonPath Title="Open" Id="Open" Expr="opens[0].timestamp" Converter="DateTime" HelpText="imestamp for member opening the campaign."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignTopLocations" Title="Campaign - Top Locations" HelpText="Get top open locations for a specific campaign." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/locations/#read-get_reports_campaign_id_locations">
    <Parameters>
      <Text Id="CampaignId" Title="Campaign Id" Required="true" Debug.DefaultValue="0306d8ae5e" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Title"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/reports/@(Model.CampaignId)/locations?
        &count=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.locations.*">
        <JsonPath Title="Region" Id="Region" Expr="region_name" Converter="String" HelpText="The name of the region, if we have one."/>
        <JsonPath Title="Country" Id="CountryCode" Expr="country_code" Converter="String" HelpText="The ISO 3166 2 digit country code."/>
        <JsonPath Title="Opens" Id="Opens" Expr="opens" Converter="Long" HelpText="The number of unique campaign opens for a region."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignUnsubscribes" Title="Campaign - Unsubscribes" HelpText="Get information about list members who unsubscribed from a specific campaign." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/reports/unsubscribed/#read-get_reports_campaign_id_unsubscribed">
    <Parameters>
      <Text Id="CampaignId" Title="Campaign Id" Required="true" Debug.DefaultValue="0306d8ae5e" Select.Connector="CampaignsHidden" Select.IdField="Id" Select.TitleField="Title"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/reports/@(Model.CampaignId)/unsubscribed?
        &count=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.unsubscribes.*">
        <JsonPath Title="Email" Id="Email" Expr="email_address" Converter="String" HelpText="Email address for a subscriber."/>
        <JsonPath Title="Reason" Id="Reason" Expr="reason" Converter="String" HelpText="If available, the reason listed by the member for unsubscribing."/>
        <JsonPath Title="Date" Id="Date" Expr="timestamp" Converter="DateTime" HelpText="The date and time the member opted-out"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="CampaignsSearch" Title="Campaigns - Search" HelpText="Search all campaigns for the specified query terms." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/search-campaigns/#read-get_search_campaigns">
    <Parameters>
      <Text Id="Query" Title="Query" Debug.DefaultValue="2018" Required="true"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/search-campaigns?query=@(Utils.UrlEncode(Model.Query))
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.results.*.campaign">
        <JsonPath Title="Id" Id="Id" Expr="id" HelpText="A string that uniquely identifies this campaign."/>
        <JsonPath Title="Title" Id="Title" DefaultValue="" Expr="settings.title" HelpText="The title of the campaign."/>
        <JsonPath Title="Subject" Id="Subject" DefaultValue="" Expr="settings.subject_line" HelpText="The subject line for the campaign."/>
        <JsonPath Title="Emails Sent" Id="EmailsSent" Expr="emails_sent" Converter="Int" HelpText="The total number of emails sent for this campaign."/>
        <JsonPath Title="Archive URL" Id="ArchiveUrl" Expr="archive_url" HelpText="The link to the campaign’s archive version."/>
        <JsonPath Title="Type" Id="Type" Expr="type" HelpText="The Type of Campaign"/>
        <JsonPath Title="Status" Id="Status" Expr="status" HelpText="The current status of the campaign."/>
        <JsonPath Title="Created" Id="Created" Expr="create_time" Converter="DateTime" HelpText="The date and time the campaign was created."/>
        <JsonPath Title="Send" Id="Send" Expr="send_time" Converter="Auto" DefaultValue="" HelpText="The date and time a campaign was sent."/>
        <JsonPath Title="Recipients List" Id="RecipientsList" Expr="recipients.list_name" Converter="String" DefaultValue="" HelpText="The name of the list."/>
        <JsonPath Title="Recipients" Id="Recipients" Expr="recipients.recipient_count" Converter="Long" DefaultValue="" HelpText="Count of the recipients on the associated list."/>
        <JsonPath Title="Opens" Id="Opens" Expr="report_summary.opens" Converter="Long" DefaultValue="" HelpText="The number of unique opens divided by the total number of successful deliveries."/>
        <JsonPath Title="Unique Opens" Id="UniqueOpens" Expr="report_summary.unique_opens" Converter="Long" DefaultValue="" HelpText="The number of unique opens."/>
        <JsonPath Title="Open Rate" Id="OpenRate" Expr="report_summary.open_rate" Converter="Double" DefaultValue="" Converter.ResultFormat="0.00%" HelpText="The number of unique opens divided by the total number of successful deliveries."/>
        <JsonPath Title="Clicks" Id="Clicks" Expr="report_summary.clicks" Converter="Long" DefaultValue="" HelpText="The total number of clicks for an campaign."/>
        <JsonPath Title="Subscriber Clicks" Id="SubscriberClicks" Expr="report_summary.subscriber_clicks" Converter="Long" DefaultValue="" HelpText="The number of unique clicks."/>
        <JsonPath Title="Click Rate" Id="ClickRate" Expr="report_summary.click_rate" Converter="Double" DefaultValue="" HelpText="The number of unique clicks divided by the total number of successful deliveries."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="MembersSearch" Title="Members - Search" HelpText="Search for list members. " HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/search-members/#read-get_search_members">
    <Parameters>
      <Text Id="Query" Title="Query" Debug.DefaultValue="johan" Required="true"/>
      <Radio Id="MatchType" Title="Match Type" DefaultValue="full_search" Required="false">
        <DataSource>
          <Item Id="full_search" Title="Partial"/>
          <Item Id="exact_matches" Title="Exact"/>
        </DataSource>
      </Radio>
      <Text Id="ListId" Title="Filter by List Id" Required="false" HelpText="Leave Empty to include all Lists" Select.Connector="ListsHidden"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/search-members?query=@(Utils.UrlEncode(Model.Query))
					@(!string.IsNullOrEmpty(Model.ListId) ? "&list_id=" + Model.ListId : "")
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.@(Model.MatchType).members.*">
        <JsonPath Title="Email" Id="Email" Expr="email_address" HelpText="Email address for a subscriber."/>
        <JsonPath Title="Status" Id="Status" Expr="status" Converter="String" HelpText="Subscriber’s current status."/>
        <JsonPath Title="Open Rate" Id="OpenRate" Expr="stats.avg_open_rate" Converter="Double" HelpText="A subscriber’s average open rate."/>
        <JsonPath Title="Click Rate" Id="ClickRate" Expr="stats.avg_click_rate" Converter="Double" HelpText="A subscriber’s average clickthrough rate."/>
        <JsonPath Title="Rating" Id="Rating" Expr="member_rating" Converter="Int" HelpText="Star rating for this member, between 1 and 5."/>
        <JsonPath Title="Email Client" Id="EmailClient" Expr="email_client" Converter="String" HelpText="The list member’s email client."/>
        <JsonPath Title="Country Code" Id="CountryCode" Expr="location.country_code" Converter="String" HelpText="The unique code for the location country."/>
        <JsonPath Title="Subscribed" Id="Subscribed" Expr="timestamp_opt" Converter="DateTime" HelpText="The date and time the subscriber signed up for the list."/>
        <JsonPath Title="Updated" Id="Updated" Expr="last_changed" Converter="DateTime" HelpText="The date and time the member’s info was last changed."/>
        <JsonPath Title="Country" Id="Country" Expr="location.country_code" Converter="String" HelpText="The unique code for the location country."/>
        <JsonPath Title="Language" Id="Language" Expr="language" Converter="String" HelpText="If set/detected, the subscriber’s language."/>
        <JsonPath Title="Tags" Id="Tags" Expr="tags_count" Converter="Long" HelpText="The number of tags applied to this member."/>
        <JsonPath Title="VIP Status" Id="VIPStatus" Expr="vip" Converter="Bool" HelpText="VIP status for subscriber."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListsList" Title="Lists - List" HelpText="Get information about all lists in the account." HelpUrl="http://developer.mailchimp.com/documentation/mailchimp/reference/lists/#read-get_lists">
    <Parameters>
      <DateInterval Id="CreatedInterval" Title="Sent Interval" Required="false" Nullable="true"/>
      <Resource Id="SortTime"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
        @(Model.Base)/3.0/lists?
        @if(Model.CreatedInterval.StartDate != null && Model.CreatedInterval.EndDate != null)
        {
            @: &since_date_created=@Model.CreatedInterval.StartDate.ToString("yyyy-MM-dd")T00:00:00+00:00
            @: &before_date_created=@Model.CreatedInterval.EndDate.ToString("yyyy-MM-dd")T00:00:00+00:00
        }
        &sort_field=date_created
        &sort_dir=@(Model.Sorting)
        &count=@(Model.PageCursor.NextTake)
        &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.lists.*">
        <JsonPath Title="Id" Id="Id" Expr="id" HelpText="A string that uniquely identifies this list."/>
        <JsonPath Title="Title" Id="Title" Expr="name" HelpText="The title of the list."/>
        <JsonPath Title="Created" Id="Created" Expr="date_created" Converter="DateTime" HelpText="The date and time that this list was created."/>
        <JsonPath Title="Campaigns" Id="Campaigns" Expr="stats.campaign_count" Converter="Int" HelpText="The number of campaigns in any status that use this list."/>
        <JsonPath Title="Members" Id="Members" Expr="stats.member_count" Converter="Int" HelpText="The number of active members in the list."/>
        <JsonPath Title="Unsubscribes" Id="Unsubscribes" Expr="stats.unsubscribe_count" Converter="Int" HelpText="The number of members who have unsubscribed from the list."/>
        <JsonPath Title="Cleaned" Id="Cleaned" Expr="stats.cleaned_count" Converter="Int" HelpText="The number of members cleaned from the list."/>
        <JsonPath Title="Subscription Rate" Id="SubscriptionRate" Expr="stats.avg_sub_rate" Converter="Double" HelpText="The average number of subscriptions per month for the list."/>
        <JsonPath Title="Unsubscription Rate" Id="AvgUnsubscriptionRate" Expr="stats.avg_unsub_rate" Converter="Double" HelpText="The average number of unsubscriptions per month for the list."/>
        <JsonPath Title="Open Rate" Id="OpenRate" Expr="stats.open_rate" Converter="Double" HelpText="The average open rate."/>
        <JsonPath Title="Click Rate" Id="ClickRate" Expr="stats.click_rate" Converter="Double" HelpText="The average click rate."/>
        <JsonPath Title="Rating" Id="Rating" Expr="list_rating" Converter="Long" HelpText="An auto-generated activity score for the list (0-5)."/>
        <JsonPath Title="Last Subscribe" Id="LastSubscribe" Expr="stats.last_sub_date" Converter="DateTime" HelpText="The date and time of the last time someone subscribed to this list."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListMembers" Title="List - Members" HelpText="Get information about members in a specific Mailchimp list." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/members/#read-get_lists_list_id_members">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
      <Select Id="Status" Title="Status" DefaultValue="all" Required="false">
        <DataSource>
          <Item Id="all" Title="All"/>
          <Item Id="subscribed" Title="Subscribed"/>
          <Item Id="unsubscribed" Title="Unsubscribed"/>
          <Item Id="cleaned" Title="Cleaned"/>
        </DataSource>
      </Select>
      <DateInterval Id="OptedInInterval" Title="Opted-in Interval" Required="false" Nullable="true"/>
      <Checkbox Id="VIP" Title="VIP Only" DefaultValue="False" HelpText="If checked, you will receive all members with VIP status."/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/members?
          @(Model.Status != "all" ? "status=" + Model.Status : "")
          @if(Model.OptedInInterval.StartDate != null && Model.OptedInInterval.EndDate != null)
          {
              @: &since_timestamp_opt=@Model.OptedInInterval.StartDate.ToString("yyyy-MM-dd")T00:00:00+00:00
              @: &before_timestamp_opt=@Model.OptedInInterval.EndDate.ToString("yyyy-MM-dd")T00:00:00+00:00
          }
          &count=@(Model.PageCursor.NextTake)
          &offset=@(Model.PageCursor.NextSkip)
          &vip_only=@(Model.VIP ? "true" : "false")
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.members.*">
        <JsonPath Title="Id" Id="Id" Expr="id" HelpText="The MD5 hash of the lowercase version of the list member’s email address."/>
        <JsonPath Title="Email" Id="Email" Expr="email_address" HelpText="Email address for a subscriber."/>
        <JsonPath Title="Status" Id="Status" Expr="status" Converter="String" HelpText="Subscriber’s current status."/>
        <JsonPath Title="Open Rate" Id="OpenRate" Expr="stats.avg_open_rate" Converter="Double" HelpText="A subscriber’s average open rate."/>
        <JsonPath Title="Click Rate" Id="ClickRate" Expr="stats.avg_click_rate" Converter="Double" HelpText="A subscriber’s average clickthrough rate."/>
        <JsonPath Title="Rating" Id="Rating" Expr="member_rating" Converter="Int" HelpText="Star rating for this member, between 1 and 5."/>
        <JsonPath Title="Email Client" Id="EmailClient" Expr="email_client" Converter="String" HelpText="The list member’s email client."/>
        <JsonPath Title="Country Code" Id="CountryCode" Expr="location.country_code" Converter="String" HelpText="The unique code for the location country."/>
        <JsonPath Title="Subscribed" Id="Subscribed" Expr="timestamp_opt" Converter="DateTime" HelpText="The date and time the subscriber signed up for the list."/>
        <JsonPath Title="Updated" Id="Updated" Expr="last_changed" Converter="DateTime" HelpText="The date and time the member’s info was last changed."/>
        <JsonPath Title="VIP Status" Id="VIPStatus" Expr="vip" Converter="String" HelpText="VIP status for subscriber."/>
        <JsonPath Title="Unsub Reason" Id="UnsubReason" Expr="unsubscribe_reason" Converter="String" HelpText="A subscriber’s reason for unsubscribing." DefaultValue=""/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListRecentActivity" Title="List - Recent Activity" HelpText="Get up to the previous 180 days of daily detailed aggregated activity stats for a list." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/activity/#read-get_lists_list_id_activity">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/activity
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.activity.*">
        <JsonPath Title="Date" Id="Date" Expr="day" Converter="DateTime" HelpText="Date of activity."/>
        <JsonPath Title="Emails Sent" Id="EmailsSent" Expr="emails_sent" Converter="Int" HelpText="The total number of emails sent on the date for the activity summary."/>
        <JsonPath Title="Unique Opens" Id="UniqueOpens" Expr="unique_opens" Converter="Int" HelpText="The number of unique opens."/>
        <JsonPath Title="Clicks" Id="Clicks" Expr="recipient_clicks" Converter="Int" HelpText="The number of clicks."/>
        <JsonPath Title="Hard Bounces" Id="HardBounces" Expr="hard_bounce" Converter="Int" HelpText="The number of hard bounces."/>
        <JsonPath Title="Soft Bounces" Id="SoftBounces" Expr="soft_bounce" Converter="Int" HelpText="The number of soft bounces."/>
        <JsonPath Title="Subscribes" Id="Subscribes" Expr="subs" Converter="Int" HelpText="The number of subscribes."/>
        <JsonPath Title="Unsubscribes" Id="Unsubscribes" Expr="unsubs" Converter="Int" HelpText="The number of unsubscribes."/>
        <JsonPath Title="Other Adds" Id="OtherAdds" Expr="other_adds" Converter="Int" HelpText="The number of subscribers who may have been added outside of the double opt-in process, such as imports or API activity."/>
        <JsonPath Title="Other Removes" Id="OtherRemoves" Expr="other_removes" Converter="Int" HelpText="The number of subscribers who may have been removed outside of unsubscribing or reporting an email as spam (for example, deleted subscribers)."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListClients" Title="List - Clients" HelpText="Get a list of the top email clients based on user-agent strings." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/clients/#read-get_lists_list_id_clients">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/clients
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.clients.*">
        <JsonPath Title="Client" Id="Client" Expr="client" Converter="String" HelpText="The name of the email client."/>
        <JsonPath Title="Members" Id="Members" Expr="members" Converter="Int" HelpText="The number of subscribed members who used this email client."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListLocations" Title="List - Locations" HelpText="Get the locations (countries) that the list’s subscribers have been tagged to based on geocoding their IP address." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/locations/#read-get_lists_list_id_locations">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
    </Parameters>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/locations
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.locations.*">
        <JsonPath Title="Country Code" Id="CountryCode" Expr="cc" Converter="String" HelpText="The ISO 3166 2 digit country code."/>
        <JsonPath Title="Country Name" Id="CountryName" Expr="country" Converter="String" HelpText="The name of the country."/>
        <JsonPath Title="Subscribers" Id="Subscribers" Expr="total" Converter="Int" HelpText="The total number of subscribers in the country."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListAbuseReports" Title="List - Abuse Reports" HelpText="Get all abuse reports for a specific list." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/abuse-reports/#read-get_lists_list_id_abuse_reports">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/abuse-reports?
          &count=@(Model.PageCursor.NextTake)
          &offset=@(Model.PageCursor.NextSkip)
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.abuse_reports.*">
        <JsonPath Title="Email" Id="Email" Expr="email_address" Converter="String" HelpText="Email address for a subscriber."/>
        <JsonPath Title="Date" Id="Date" Expr="date" Converter="DateTime" HelpText="Date for the abuse report"/>
        <JsonPath Title="Campaign Id" Id="CampaignId" Expr="campaign_id" Converter="String" HelpText="The campaign id for the abuse report"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListGrowthHistory" Title="List - Growth History" HelpText="Get a month-by-month summary of a specific list’s growth activity." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/growth-history/#read-get_lists_list_id_growth_history">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
			<Resource Id="SortTime"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/growth-history?
          &count=@(Model.PageCursor.NextTake)
          &offset=@(Model.PageCursor.NextSkip)
					&sort_field=month
					&sort_dir=@(Model.Sorting)
          ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.history.*">
        <JsonPath Title="Month" Id="Month" Expr="month" Converter="String" HelpText="The month that the growth history is describing."/>
        <JsonPath Title="Existing" Id="Existing" Expr="existing" Converter="Long" HelpText="Existing members on the list for a specific month."/>
        <JsonPath Title="Imports" Id="Imports" Expr="imports" Converter="Long" HelpText="Imported members on the list for a specific month."/>
        <JsonPath Title="Opt-ins" Id="Optins" Expr="optins" Converter="Long" HelpText="Newly opted-in members on the list for a specific month."/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

  <RestConnector Id="ListSegments" Title="List - Segments" HelpText="Get information about all available segments for a specific list." HelpUrl="https://developer.mailchimp.com/documentation/mailchimp/reference/lists/segments/#read-get_lists_list_id_segments">
    <Parameters>
      <Text Id="ListId" Title="List Id" Required="true" Debug.DefaultValue="56af7eb983" Select.Connector="ListsHidden"/>
      <DateInterval Id="CreatedInterval" Title="Createtd Interval" Required="false" Nullable="true"/>
    </Parameters>
    <Resource Id="Paging"/>
    <Fetch>
			<Resource Id="Headers"/>
      <Fetch.Url>
        <![CDATA[
          @(Model.Base)/3.0/lists/@(Model.ListId)/segments?
          @if(Model.CreatedInterval.StartDate != null && Model.CreatedInterval.EndDate != null)
          {
              @: &since_timestamp_opt=@Model.CreatedInterval.StartDate.ToString("yyyy-MM-dd")T00:00:00+00:00
              @: &before_timestamp_opt=@Model.CreatedInterval.EndDate.ToString("yyyy-MM-dd")T00:00:00+00:00
          }
          &count=@(Model.PageCursor.NextTake)
          &offset=@(Model.PageCursor.NextSkip)
        ]]>
      </Fetch.Url>
    </Fetch>
		<Resource Id="Prepare"/>
    <Parse>
      <JsonPath Expr="$.segments.*">
        <JsonPath Title="Id" Id="Id" Expr="id" Converter="Auto" HelpText="The unique id for the segment."/>
        <JsonPath Title="Name" Id="Name" Expr="name" Conveter="String" HelpText="The name of the segment."/>
        <JsonPath Title="Members" Id="Members" Expr="member_count" Converter="Long" HelpText="The number of active subscribers currently included in the segment."/>
        <JsonPath Title="Type" Id="Type" Expr="type" Conveter="String" HelpText="The type of segment."/>
        <JsonPath Title="Created" Id="Created" Expr="created_at" Converter="DateTime" HelpText="The date and time the segment was created in"/>
        <JsonPath Title="Updated" Id="Updated" Expr="updated_at" Converter="DateTime" HelpText="The date and time the segment was last updated in"/>
      </JsonPath>
    </Parse>
    <Resource Id="Fail"/>
  </RestConnector>

</Suite>